// three.js - http://github.com/mrdoob/three.js
'use strict';var THREE=THREE||{REVISION:"59dev"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};self.Int32Array=self.Int32Array||Array;self.Float32Array=self.Float32Array||Array;String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};
THREE.extend=function(a,b){if(Object.keys)for(var c=Object.keys(b),d=0,e=c.length;d<e;d++){var f=c[d];Object.defineProperty(a,f,Object.getOwnPropertyDescriptor(b,f))}else for(f in c={}.hasOwnProperty,b)c.call(b,f)&&(a[f]=b[f]);return a};
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!self.requestAnimationFrame;++c)self.requestAnimationFrame=self[b[c]+"RequestAnimationFrame"],self.cancelAnimationFrame=self[b[c]+"CancelAnimationFrame"]||self[b[c]+"CancelRequestAnimationFrame"];void 0===self.requestAnimationFrame&&void 0!==self.setTimeout&&(self.requestAnimationFrame=function(b){var c=Date.now(),f=Math.max(0,16-(c-a)),h=self.setTimeout(function(){b(c+f)},f);a=c+f;return h});void 0===self.cancelAnimationFrame&&void 0!==
self.clearTimeout&&(self.cancelAnimationFrame=function(a){self.clearTimeout(a)})})();THREE.CullFaceNone=0;THREE.CullFaceBack=1;THREE.CullFaceFront=2;THREE.CullFaceFrontBack=3;THREE.FrontFaceDirectionCW=0;THREE.FrontFaceDirectionCCW=1;THREE.BasicShadowMap=0;THREE.PCFShadowMap=1;THREE.PCFSoftShadowMap=2;THREE.FrontSide=0;THREE.BackSide=1;THREE.DoubleSide=2;THREE.NoShading=0;THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NoBlending=0;
THREE.NormalBlending=1;THREE.AdditiveBlending=2;THREE.SubtractiveBlending=3;THREE.MultiplyBlending=4;THREE.CustomBlending=5;THREE.AddEquation=100;THREE.SubtractEquation=101;THREE.ReverseSubtractEquation=102;THREE.ZeroFactor=200;THREE.OneFactor=201;THREE.SrcColorFactor=202;THREE.OneMinusSrcColorFactor=203;THREE.SrcAlphaFactor=204;THREE.OneMinusSrcAlphaFactor=205;THREE.DstAlphaFactor=206;THREE.OneMinusDstAlphaFactor=207;THREE.DstColorFactor=208;THREE.OneMinusDstColorFactor=209;
THREE.SrcAlphaSaturateFactor=210;THREE.MultiplyOperation=0;THREE.MixOperation=1;THREE.AddOperation=2;THREE.UVMapping=function(){};THREE.CubeReflectionMapping=function(){};THREE.CubeRefractionMapping=function(){};THREE.SphericalReflectionMapping=function(){};THREE.SphericalRefractionMapping=function(){};THREE.RepeatWrapping=1E3;THREE.ClampToEdgeWrapping=1001;THREE.MirroredRepeatWrapping=1002;THREE.NearestFilter=1003;THREE.NearestMipMapNearestFilter=1004;THREE.NearestMipMapLinearFilter=1005;
THREE.LinearFilter=1006;THREE.LinearMipMapNearestFilter=1007;THREE.LinearMipMapLinearFilter=1008;THREE.UnsignedByteType=1009;THREE.ByteType=1010;THREE.ShortType=1011;THREE.UnsignedShortType=1012;THREE.IntType=1013;THREE.UnsignedIntType=1014;THREE.FloatType=1015;THREE.UnsignedShort4444Type=1016;THREE.UnsignedShort5551Type=1017;THREE.UnsignedShort565Type=1018;THREE.AlphaFormat=1019;THREE.RGBFormat=1020;THREE.RGBAFormat=1021;THREE.LuminanceFormat=1022;THREE.LuminanceAlphaFormat=1023;
THREE.RGB_S3TC_DXT1_Format=2001;THREE.RGBA_S3TC_DXT1_Format=2002;THREE.RGBA_S3TC_DXT3_Format=2003;THREE.RGBA_S3TC_DXT5_Format=2004;THREE.RGB_PVRTC_4BPPV1_Format=2100;THREE.RGB_PVRTC_2BPPV1_Format=2101;THREE.RGBA_PVRTC_4BPPV1_Format=2102;THREE.RGBA_PVRTC_2BPPV1_Format=2103;THREE.RGB_ATC_Format=2200;THREE.RGBA_ATC_EXPLICIT_ALPHA_Format=2201;THREE.RGBA_ATC_INTERP_ALPHA_Format=2202;THREE.Color=function(a){void 0!==a&&this.set(a);return this};
THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(a){a instanceof THREE.Color?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a);return this},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},setRGB:function(a,b,c){this.r=a;this.g=b;this.b=c;return this},setHSL:function(a,b,c){if(0===b)this.r=this.g=this.b=c;else{var d=function(a,b,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+6*(b-a)*
c:0.5>c?b:c<2/3?a+6*(b-a)*(2/3-c):a},b=0.5>=c?c*(1+b):c+b-c*b,c=2*c-b;this.r=d(c,b,a+1/3);this.g=d(c,b,a);this.b=d(c,b,a-1/3)}return this},setStyle:function(a){if(/^rgb\((\d+),(\d+),(\d+)\)$/i.test(a))return a=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(a),this.r=Math.min(255,parseInt(a[1],10))/255,this.g=Math.min(255,parseInt(a[2],10))/255,this.b=Math.min(255,parseInt(a[3],10))/255,this;if(/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.test(a))return a=/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.exec(a),this.r=Math.min(100,
parseInt(a[1],10))/100,this.g=Math.min(100,parseInt(a[2],10))/100,this.b=Math.min(100,parseInt(a[3],10))/100,this;if(/^\#([0-9a-f]{6})$/i.test(a))return a=/^\#([0-9a-f]{6})$/i.exec(a),this.setHex(parseInt(a[1],16)),this;if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(a))return a=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a),this.setHex(parseInt(a[1]+a[1]+a[2]+a[2]+a[3]+a[3],16)),this;if(/^(\w+)$/i.test(a))return this.setHex(THREE.ColorKeywords[a]),this},copy:function(a){this.r=a.r;this.g=a.g;this.b=
a.b;return this},copyGammaToLinear:function(a){this.r=a.r*a.r;this.g=a.g*a.g;this.b=a.b*a.b;return this},copyLinearToGamma:function(a){this.r=Math.sqrt(a.r);this.g=Math.sqrt(a.g);this.b=Math.sqrt(a.b);return this},convertGammaToLinear:function(){var a=this.r,b=this.g,c=this.b;this.r=a*a;this.g=b*b;this.b=c*c;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*
this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(){var a={h:0,s:0,l:0};return function(){var b=this.r,c=this.g,d=this.b,e=Math.max(b,c,d),f=Math.min(b,c,d),h,g=(f+e)/2;if(f===e)f=h=0;else{var i=e-f,f=0.5>=g?i/(e+f):i/(2-e-f);switch(e){case b:h=(c-d)/i+(c<d?6:0);break;case c:h=(d-b)/i+2;break;case d:h=(b-c)/i+4}h/=6}a.h=h;a.s=f;a.l=g;return a}}(),getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(a,
b,c){var d=this.getHSL();d.h+=a;d.s+=b;d.l+=c;this.setHSL(d.h,d.s,d.l);return this},add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this},addColors:function(a,b){this.r=a.r+b.r;this.g=a.g+b.g;this.b=a.b+b.b;return this},addScalar:function(a){this.r+=a;this.g+=a;this.b+=a;return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=a;this.b*=a;return this},lerp:function(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;
this.b+=(a.b-this.b)*b;return this},equals:function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}};
THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,
darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,
grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,
lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,
palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,
tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};THREE.Quaternion=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1};
THREE.Quaternion.prototype={constructor:THREE.Quaternion,set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w;return this},setFromEuler:function(a,b){var c=Math.cos(a.x/2),d=Math.cos(a.y/2),e=Math.cos(a.z/2),f=Math.sin(a.x/2),h=Math.sin(a.y/2),g=Math.sin(a.z/2);void 0===b||"XYZ"===b?(this.x=f*d*e+c*h*g,this.y=c*h*e-f*d*g,this.z=c*d*g+f*h*e,this.w=c*d*e-f*h*g):"YXZ"===b?(this.x=f*d*e+c*h*g,this.y=c*h*e-f*d*g,this.z=c*d*
g-f*h*e,this.w=c*d*e+f*h*g):"ZXY"===b?(this.x=f*d*e-c*h*g,this.y=c*h*e+f*d*g,this.z=c*d*g+f*h*e,this.w=c*d*e-f*h*g):"ZYX"===b?(this.x=f*d*e-c*h*g,this.y=c*h*e+f*d*g,this.z=c*d*g-f*h*e,this.w=c*d*e+f*h*g):"YZX"===b?(this.x=f*d*e+c*h*g,this.y=c*h*e+f*d*g,this.z=c*d*g-f*h*e,this.w=c*d*e-f*h*g):"XZY"===b&&(this.x=f*d*e-c*h*g,this.y=c*h*e-f*d*g,this.z=c*d*g+f*h*e,this.w=c*d*e+f*h*g);return this},setFromAxisAngle:function(a,b){var c=b/2,d=Math.sin(c);this.x=a.x*d;this.y=a.y*d;this.z=a.z*d;this.w=Math.cos(c);
return this},setFromRotationMatrix:function(a){var b=a.elements,c=b[0],a=b[4],d=b[8],e=b[1],f=b[5],h=b[9],g=b[2],i=b[6],b=b[10],j=c+f+b;0<j?(c=0.5/Math.sqrt(j+1),this.w=0.25/c,this.x=(i-h)*c,this.y=(d-g)*c,this.z=(e-a)*c):c>f&&c>b?(c=2*Math.sqrt(1+c-f-b),this.w=(i-h)/c,this.x=0.25*c,this.y=(a+e)/c,this.z=(d+g)/c):f>b?(c=2*Math.sqrt(1+f-c-b),this.w=(d-g)/c,this.x=(a+e)/c,this.y=0.25*c,this.z=(h+i)/c):(c=2*Math.sqrt(1+b-c-f),this.w=(e-a)/c,this.x=(d+g)/c,this.y=(h+i)/c,this.z=0.25*c);return this},inverse:function(){this.conjugate().normalize();
return this},conjugate:function(){this.x*=-1;this.y*=-1;this.z*=-1;return this},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var a=this.length();0===a?(this.z=this.y=this.x=0,this.w=1):(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a);return this},multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),
this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},multiplyQuaternions:function(a,b){var c=a.x,d=a.y,e=a.z,f=a.w,h=b.x,g=b.y,i=b.z,j=b.w;this.x=c*j+f*h+d*i-e*g;this.y=d*j+f*g+e*h-c*i;this.z=e*j+f*i+c*g-d*h;this.w=f*j-c*h-d*g-e*i;return this},multiplyVector3:function(a){console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return a.applyQuaternion(this)},slerp:function(a,b){var c=this.x,d=this.y,e=this.z,
f=this.w,h=f*a.w+c*a.x+d*a.y+e*a.z;0>h?(this.w=-a.w,this.x=-a.x,this.y=-a.y,this.z=-a.z,h=-h):this.copy(a);if(1<=h)return this.w=f,this.x=c,this.y=d,this.z=e,this;var g=Math.acos(h),i=Math.sqrt(1-h*h);if(0.001>Math.abs(i))return this.w=0.5*(f+this.w),this.x=0.5*(c+this.x),this.y=0.5*(d+this.y),this.z=0.5*(e+this.z),this;h=Math.sin((1-b)*g)/i;g=Math.sin(b*g)/i;this.w=f*h+this.w*g;this.x=c*h+this.x*g;this.y=d*h+this.y*g;this.z=e*h+this.z*g;return this},equals:function(a){return a.x===this.x&&a.y===
this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a){this.x=a[0];this.y=a[1];this.z=a[2];this.w=a[3];return this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Quaternion(this.x,this.y,this.z,this.w)}};THREE.Quaternion.slerp=function(a,b,c,d){return c.copy(a).slerp(b,d)};THREE.Vector2=function(a,b){this.x=a||0;this.y=b||0};
THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(a,b){this.x=a;this.y=b;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,
b){if(void 0!==b)return console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=
a.y;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divideScalar:function(a){0!==a?(this.x/=a,this.y/=a):this.set(0,0);return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);return this},
negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},angleTo:function(a){return Math.acos(this.dot(a)/this.length()/a.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,a=this.y-a.y;return b*b+a*a},setLength:function(a){var b=
this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a){this.x=a[0];this.y=a[1];return this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}};THREE.Vector3=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};
THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+
a);}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},multiplyVectors:function(a,b){this.x=a.x*
b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z,a=a.elements;this.x=a[0]*b+a[3]*c+a[6]*d;this.y=a[1]*b+a[4]*c+a[7]*d;this.z=a[2]*b+a[5]*c+a[8]*d;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12];this.y=a[1]*b+a[5]*c+a[9]*d+a[13];this.z=a[2]*b+a[6]*c+a[10]*d+a[14];return this},applyProjection:function(a){var b=this.x,c=this.y,d=this.z,a=a.elements,e=1/(a[3]*b+a[7]*c+a[11]*d+a[15]);
this.x=(a[0]*b+a[4]*c+a[8]*d+a[12])*e;this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])*e;this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])*e;return this},applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,h=a.z,a=a.w,g=a*b+f*d-h*c,i=a*c+h*b-e*d,j=a*d+e*c-f*b,b=-e*b-f*c-h*d;this.x=g*a+b*-e+i*-h-j*-f;this.y=i*a+b*-f+j*-e-g*-h;this.z=j*a+b*-h+g*-f-i*-e;return this},transformDirection:function(a){var b=this.x,c=this.y,d=this.z,a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d;this.y=a[1]*b+a[5]*c+a[9]*d;this.z=a[2]*
b+a[6]*c+a[10]*d;this.normalize();return this},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){0!==a?(this.x/=a,this.y/=a,this.z/=a):this.z=this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=
a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=
this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},cross:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b);var c=this.x,d=this.y,e=this.z;this.x=d*a.z-e*a.y;this.y=e*a.x-c*a.z;this.z=c*a.y-d*a.x;return this},crossVectors:function(a,b){this.x=a.y*b.z-a.z*b.y;this.y=
a.z*b.x-a.x*b.z;this.z=a.x*b.y-a.y*b.x;return this},angleTo:function(a){a=this.dot(a)/(this.length()*a.length());return Math.acos(THREE.Math.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y,a=this.z-a.z;return b*b+c*c+a*a},setEulerFromRotationMatrix:function(a,b){function c(a){return Math.min(Math.max(a,-1),1)}var d=a.elements,e=d[0],f=d[4],h=d[8],g=d[1],i=d[5],j=d[9],l=d[2],q=d[6],d=d[10];void 0===b||"XYZ"===
b?(this.y=Math.asin(c(h)),0.99999>Math.abs(h)?(this.x=Math.atan2(-j,d),this.z=Math.atan2(-f,e)):(this.x=Math.atan2(q,i),this.z=0)):"YXZ"===b?(this.x=Math.asin(-c(j)),0.99999>Math.abs(j)?(this.y=Math.atan2(h,d),this.z=Math.atan2(g,i)):(this.y=Math.atan2(-l,e),this.z=0)):"ZXY"===b?(this.x=Math.asin(c(q)),0.99999>Math.abs(q)?(this.y=Math.atan2(-l,d),this.z=Math.atan2(-f,i)):(this.y=0,this.z=Math.atan2(g,e))):"ZYX"===b?(this.y=Math.asin(-c(l)),0.99999>Math.abs(l)?(this.x=Math.atan2(q,d),this.z=Math.atan2(g,
e)):(this.x=0,this.z=Math.atan2(-f,i))):"YZX"===b?(this.z=Math.asin(c(g)),0.99999>Math.abs(g)?(this.x=Math.atan2(-j,i),this.y=Math.atan2(-l,e)):(this.x=0,this.y=Math.atan2(h,d))):"XZY"===b&&(this.z=Math.asin(-c(f)),0.99999>Math.abs(f)?(this.x=Math.atan2(q,i),this.y=Math.atan2(h,e)):(this.x=Math.atan2(-j,d),this.y=0));return this},setEulerFromQuaternion:function(a,b){function c(a){return Math.min(Math.max(a,-1),1)}var d=a.x*a.x,e=a.y*a.y,f=a.z*a.z,h=a.w*a.w;void 0===b||"XYZ"===b?(this.x=Math.atan2(2*
(a.x*a.w-a.y*a.z),h-d-e+f),this.y=Math.asin(c(2*(a.x*a.z+a.y*a.w))),this.z=Math.atan2(2*(a.z*a.w-a.x*a.y),h+d-e-f)):"YXZ"===b?(this.x=Math.asin(c(2*(a.x*a.w-a.y*a.z))),this.y=Math.atan2(2*(a.x*a.z+a.y*a.w),h-d-e+f),this.z=Math.atan2(2*(a.x*a.y+a.z*a.w),h-d+e-f)):"ZXY"===b?(this.x=Math.asin(c(2*(a.x*a.w+a.y*a.z))),this.y=Math.atan2(2*(a.y*a.w-a.z*a.x),h-d-e+f),this.z=Math.atan2(2*(a.z*a.w-a.x*a.y),h-d+e-f)):"ZYX"===b?(this.x=Math.atan2(2*(a.x*a.w+a.z*a.y),h-d-e+f),this.y=Math.asin(c(2*(a.y*a.w-a.x*
a.z))),this.z=Math.atan2(2*(a.x*a.y+a.z*a.w),h+d-e-f)):"YZX"===b?(this.x=Math.atan2(2*(a.x*a.w-a.z*a.y),h-d+e-f),this.y=Math.atan2(2*(a.y*a.w-a.x*a.z),h+d-e-f),this.z=Math.asin(c(2*(a.x*a.y+a.z*a.w)))):"XZY"===b&&(this.x=Math.atan2(2*(a.x*a.w+a.y*a.z),h-d+e-f),this.y=Math.atan2(2*(a.x*a.z+a.y*a.w),h+d-e-f),this.z=Math.asin(c(2*(a.z*a.w-a.x*a.y))));return this},getPositionFromMatrix:function(a){this.x=a.elements[12];this.y=a.elements[13];this.z=a.elements[14];return this},getScaleFromMatrix:function(a){var b=
this.set(a.elements[0],a.elements[1],a.elements[2]).length(),c=this.set(a.elements[4],a.elements[5],a.elements[6]).length(),a=this.set(a.elements[8],a.elements[9],a.elements[10]).length();this.x=b;this.y=c;this.z=a;return this},getColumnFromMatrix:function(a,b){var c=4*a,d=b.elements;this.x=d[c];this.y=d[c+1];this.z=d[c+2];return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a){this.x=a[0];this.y=a[1];this.z=a[2];return this},toArray:function(){return[this.x,
this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}};
THREE.extend(THREE.Vector3.prototype,{applyEuler:function(){var a=new THREE.Quaternion;return function(b,c){var d=a.setFromEuler(b,c);this.applyQuaternion(d);return this}}(),applyAxisAngle:function(){var a=new THREE.Quaternion;return function(b,c){var d=a.setFromAxisAngle(b,c);this.applyQuaternion(d);return this}}(),projectOnVector:function(){var a=new THREE.Vector3;return function(b){a.copy(b).normalize();b=this.dot(a);return this.copy(a).multiplyScalar(b)}}(),projectOnPlane:function(){var a=new THREE.Vector3;
return function(b){a.copy(this).projectOnVector(b);return this.sub(a)}}(),reflect:function(){var a=new THREE.Vector3;return function(b){a.copy(this).projectOnVector(b).multiplyScalar(2);return this.subVectors(a,this)}}()});THREE.Vector4=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1};
THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;
case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this},
addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this},
applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=this.w,a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*e;this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*e;this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*e;this.w=a[3]*b+a[7]*c+a[11]*d+a[15]*e;return this},divideScalar:function(a){0!==a?(this.x/=a,this.y/=a,this.z/=a,this.w/=a):(this.z=this.y=this.x=0,this.w=1);return this},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);1E-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=
a.y/b,this.z=a.z/b);return this},setAxisAngleFromRotationMatrix:function(a){var b,c,d,a=a.elements,e=a[0];d=a[4];var f=a[8],h=a[1],g=a[5],i=a[9];c=a[2];b=a[6];var j=a[10];if(0.01>Math.abs(d-h)&&0.01>Math.abs(f-c)&&0.01>Math.abs(i-b)){if(0.1>Math.abs(d+h)&&0.1>Math.abs(f+c)&&0.1>Math.abs(i+b)&&0.1>Math.abs(e+g+j-3))return this.set(1,0,0,0),this;a=Math.PI;e=(e+1)/2;g=(g+1)/2;j=(j+1)/2;d=(d+h)/4;f=(f+c)/4;i=(i+b)/4;e>g&&e>j?0.01>e?(b=0,d=c=0.707106781):(b=Math.sqrt(e),c=d/b,d=f/b):g>j?0.01>g?(b=0.707106781,
c=0,d=0.707106781):(c=Math.sqrt(g),b=d/c,d=i/c):0.01>j?(c=b=0.707106781,d=0):(d=Math.sqrt(j),b=f/d,c=i/d);this.set(b,c,d,a);return this}a=Math.sqrt((b-i)*(b-i)+(f-c)*(f-c)+(h-d)*(h-d));0.001>Math.abs(a)&&(a=1);this.x=(b-i)/a;this.y=(f-c)/a;this.z=(h-d)/a;this.w=Math.acos((e+g+j-1)/2);return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);this.w>a.w&&(this.w=a.w);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&
(this.z=a.z);this.w<a.w&&(this.w=a.w);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);this.w<a.w?this.w=a.w:this.w>b.w&&(this.w=b.w);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*
this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&
a.w===this.w},fromArray:function(a){this.x=a[0];this.y=a[1];this.z=a[2];this.w=a[3];return this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}};THREE.Matrix3=function(a,b,c,d,e,f,h,g,i){this.elements=new Float32Array(9);this.set(void 0!==a?a:1,b||0,c||0,d||0,void 0!==e?e:1,f||0,h||0,g||0,void 0!==i?i:1)};
THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(a,b,c,d,e,f,h,g,i){var j=this.elements;j[0]=a;j[3]=b;j[6]=c;j[1]=d;j[4]=e;j[7]=f;j[2]=h;j[5]=g;j[8]=i;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]);return this},multiplyVector3:function(a){console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return a.applyMatrix3(this)},
multiplyVector3Array:function(){var a=new THREE.Vector3;return function(b){for(var c=0,d=b.length;c<d;c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyMatrix3(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],h=a[5],g=a[6],i=a[7],a=a[8];return b*f*a-b*h*i-c*e*a+c*h*g+d*e*i-d*f*g},getInverse:function(a,
b){var c=a.elements,d=this.elements;d[0]=c[10]*c[5]-c[6]*c[9];d[1]=-c[10]*c[1]+c[2]*c[9];d[2]=c[6]*c[1]-c[2]*c[5];d[3]=-c[10]*c[4]+c[6]*c[8];d[4]=c[10]*c[0]-c[2]*c[8];d[5]=-c[6]*c[0]+c[2]*c[4];d[6]=c[9]*c[4]-c[5]*c[8];d[7]=-c[9]*c[0]+c[1]*c[8];d[8]=c[5]*c[0]-c[1]*c[4];c=c[0]*d[0]+c[1]*d[3]+c[2]*d[6];if(0===c){if(b)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/
c);return this},transpose:function(){var a,b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this},getNormalMatrix:function(a){this.getInverse(a).transpose();return this},transposeIntoArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this},clone:function(){var a=this.elements;return new THREE.Matrix3(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8])}};THREE.Matrix4=function(a,b,c,d,e,f,h,g,i,j,l,q,t,r,x,p){var n=this.elements=new Float32Array(16);n[0]=void 0!==a?a:1;n[4]=b||0;n[8]=c||0;n[12]=d||0;n[1]=e||0;n[5]=void 0!==f?f:1;n[9]=h||0;n[13]=g||0;n[2]=i||0;n[6]=j||0;n[10]=void 0!==l?l:1;n[14]=q||0;n[3]=t||0;n[7]=r||0;n[11]=x||0;n[15]=void 0!==p?p:1};
THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(a,b,c,d,e,f,h,g,i,j,l,q,t,r,x,p){var n=this.elements;n[0]=a;n[4]=b;n[8]=c;n[12]=d;n[1]=e;n[5]=f;n[9]=h;n[13]=g;n[2]=i;n[6]=j;n[10]=l;n[14]=q;n[3]=t;n[7]=r;n[11]=x;n[15]=p;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]);return this},extractPosition:function(a){console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition().");
return this.copyPosition(a)},copyPosition:function(a){var b=this.elements,a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractRotation:function(){var a=new THREE.Vector3;return function(b){var c=this.elements,b=b.elements,d=1/a.set(b[0],b[1],b[2]).length(),e=1/a.set(b[4],b[5],b[6]).length(),f=1/a.set(b[8],b[9],b[10]).length();c[0]=b[0]*d;c[1]=b[1]*d;c[2]=b[2]*d;c[4]=b[4]*e;c[5]=b[5]*e;c[6]=b[6]*e;c[8]=b[8]*f;c[9]=b[9]*f;c[10]=b[10]*f;return this}}(),setRotationFromEuler:function(a,
b){console.warn("DEPRECATED: Matrix4's .setRotationFromEuler() has been deprecated in favor of makeRotationFromEuler.  Please update your code.");return this.makeRotationFromEuler(a,b)},makeRotationFromEuler:function(a,b){var c=this.elements,d=a.x,e=a.y,f=a.z,h=Math.cos(d),d=Math.sin(d),g=Math.cos(e),e=Math.sin(e),i=Math.cos(f),f=Math.sin(f);if(void 0===b||"XYZ"===b){var j=h*i,l=h*f,q=d*i,t=d*f;c[0]=g*i;c[4]=-g*f;c[8]=e;c[1]=l+q*e;c[5]=j-t*e;c[9]=-d*g;c[2]=t-j*e;c[6]=q+l*e;c[10]=h*g}else"YXZ"===b?
(j=g*i,l=g*f,q=e*i,t=e*f,c[0]=j+t*d,c[4]=q*d-l,c[8]=h*e,c[1]=h*f,c[5]=h*i,c[9]=-d,c[2]=l*d-q,c[6]=t+j*d,c[10]=h*g):"ZXY"===b?(j=g*i,l=g*f,q=e*i,t=e*f,c[0]=j-t*d,c[4]=-h*f,c[8]=q+l*d,c[1]=l+q*d,c[5]=h*i,c[9]=t-j*d,c[2]=-h*e,c[6]=d,c[10]=h*g):"ZYX"===b?(j=h*i,l=h*f,q=d*i,t=d*f,c[0]=g*i,c[4]=q*e-l,c[8]=j*e+t,c[1]=g*f,c[5]=t*e+j,c[9]=l*e-q,c[2]=-e,c[6]=d*g,c[10]=h*g):"YZX"===b?(j=h*g,l=h*e,q=d*g,t=d*e,c[0]=g*i,c[4]=t-j*f,c[8]=q*f+l,c[1]=f,c[5]=h*i,c[9]=-d*i,c[2]=-e*i,c[6]=l*f+q,c[10]=j-t*f):"XZY"===b&&
(j=h*g,l=h*e,q=d*g,t=d*e,c[0]=g*i,c[4]=-f,c[8]=e*i,c[1]=j*f+t,c[5]=h*i,c[9]=l*f-q,c[2]=q*f-l,c[6]=d*i,c[10]=t*f+j);c[3]=0;c[7]=0;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return this},setRotationFromQuaternion:function(a){console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code.");return this.makeRotationFromQuaternion(a)},makeRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,h=
c+c,g=d+d,i=e+e,a=c*h,j=c*g,c=c*i,l=d*g,d=d*i,e=e*i,h=f*h,g=f*g,f=f*i;b[0]=1-(l+e);b[4]=j-f;b[8]=c+g;b[1]=j+f;b[5]=1-(a+e);b[9]=d-h;b[2]=c-g;b[6]=d+h;b[10]=1-(a+l);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},lookAt:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e,f){var h=this.elements;c.subVectors(d,e).normalize();0===c.length()&&(c.z=1);a.crossVectors(f,c).normalize();0===a.length()&&(c.x+=1E-4,a.crossVectors(f,c).normalize());
b.crossVectors(c,a);h[0]=a.x;h[4]=b.x;h[8]=c.x;h[1]=a.y;h[5]=b.y;h[9]=c.y;h[2]=a.z;h[6]=b.z;h[10]=c.z;return this}}(),multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements,e=this.elements,f=c[0],h=c[4],g=c[8],i=c[12],j=c[1],l=c[5],q=c[9],t=c[13],r=c[2],x=c[6],p=c[10],n=c[14],
k=c[3],z=c[7],y=c[11],c=c[15],D=d[0],H=d[4],E=d[8],K=d[12],L=d[1],u=d[5],C=d[9],s=d[13],A=d[2],G=d[6],m=d[10],F=d[14],w=d[3],M=d[7],v=d[11],d=d[15];e[0]=f*D+h*L+g*A+i*w;e[4]=f*H+h*u+g*G+i*M;e[8]=f*E+h*C+g*m+i*v;e[12]=f*K+h*s+g*F+i*d;e[1]=j*D+l*L+q*A+t*w;e[5]=j*H+l*u+q*G+t*M;e[9]=j*E+l*C+q*m+t*v;e[13]=j*K+l*s+q*F+t*d;e[2]=r*D+x*L+p*A+n*w;e[6]=r*H+x*u+p*G+n*M;e[10]=r*E+x*C+p*m+n*v;e[14]=r*K+x*s+p*F+n*d;e[3]=k*D+z*L+y*A+c*w;e[7]=k*H+z*u+y*G+c*M;e[11]=k*E+z*C+y*m+c*v;e[15]=k*K+z*s+y*F+c*d;return this},
multiplyToArray:function(a,b,c){var d=this.elements;this.multiplyMatrices(a,b);c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];c[4]=d[4];c[5]=d[5];c[6]=d[6];c[7]=d[7];c[8]=d[8];c[9]=d[9];c[10]=d[10];c[11]=d[11];c[12]=d[12];c[13]=d[13];c[14]=d[14];c[15]=d[15];return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},multiplyVector3:function(a){console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");
return a.applyProjection(this)},multiplyVector4:function(a){console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector3Array:function(){var a=new THREE.Vector3;return function(b){for(var c=0,d=b.length;c<d;c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyProjection(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),rotateAxis:function(a){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");
a.transformDirection(this)},crossVector:function(a){console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],h=a[5],g=a[9],i=a[13],j=a[2],l=a[6],q=a[10],t=a[14];return a[3]*(+e*g*l-d*i*l-e*h*q+c*i*q+d*h*t-c*g*t)+a[7]*(+b*g*t-b*i*q+e*f*q-d*f*t+d*i*j-e*g*j)+a[11]*(+b*i*l-b*h*t-e*f*l+c*f*t+e*h*j-c*i*j)+a[15]*(-d*h*j-b*g*l+b*h*q+d*f*l-c*f*
q+c*g*j)},transpose:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},flattenToArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},flattenToArrayOffset:function(a,b){var c=this.elements;
a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a},getPosition:function(){var a=new THREE.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");var b=this.elements;return a.set(b[12],b[13],b[14])}}(),setPosition:function(a){var b=this.elements;
b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,d=a.elements,e=d[0],f=d[4],h=d[8],g=d[12],i=d[1],j=d[5],l=d[9],q=d[13],t=d[2],r=d[6],x=d[10],p=d[14],n=d[3],k=d[7],z=d[11],d=d[15];c[0]=l*p*k-q*x*k+q*r*z-j*p*z-l*r*d+j*x*d;c[4]=g*x*k-h*p*k-g*r*z+f*p*z+h*r*d-f*x*d;c[8]=h*q*k-g*l*k+g*j*z-f*q*z-h*j*d+f*l*d;c[12]=g*l*r-h*q*r-g*j*x+f*q*x+h*j*p-f*l*p;c[1]=q*x*n-l*p*n-q*t*z+i*p*z+l*t*d-i*x*d;c[5]=h*p*n-g*x*n+g*t*z-e*p*z-h*t*d+e*x*d;c[9]=g*l*n-h*q*n-g*i*z+e*q*z+h*i*d-
e*l*d;c[13]=h*q*t-g*l*t+g*i*x-e*q*x-h*i*p+e*l*p;c[2]=j*p*n-q*r*n+q*t*k-i*p*k-j*t*d+i*r*d;c[6]=g*r*n-f*p*n-g*t*k+e*p*k+f*t*d-e*r*d;c[10]=f*q*n-g*j*n+g*i*k-e*q*k-f*i*d+e*j*d;c[14]=g*j*t-f*q*t-g*i*r+e*q*r+f*i*p-e*j*p;c[3]=l*r*n-j*x*n-l*t*k+i*x*k+j*t*z-i*r*z;c[7]=f*x*n-h*r*n+h*t*k-e*x*k-f*t*z+e*r*z;c[11]=h*j*n-f*l*n-h*i*k+e*l*k+f*i*z-e*j*z;c[15]=f*l*t-h*j*t+h*i*r-e*l*r-f*i*x+e*j*x;c=e*c[0]+i*c[4]+t*c[8]+n*c[12];if(0==c){if(b)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0");
this.identity();return this}this.multiplyScalar(1/c);return this},translate:function(){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")},
scale:function(a){var b=this.elements,c=a.x,d=a.y,a=a.z;b[0]*=c;b[4]*=d;b[8]*=a;b[1]*=c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a),a=Math.sin(a);this.set(1,
0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a),a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a),a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,h=a.y,g=a.z,i=e*f,j=e*h;this.set(i*f+c,i*h-d*g,i*g+d*h,0,i*h+d*g,j*h+c,j*g-d*f,0,i*g-d*h,j*g+d*f,e*g*g+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,
0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},compose:function(a,b,c){console.warn("DEPRECATED: Matrix4's .compose() has been deprecated in favor of makeFromPositionQuaternionScale. Please update your code.");return this.makeFromPositionQuaternionScale(a,b,c)},makeFromPositionQuaternionScale:function(a,b,c){this.makeRotationFromQuaternion(b);this.scale(c);this.setPosition(a);return this},makeFromPositionEulerScale:function(a,b,c,d){this.makeRotationFromEuler(b,c);this.scale(d);this.setPosition(a);return this},
makeFrustum:function(a,b,c,d,e,f){var h=this.elements;h[0]=2*e/(b-a);h[4]=0;h[8]=(b+a)/(b-a);h[12]=0;h[1]=0;h[5]=2*e/(d-c);h[9]=(d+c)/(d-c);h[13]=0;h[2]=0;h[6]=0;h[10]=-(f+e)/(f-e);h[14]=-2*f*e/(f-e);h[3]=0;h[7]=0;h[11]=-1;h[15]=0;return this},makePerspective:function(a,b,c,d){var a=c*Math.tan(THREE.Math.degToRad(0.5*a)),e=-a;return this.makeFrustum(e*b,a*b,e,a,c,d)},makeOrthographic:function(a,b,c,d,e,f){var h=this.elements,g=b-a,i=c-d,j=f-e;h[0]=2/g;h[4]=0;h[8]=0;h[12]=-((b+a)/g);h[1]=0;h[5]=2/
i;h[9]=0;h[13]=-((c+d)/i);h[2]=0;h[6]=0;h[10]=-2/j;h[14]=-((f+e)/j);h[3]=0;h[7]=0;h[11]=0;h[15]=1;return this},clone:function(){var a=this.elements;return new THREE.Matrix4(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])}};
THREE.extend(THREE.Matrix4.prototype,{decompose:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Matrix4;return function(e,f,h){var g=this.elements;a.set(g[0],g[1],g[2]);b.set(g[4],g[5],g[6]);c.set(g[8],g[9],g[10]);e=e instanceof THREE.Vector3?e:new THREE.Vector3;f=f instanceof THREE.Quaternion?f:new THREE.Quaternion;h=h instanceof THREE.Vector3?h:new THREE.Vector3;h.x=a.length();h.y=b.length();h.z=c.length();e.x=g[12];e.y=g[13];e.z=g[14];d.copy(this);d.elements[0]/=
h.x;d.elements[1]/=h.x;d.elements[2]/=h.x;d.elements[4]/=h.y;d.elements[5]/=h.y;d.elements[6]/=h.y;d.elements[8]/=h.z;d.elements[9]/=h.z;d.elements[10]/=h.z;f.setFromRotationMatrix(d);return[e,f,h]}}()});THREE.Ray=function(a,b){this.origin=void 0!==a?a:new THREE.Vector3;this.direction=void 0!==b?b:new THREE.Vector3};
THREE.Ray.prototype={constructor:THREE.Ray,set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(a,b){return(b||new THREE.Vector3).copy(this.direction).multiplyScalar(a).add(this.origin)},recast:function(){var a=new THREE.Vector3;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,b){var c=b||new THREE.Vector3;c.subVectors(a,this.origin);
var d=c.dot(this.direction);return c.copy(this.direction).multiplyScalar(d).add(this.origin)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);a.copy(this.direction).multiplyScalar(c).add(this.origin);return a.distanceTo(b)}}(),isIntersectionSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},isIntersectionPlane:function(a){return 0!=a.normal.dot(this.direction)||0==a.distanceToPoint(this.origin)?!0:!1},distanceToPlane:function(a){var b=
a.normal.dot(this.direction);if(0==b){if(0==a.distanceToPoint(this.origin))return 0}else return-(this.origin.dot(a.normal)+a.constant)/b},intersectPlane:function(a,b){var c=this.distanceToPlane(a);return void 0===c?void 0:this.at(c,b)},applyMatrix4:function(a){this.direction.add(this.origin).applyMatrix4(a);this.origin.applyMatrix4(a);this.direction.sub(this.origin);return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}};THREE.Box2=function(a,b){this.min=void 0!==a?a:new THREE.Vector2(Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector2(-Infinity,-Infinity)};
THREE.Box2.prototype={constructor:THREE.Box2,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){if(0<a.length){var b=a[0];this.min.copy(b);this.max.copy(b);for(var c=1,d=a.length;c<d;c++)b=a[c],b.x<this.min.x?this.min.x=b.x:b.x>this.max.x&&(this.max.x=b.x),b.y<this.min.y?this.min.y=b.y:b.y>this.max.y&&(this.max.y=b.y)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var a=new THREE.Vector2;return function(b,c){var d=a.copy(c).multiplyScalar(0.5);
this.min.copy(b).sub(d);this.max.copy(b).add(d);return this}}(),copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(a){return(a||new THREE.Vector2).addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(a){return(a||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);
this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y?!0:!1},getParameter:function(a){return new THREE.Vector2((a.x-this.min.x)/(this.max.x-this.min.x),
(a.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector2).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector2;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);
return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}};THREE.Box3=function(a,b){this.min=void 0!==a?a:new THREE.Vector3(Infinity,Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector3(-Infinity,-Infinity,-Infinity)};
THREE.Box3.prototype={constructor:THREE.Box3,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){if(0<a.length){var b=a[0];this.min.copy(b);this.max.copy(b);for(var c=1,d=a.length;c<d;c++)b=a[c],b.x<this.min.x?this.min.x=b.x:b.x>this.max.x&&(this.max.x=b.x),b.y<this.min.y?this.min.y=b.y:b.y>this.max.y&&(this.max.y=b.y),b.z<this.min.z?this.min.z=b.z:b.z>this.max.z&&(this.max.z=b.z)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var a=new THREE.Vector3;
return function(b,c){var d=a.copy(c).multiplyScalar(0.5);this.min.copy(b).sub(d);this.max.copy(b).add(d);return this}}(),setFromObject:function(){var a=new THREE.Vector3;return function(b){var c=this;b.updateMatrixWorld(!0);this.makeEmpty();b.traverse(function(b){if(void 0!==b.geometry&&void 0!==b.geometry.vertices)for(var e=b.geometry.vertices,f=0,h=e.length;f<h;f++)a.copy(e[f]),a.applyMatrix4(b.matrixWorld),c.expandByPoint(a)});return this}}(),copy:function(a){this.min.copy(a.min);this.max.copy(a.max);
return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(a){return(a||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(a){return(a||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);
this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z?!0:!1},getParameter:function(a){return new THREE.Vector3((a.x-this.min.x)/(this.max.x-this.min.x),
(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector3).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=
new THREE.Vector3;return function(b){b=b||new THREE.Sphere;b.center=this.center();b.radius=0.5*this.size(a).length();return b}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(){var a=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(b){a[0].set(this.min.x,this.min.y,
this.min.z).applyMatrix4(b);a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b);a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b);a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b);a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b);a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b);a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b);a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b);this.makeEmpty();this.setFromPoints(a);return this}}(),translate:function(a){this.min.add(a);
this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}};THREE.Sphere=function(a,b){this.center=void 0!==a?a:new THREE.Vector3;this.radius=void 0!==b?b:0};
THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(a,b){this.center.copy(a);this.radius=b;return this},setFromPoints:function(a){for(var b,c=0,d=0,e=a.length;d<e;d++)b=a[d].lengthSq(),c=Math.max(c,b);this.center.set(0,0,0);this.radius=Math.sqrt(c);return this},copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-
this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},clampPoint:function(a,b){var c=this.center.distanceToSquared(a),d=b||new THREE.Vector3;d.copy(a);c>this.radius*this.radius&&(d.sub(this.center).normalize(),d.multiplyScalar(this.radius).add(this.center));return d},getBoundingBox:function(a){a=a||new THREE.Box3;a.set(this.center,this.center);a.expandByScalar(this.radius);return a},applyMatrix4:function(a){this.center.applyMatrix4(a);
this.radius*=a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}};THREE.Plane=function(a,b){this.normal=void 0!==a?a:new THREE.Vector3(1,0,0);this.constant=void 0!==b?b:0};
THREE.Plane.prototype={constructor:THREE.Plane,set:function(a,b){this.normal.copy(a);this.constant=b;return this},setComponents:function(a,b,c,d){this.normal.set(a,b,c);this.constant=d;return this},setFromNormalAndCoplanarPoint:function(a,b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this},setFromCoplanarPoints:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d,e){d=a.subVectors(e,d).cross(b.subVectors(c,d)).normalize();this.setFromNormalAndCoplanarPoint(d,
c);return this}}(),copy:function(a){this.normal.copy(a.normal);this.constant=a.constant;return this},normalize:function(){var a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return this.orthoPoint(a,b).sub(a).negate()},orthoPoint:function(a,
b){var c=this.distanceToPoint(a);return(b||new THREE.Vector3).copy(this.normal).multiplyScalar(c)},isIntersectionLine:function(a){var b=this.distanceToPoint(a.start),a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectLine:function(){var a=new THREE.Vector3;return function(b,c){var d=c||new THREE.Vector3,e=b.delta(a),f=this.normal.dot(e);if(0==f){if(0==this.distanceToPoint(b.start))return d.copy(b.start)}else return f=-(b.start.dot(this.normal)+this.constant)/f,0>f||1<f?void 0:d.copy(e).multiplyScalar(f).add(b.start)}}(),
coplanarPoint:function(a){return(a||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d){var d=d||(new THREE.Matrix3).getNormalMatrix(c),e=a.copy(this.normal).applyMatrix3(d),f=this.coplanarPoint(b);f.applyMatrix4(c);this.setFromNormalAndCoplanarPoint(e,f);return this}}(),translate:function(a){this.constant-=a.dot(this.normal);return this},equals:function(a){return a.normal.equals(this.normal)&&
a.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}};THREE.Frustum=function(a,b,c,d,e,f){this.planes=[void 0!==a?a:new THREE.Plane,void 0!==b?b:new THREE.Plane,void 0!==c?c:new THREE.Plane,void 0!==d?d:new THREE.Plane,void 0!==e?e:new THREE.Plane,void 0!==f?f:new THREE.Plane]};
THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(a,b,c,d,e,f){var h=this.planes;h[0].copy(a);h[1].copy(b);h[2].copy(c);h[3].copy(d);h[4].copy(e);h[5].copy(f);return this},copy:function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements,a=c[0],d=c[1],e=c[2],f=c[3],h=c[4],g=c[5],i=c[6],j=c[7],l=c[8],q=c[9],t=c[10],r=c[11],x=c[12],p=c[13],n=c[14],c=c[15];b[0].setComponents(f-a,j-h,r-l,c-x).normalize();b[1].setComponents(f+
a,j+h,r+l,c+x).normalize();b[2].setComponents(f+d,j+g,r+q,c+p).normalize();b[3].setComponents(f-d,j-g,r-q,c-p).normalize();b[4].setComponents(f-e,j-i,r-t,c-n).normalize();b[5].setComponents(f+e,j+i,r+t,c+n).normalize();return this},intersectsObject:function(){var a=new THREE.Vector3;return function(b){var c=b.matrixWorld,d=this.planes,b=-b.geometry.boundingSphere.radius*c.getMaxScaleOnAxis();a.getPositionFromMatrix(c);for(c=0;6>c;c++)if(d[c].distanceToPoint(a)<b)return!1;return!0}}(),intersectsSphere:function(a){for(var b=
this.planes,c=a.center,a=-a.radius,d=0;6>d;d++)if(b[d].distanceToPoint(c)<a)return!1;return!0},containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}};THREE.Math={generateUUID:function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),b=Array(36),c=0,d;return function(){for(var e=0;36>e;e++)8==e||13==e||18==e||23==e?b[e]="-":14==e?b[e]="4":(2>=c&&(c=33554432+16777216*Math.random()|0),d=c&15,c>>=4,b[e]=a[19==e?d&3|8:d]);return b.join("")}}(),clamp:function(a,b,c){return a<b?b:a>c?c:a},clampBottom:function(a,b){return a<b?b:a},mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},smoothstep:function(a,b,c){if(a<=
b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},smootherstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*a*(a*(6*a-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(0.5-Math.random())},sign:function(a){return 0>a?-1:0<a?1:0},degToRad:function(){var a=Math.PI/180;return function(b){return b*
a}}(),radToDeg:function(){var a=180/Math.PI;return function(b){return b*a}}()};THREE.Triangle=function(a,b,c){this.a=void 0!==a?a:new THREE.Vector3;this.b=void 0!==b?b:new THREE.Vector3;this.c=void 0!==c?c:new THREE.Vector3};THREE.Triangle.normal=function(){var a=new THREE.Vector3;return function(b,c,d,e){e=e||new THREE.Vector3;e.subVectors(d,c);a.subVectors(b,c);e.cross(a);b=e.lengthSq();return 0<b?e.multiplyScalar(1/Math.sqrt(b)):e.set(0,0,0)}}();
THREE.Triangle.barycoordFromPoint=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e,f,h,g){a.subVectors(h,e);b.subVectors(f,e);c.subVectors(d,e);var d=a.dot(a),e=a.dot(b),f=a.dot(c),i=b.dot(b),h=b.dot(c),j=d*i-e*e,g=g||new THREE.Vector3;if(0==j)return g.set(-2,-1,-1);j=1/j;i=(i*f-e*h)*j;d=(d*h-e*f)*j;return g.set(1-i-d,d,i)}}();
THREE.Triangle.containsPoint=function(){var a=new THREE.Vector3;return function(b,c,d,e){b=THREE.Triangle.barycoordFromPoint(b,c,d,e,a);return 0<=b.x&&0<=b.y&&1>=b.x+b.y}}();
THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this},setFromPointsAndIndices:function(a,b,c,d){this.a.copy(a[b]);this.b.copy(a[c]);this.c.copy(a[d]);return this},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},area:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(){a.subVectors(this.c,this.b);b.subVectors(this.a,this.b);return 0.5*a.cross(b).length()}}(),midpoint:function(a){return(a||
new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(a){return THREE.Triangle.normal(this.a,this.b,this.c,a)},plane:function(a){return(a||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(a,b){return THREE.Triangle.barycoordFromPoint(a,this.a,this.b,this.c,b)},containsPoint:function(a){return THREE.Triangle.containsPoint(a,this.a,this.b,this.c)},equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)},
clone:function(){return(new THREE.Triangle).copy(this)}};THREE.Vertex=function(a){console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead.");return a};THREE.UV=function(a,b){console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead.");return new THREE.Vector2(a,b)};THREE.EventDispatcher=function(){};
THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,addEventListener:function(a,b){void 0===this._listeners&&(this._listeners={});var c=this._listeners;void 0===c[a]&&(c[a]=[]);-1===c[a].indexOf(b)&&c[a].push(b)},hasEventListener:function(a,b){if(void 0===this._listeners)return!1;var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)?!0:!1},removeEventListener:function(a,b){if(void 0!==this._listeners){var c=this._listeners,d=c[a].indexOf(b);-1!==d&&c[a].splice(d,1)}},dispatchEvent:function(a){if(void 0!==
this._listeners){var b=this._listeners[a.type];if(void 0!==b){a.target=this;for(var c=0,d=b.length;c<d;c++)b[c].call(this,a)}}}};(function(a){a.Raycaster=function(b,c,d,e){this.ray=new a.Ray(b,c);0<this.ray.direction.lengthSq()&&this.ray.direction.normalize();this.near=d||0;this.far=e||Infinity};var b=new a.Sphere,c=new a.Ray,d=new a.Plane,e=new a.Vector3,f=new a.Vector3,h=new a.Matrix4,g=function(a,b){return a.distance-b.distance},i=function(g,j,t){if(g instanceof a.Particle){f.getPositionFromMatrix(g.matrixWorld);var r=j.ray.distanceToPoint(f);if(r>g.scale.x)return t;t.push({distance:r,point:g.position,face:null,object:g})}else if(g instanceof
a.LOD)f.getPositionFromMatrix(g.matrixWorld),r=j.ray.origin.distanceTo(f),i(g.getObjectForDistance(r),j,t);else if(g instanceof a.Mesh){f.getPositionFromMatrix(g.matrixWorld);b.set(f,g.geometry.boundingSphere.radius*g.matrixWorld.getMaxScaleOnAxis());if(!1===j.ray.isIntersectionSphere(b))return t;var r=g.geometry,x=r.vertices;if(r instanceof a.BufferGeometry){var p=g.material;if(void 0===p||!r.dynamic)return t;var n=g.material instanceof a.MeshFaceMaterial,k=!0===n?g.material.materials:null,z=g.material.side,
y,D,H=j.precision;h.getInverse(g.matrixWorld);c.copy(j.ray).applyMatrix4(h);var E,x=!1;r.attributes.index&&(x=!0);n=new a.Vector3;k=new a.Vector3;E=new a.Vector3;new a.Vector3;new a.Vector3;for(var K=0;K<r.offsets.length;++K)for(var L=r.offsets[K].start,u=r.offsets[K].index,C=L,s=L+r.offsets[K].count;C<s;C+=3)if(x?(z=u+r.attributes.index.array[C],y=u+r.attributes.index.array[C+1],D=u+r.attributes.index.array[C+2]):(z=u,y=u+1,D=u+2),n.set(r.attributes.position.array[3*z],r.attributes.position.array[3*
z+1],r.attributes.position.array[3*z+2]),k.set(r.attributes.position.array[3*y],r.attributes.position.array[3*y+1],r.attributes.position.array[3*y+2]),E.set(r.attributes.position.array[3*D],r.attributes.position.array[3*D+1],r.attributes.position.array[3*D+2]),d.setFromCoplanarPoints(n,k,E),L=c.distanceToPlane(d),!(Math.abs(L)<H)&&!(0>L)){z=p.side;if(z!==a.DoubleSide&&(y=c.direction.dot(d.normal),!(z===a.FrontSide?0>y:0<y)))continue;L<j.near||L>j.far||(e=c.at(L,e),a.Triangle.containsPoint(e,n,k,E)&&
t.push({distance:L,point:j.ray.at(L),face:null,faceIndex:null,object:g}))}}else if(r instanceof a.Geometry){n=g.material instanceof a.MeshFaceMaterial;k=!0===n?g.material.materials:null;H=j.precision;h.getInverse(g.matrixWorld);c.copy(j.ray).applyMatrix4(h);K=0;for(E=r.faces.length;K<E;K++)if(u=r.faces[K],p=!0===n?k[u.materialIndex]:g.material,void 0!==p&&(d.setFromNormalAndCoplanarPoint(u.normal,x[u.a]),L=c.distanceToPlane(d),!(Math.abs(L)<H)&&!(0>L))){z=p.side;if(z!==a.DoubleSide&&(y=c.direction.dot(d.normal),
!(z===a.FrontSide?0>y:0<y)))continue;if(!(L<j.near||L>j.far)){e=c.at(L,e);if(u instanceof a.Face3){if(z=x[u.a],y=x[u.b],D=x[u.c],!a.Triangle.containsPoint(e,z,y,D))continue}else if(u instanceof a.Face4){if(z=x[u.a],y=x[u.b],D=x[u.c],p=x[u.d],!a.Triangle.containsPoint(e,z,y,p)&&!a.Triangle.containsPoint(e,y,D,p))continue}else throw Error("face type not supported");t.push({distance:L,point:j.ray.at(L),face:u,faceIndex:K,object:g})}}}}},j=function(a,b,c){for(var a=a.getDescendants(),d=0,e=a.length;d<
e;d++)i(a[d],b,c)};a.Raycaster.prototype.precision=1E-4;a.Raycaster.prototype.set=function(a,b){this.ray.set(a,b);0<this.ray.direction.length()&&this.ray.direction.normalize()};a.Raycaster.prototype.intersectObject=function(a,b){var c=[];!0===b&&j(a,this,c);i(a,this,c);c.sort(g);return c};a.Raycaster.prototype.intersectObjects=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++)i(a[d],this,c),!0===b&&j(a[d],this,c);c.sort(g);return c}})(THREE);THREE.Object3D=function(){this.id=THREE.Math.generateUUID();this.name="";this.parent=void 0;this.children=[];this.up=new THREE.Vector3(0,1,0);this.position=new THREE.Vector3;this.rotation=new THREE.Vector3;this.eulerOrder=THREE.Object3D.defaultEulerOrder;this.scale=new THREE.Vector3(1,1,1);this.renderDepth=null;this.rotationAutoUpdate=!0;this.matrix=new THREE.Matrix4;this.matrixWorld=new THREE.Matrix4;this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=!0;this.quaternion=new THREE.Quaternion;this.useQuaternion=
!1;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.userData={}};
THREE.Object3D.prototype={constructor:THREE.Object3D,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,applyMatrix:function(){var a=new THREE.Matrix4;return function(b){this.matrix.multiplyMatrices(b,this.matrix);this.position.getPositionFromMatrix(this.matrix);this.scale.getScaleFromMatrix(this.matrix);
a.extractRotation(this.matrix);!0===this.useQuaternion?this.quaternion.setFromRotationMatrix(a):this.rotation.setEulerFromRotationMatrix(a,this.eulerOrder)}}(),rotateOnAxis:function(){var a=new THREE.Quaternion,b=new THREE.Quaternion;return function(c,d){a.setFromAxisAngle(c,d);!0===this.useQuaternion?this.quaternion.multiply(a):(b.setFromEuler(this.rotation,this.eulerOrder),b.multiply(a),this.rotation.setEulerFromQuaternion(b,this.eulerOrder));return this}}(),translateOnAxis:function(){var a=new THREE.Vector3;
return function(b,c){a.copy(b);!0===this.useQuaternion?a.applyQuaternion(this.quaternion):a.applyEuler(this.rotation,this.eulerOrder);this.position.add(a.multiplyScalar(c));return this}}(),translate:function(a,b){console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed.");return this.translateOnAxis(b,a)},translateX:function(){var a=new THREE.Vector3(1,0,0);return function(b){return this.translateOnAxis(a,b)}}(),
translateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.translateOnAxis(a,b)}}(),translateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.translateOnAxis(a,b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new THREE.Matrix4;return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),lookAt:function(){var a=new THREE.Matrix4;return function(b){a.lookAt(b,this.position,this.up);
!0===this.useQuaternion?this.quaternion.setFromRotationMatrix(a):this.rotation.setEulerFromRotationMatrix(a,this.eulerOrder)}}(),add:function(a){if(a===this)console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");else if(a instanceof THREE.Object3D){void 0!==a.parent&&a.parent.remove(a);a.parent=this;this.children.push(a);for(var b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof THREE.Scene&&b.__addObject(a)}},remove:function(a){var b=this.children.indexOf(a);
if(-1!==b){a.parent=void 0;this.children.splice(b,1);for(b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof THREE.Scene&&b.__removeObject(a)}},traverse:function(a){a(this);for(var b=0,c=this.children.length;b<c;b++)this.children[b].traverse(a)},getObjectById:function(a,b){for(var c=0,d=this.children.length;c<d;c++){var e=this.children[c];if(e.id===a||!0===b&&(e=e.getObjectById(a,b),void 0!==e))return e}},getObjectByName:function(a,b){for(var c=0,d=this.children.length;c<d;c++){var e=this.children[c];
if(e.name===a||!0===b&&(e=e.getObjectByName(a,b),void 0!==e))return e}},getChildByName:function(a,b){console.warn("DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(a,b)},getDescendants:function(a){void 0===a&&(a=[]);Array.prototype.push.apply(a,this.children);for(var b=0,c=this.children.length;b<c;b++)this.children[b].getDescendants(a);return a},updateMatrix:function(){!1===this.useQuaternion?this.matrix.makeFromPositionEulerScale(this.position,
this.rotation,this.eulerOrder,this.scale):this.matrix.makeFromPositionQuaternionScale(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===a)void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)},
clone:function(a,b){void 0===a&&(a=new THREE.Object3D);void 0===b&&(b=!0);a.name=this.name;a.up.copy(this.up);a.position.copy(this.position);a.rotation instanceof THREE.Vector3&&a.rotation.copy(this.rotation);a.eulerOrder=this.eulerOrder;a.scale.copy(this.scale);a.renderDepth=this.renderDepth;a.rotationAutoUpdate=this.rotationAutoUpdate;a.matrix.copy(this.matrix);a.matrixWorld.copy(this.matrixWorld);a.matrixAutoUpdate=this.matrixAutoUpdate;a.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate;a.quaternion.copy(this.quaternion);
a.useQuaternion=this.useQuaternion;a.visible=this.visible;a.castShadow=this.castShadow;a.receiveShadow=this.receiveShadow;a.frustumCulled=this.frustumCulled;a.userData=JSON.parse(JSON.stringify(this.userData));if(!0===b)for(var c=0;c<this.children.length;c++)a.add(this.children[c].clone());return a}};THREE.Object3D.defaultEulerOrder="XYZ";THREE.Projector=function(){function a(){if(i===l){var a=new THREE.RenderableVertex;j.push(a);l++;i++;return a}return j[i++]}function b(a,b){return b.z-a.z}function c(a,b){var c=0,d=1,e=a.z+a.w,f=b.z+b.w,g=-a.z+a.w,h=-b.z+b.w;if(0<=e&&0<=f&&0<=g&&0<=h)return!0;if(0>e&&0>f||0>g&&0>h)return!1;0>e?c=Math.max(c,e/(e-f)):0>f&&(d=Math.min(d,e/(e-f)));0>g?c=Math.max(c,g/(g-h)):0>h&&(d=Math.min(d,g/(g-h)));if(d<c)return!1;a.lerp(b,c);b.lerp(a,1-d);return!0}var d,e,f=[],h=0,g,i,j=[],l=0,q,t,r=[],x=0,p,n=[],
k=0,z,y,D=[],H=0,E,K,L=[],u=0,C={objects:[],sprites:[],lights:[],elements:[]},s=new THREE.Vector3,A=new THREE.Vector4,G=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),m=new THREE.Box3,F=Array(3),w=Array(4),M=new THREE.Matrix4,v=new THREE.Matrix4,S,ha=new THREE.Matrix4,sa=new THREE.Matrix3,ta=new THREE.Matrix3,ua=new THREE.Vector3,pa=new THREE.Frustum,Z=new THREE.Vector4,ia=new THREE.Vector4;this.projectVector=function(a,b){b.matrixWorldInverse.getInverse(b.matrixWorld);v.multiplyMatrices(b.projectionMatrix,
b.matrixWorldInverse);return a.applyProjection(v)};this.unprojectVector=function(a,b){b.projectionMatrixInverse.getInverse(b.projectionMatrix);v.multiplyMatrices(b.matrixWorld,b.projectionMatrixInverse);return a.applyProjection(v)};this.pickingRay=function(a,b){a.z=-1;var c=new THREE.Vector3(a.x,a.y,1);this.unprojectVector(a,b);this.unprojectVector(c,b);c.sub(a).normalize();return new THREE.Raycaster(a,c)};var I=function(a){if(e===h){var b=new THREE.RenderableObject;f.push(b);h++;e++;d=b}else d=f[e++];
d.object=a;null!==a.renderDepth?d.z=a.renderDepth:(s.getPositionFromMatrix(a.matrixWorld),s.applyProjection(v),d.z=s.z);return d},N=function(a){if(!1!==a.visible){a instanceof THREE.Light?C.lights.push(a):a instanceof THREE.Mesh||a instanceof THREE.Line?(!1===a.frustumCulled||!0===pa.intersectsObject(a))&&C.objects.push(I(a)):(a instanceof THREE.Sprite||a instanceof THREE.Particle)&&C.sprites.push(I(a));for(var b=0,c=a.children.length;b<c;b++)N(a.children[b])}};this.projectScene=function(d,f,h,l){var s=
!1,I,P,R,J,O,Y,Q,T,da,ma,V,U,$;K=y=p=t=0;C.elements.length=0;!0===d.autoUpdate&&d.updateMatrixWorld();void 0===f.parent&&f.updateMatrixWorld();M.copy(f.matrixWorldInverse.getInverse(f.matrixWorld));v.multiplyMatrices(f.projectionMatrix,M);ta.getNormalMatrix(M);pa.setFromMatrix(v);e=0;C.objects.length=0;C.sprites.length=0;C.lights.length=0;N(d);!0===h&&C.objects.sort(b);d=0;for(h=C.objects.length;d<h;d++)if(T=C.objects[d].object,S=T.matrixWorld,i=0,T instanceof THREE.Mesh){da=T.geometry;R=da.vertices;
ma=da.faces;da=da.faceVertexUvs;sa.getNormalMatrix(S);U=T.material instanceof THREE.MeshFaceMaterial;$=!0===U?T.material:null;I=0;for(P=R.length;I<P;I++)g=a(),g.positionWorld.copy(R[I]).applyMatrix4(S),g.positionScreen.copy(g.positionWorld).applyMatrix4(v),g.positionScreen.x/=g.positionScreen.w,g.positionScreen.y/=g.positionScreen.w,g.positionScreen.z/=g.positionScreen.w,g.visible=!(-1>g.positionScreen.x||1<g.positionScreen.x||-1>g.positionScreen.y||1<g.positionScreen.y||-1>g.positionScreen.z||1<
g.positionScreen.z);R=0;for(I=ma.length;R<I;R++){P=ma[R];var W=!0===U?$.materials[P.materialIndex]:T.material;if(void 0!==W){Y=W.side;if(P instanceof THREE.Face3)if(J=j[P.a],O=j[P.b],Q=j[P.c],F[0]=J.positionScreen,F[1]=O.positionScreen,F[2]=Q.positionScreen,!0===J.visible||!0===O.visible||!0===Q.visible||G.isIntersectionBox(m.setFromPoints(F)))if(s=0>(Q.positionScreen.x-J.positionScreen.x)*(O.positionScreen.y-J.positionScreen.y)-(Q.positionScreen.y-J.positionScreen.y)*(O.positionScreen.x-J.positionScreen.x),
Y===THREE.DoubleSide||s===(Y===THREE.FrontSide))t===x?(V=new THREE.RenderableFace3,r.push(V),x++,t++,q=V):q=r[t++],q.v1.copy(J),q.v2.copy(O),q.v3.copy(Q);else continue;else continue;else if(P instanceof THREE.Face4)if(J=j[P.a],O=j[P.b],Q=j[P.c],V=j[P.d],w[0]=J.positionScreen,w[1]=O.positionScreen,w[2]=Q.positionScreen,w[3]=V.positionScreen,!0===J.visible||!0===O.visible||!0===Q.visible||!0===V.visible||G.isIntersectionBox(m.setFromPoints(w)))if(s=0>(V.positionScreen.x-J.positionScreen.x)*(O.positionScreen.y-
J.positionScreen.y)-(V.positionScreen.y-J.positionScreen.y)*(O.positionScreen.x-J.positionScreen.x)||0>(O.positionScreen.x-Q.positionScreen.x)*(V.positionScreen.y-Q.positionScreen.y)-(O.positionScreen.y-Q.positionScreen.y)*(V.positionScreen.x-Q.positionScreen.x),Y===THREE.DoubleSide||s===(Y===THREE.FrontSide)){if(p===k){var X=new THREE.RenderableFace4;n.push(X);k++;p++;q=X}else q=n[p++];q.v1.copy(J);q.v2.copy(O);q.v3.copy(Q);q.v4.copy(V)}else continue;else continue;q.normalModel.copy(P.normal);!1===
s&&(Y===THREE.BackSide||Y===THREE.DoubleSide)&&q.normalModel.negate();q.normalModel.applyMatrix3(sa).normalize();q.normalModelView.copy(q.normalModel).applyMatrix3(ta);q.centroidModel.copy(P.centroid).applyMatrix4(S);Q=P.vertexNormals;J=0;for(O=Q.length;J<O;J++)V=q.vertexNormalsModel[J],V.copy(Q[J]),!1===s&&(Y===THREE.BackSide||Y===THREE.DoubleSide)&&V.negate(),V.applyMatrix3(sa).normalize(),q.vertexNormalsModelView[J].copy(V).applyMatrix3(ta);q.vertexNormalsLength=Q.length;J=0;for(O=da.length;J<
O;J++)if(V=da[J][R],void 0!==V){Y=0;for(Q=V.length;Y<Q;Y++)q.uvs[J][Y]=V[Y]}q.color=P.color;q.material=W;ua.copy(q.centroidModel).applyProjection(v);q.z=ua.z;C.elements.push(q)}}}else if(T instanceof THREE.Line){ha.multiplyMatrices(v,S);R=T.geometry.vertices;J=a();J.positionScreen.copy(R[0]).applyMatrix4(ha);ma=T.type===THREE.LinePieces?2:1;I=1;for(P=R.length;I<P;I++)J=a(),J.positionScreen.copy(R[I]).applyMatrix4(ha),0<(I+1)%ma||(O=j[i-2],Z.copy(J.positionScreen),ia.copy(O.positionScreen),!0===c(Z,
ia)&&(Z.multiplyScalar(1/Z.w),ia.multiplyScalar(1/ia.w),y===H?(da=new THREE.RenderableLine,D.push(da),H++,y++,z=da):z=D[y++],z.v1.positionScreen.copy(Z),z.v2.positionScreen.copy(ia),z.z=Math.max(Z.z,ia.z),z.material=T.material,T.material.vertexColors===THREE.VertexColors&&(z.vertexColors[0].copy(T.geometry.colors[I]),z.vertexColors[1].copy(T.geometry.colors[I-1])),C.elements.push(z)))}d=0;for(h=C.sprites.length;d<h;d++)T=C.sprites[d].object,S=T.matrixWorld,T instanceof THREE.Particle&&(A.set(S.elements[12],
S.elements[13],S.elements[14],1),A.applyMatrix4(v),A.z/=A.w,0<A.z&&1>A.z&&(K===u?(s=new THREE.RenderableParticle,L.push(s),u++,K++,E=s):E=L[K++],E.object=T,E.x=A.x/A.w,E.y=A.y/A.w,E.z=A.z,E.rotation=T.rotation.z,E.scale.x=T.scale.x*Math.abs(E.x-(A.x+f.projectionMatrix.elements[0])/(A.w+f.projectionMatrix.elements[12])),E.scale.y=T.scale.y*Math.abs(E.y-(A.y+f.projectionMatrix.elements[5])/(A.w+f.projectionMatrix.elements[13])),E.material=T.material,C.elements.push(E)));!0===l&&C.elements.sort(b);return C}};THREE.Face3=function(a,b,c,d,e,f){this.a=a;this.b=b;this.c=c;this.normal=d instanceof THREE.Vector3?d:new THREE.Vector3;this.vertexNormals=d instanceof Array?d:[];this.color=e instanceof THREE.Color?e:new THREE.Color;this.vertexColors=e instanceof Array?e:[];this.vertexTangents=[];this.materialIndex=void 0!==f?f:0;this.centroid=new THREE.Vector3};
THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var a=new THREE.Face3(this.a,this.b,this.c);a.normal.copy(this.normal);a.color.copy(this.color);a.centroid.copy(this.centroid);a.materialIndex=this.materialIndex;var b,c;b=0;for(c=this.vertexNormals.length;b<c;b++)a.vertexNormals[b]=this.vertexNormals[b].clone();b=0;for(c=this.vertexColors.length;b<c;b++)a.vertexColors[b]=this.vertexColors[b].clone();b=0;for(c=this.vertexTangents.length;b<c;b++)a.vertexTangents[b]=this.vertexTangents[b].clone();
return a}};THREE.Face4=function(a,b,c,d,e,f,h){this.a=a;this.b=b;this.c=c;this.d=d;this.normal=e instanceof THREE.Vector3?e:new THREE.Vector3;this.vertexNormals=e instanceof Array?e:[];this.color=f instanceof THREE.Color?f:new THREE.Color;this.vertexColors=f instanceof Array?f:[];this.vertexTangents=[];this.materialIndex=void 0!==h?h:0;this.centroid=new THREE.Vector3};
THREE.Face4.prototype={constructor:THREE.Face4,clone:function(){var a=new THREE.Face4(this.a,this.b,this.c,this.d);a.normal.copy(this.normal);a.color.copy(this.color);a.centroid.copy(this.centroid);a.materialIndex=this.materialIndex;var b,c;b=0;for(c=this.vertexNormals.length;b<c;b++)a.vertexNormals[b]=this.vertexNormals[b].clone();b=0;for(c=this.vertexColors.length;b<c;b++)a.vertexColors[b]=this.vertexColors[b].clone();b=0;for(c=this.vertexTangents.length;b<c;b++)a.vertexTangents[b]=this.vertexTangents[b].clone();
return a}};THREE.Geometry=function(){this.id=THREE.Math.generateUUID();this.name="";this.vertices=[];this.colors=[];this.normals=[];this.faces=[];this.faceUvs=[[]];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.hasTangents=!1;this.dynamic=!0;this.buffersNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.tangentsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=
this.elementsNeedUpdate=this.verticesNeedUpdate=!1};
THREE.Geometry.prototype={constructor:THREE.Geometry,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,applyMatrix:function(a){for(var b=(new THREE.Matrix3).getNormalMatrix(a),c=0,d=this.vertices.length;c<d;c++)this.vertices[c].applyMatrix4(a);c=0;for(d=this.faces.length;c<d;c++){var e=
this.faces[c];e.normal.applyMatrix3(b).normalize();for(var f=0,h=e.vertexNormals.length;f<h;f++)e.vertexNormals[f].applyMatrix3(b).normalize();e.centroid.applyMatrix4(a)}this.boundingBox instanceof THREE.Box3&&this.computeBoundingBox();this.boundingSphere instanceof THREE.Sphere&&this.computeBoundingSphere()},computeCentroids:function(){var a,b,c;a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],c.centroid.set(0,0,0),c instanceof THREE.Face3?(c.centroid.add(this.vertices[c.a]),c.centroid.add(this.vertices[c.b]),
c.centroid.add(this.vertices[c.c]),c.centroid.divideScalar(3)):c instanceof THREE.Face4&&(c.centroid.add(this.vertices[c.a]),c.centroid.add(this.vertices[c.b]),c.centroid.add(this.vertices[c.c]),c.centroid.add(this.vertices[c.d]),c.centroid.divideScalar(4))},computeFaceNormals:function(){for(var a=new THREE.Vector3,b=new THREE.Vector3,c=0,d=this.faces.length;c<d;c++){var e=this.faces[c],f=this.vertices[e.a],h=this.vertices[e.b];a.subVectors(this.vertices[e.c],h);b.subVectors(f,h);a.cross(b);a.normalize();
e.normal.copy(a)}},computeVertexNormals:function(a){var b,c,d,e;if(void 0===this.__tmpVertices){e=this.__tmpVertices=Array(this.vertices.length);b=0;for(c=this.vertices.length;b<c;b++)e[b]=new THREE.Vector3;b=0;for(c=this.faces.length;b<c;b++)d=this.faces[b],d instanceof THREE.Face3?d.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]:d instanceof THREE.Face4&&(d.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3])}else{e=this.__tmpVertices;b=
0;for(c=this.vertices.length;b<c;b++)e[b].set(0,0,0)}if(a){var f,h,g,i=new THREE.Vector3,j=new THREE.Vector3,l=new THREE.Vector3,q=new THREE.Vector3,t=new THREE.Vector3;b=0;for(c=this.faces.length;b<c;b++)d=this.faces[b],d instanceof THREE.Face3?(a=this.vertices[d.a],f=this.vertices[d.b],h=this.vertices[d.c],i.subVectors(h,f),j.subVectors(a,f),i.cross(j),e[d.a].add(i),e[d.b].add(i),e[d.c].add(i)):d instanceof THREE.Face4&&(a=this.vertices[d.a],f=this.vertices[d.b],h=this.vertices[d.c],g=this.vertices[d.d],
l.subVectors(g,f),j.subVectors(a,f),l.cross(j),e[d.a].add(l),e[d.b].add(l),e[d.d].add(l),q.subVectors(g,h),t.subVectors(f,h),q.cross(t),e[d.b].add(q),e[d.c].add(q),e[d.d].add(q))}else{b=0;for(c=this.faces.length;b<c;b++)d=this.faces[b],d instanceof THREE.Face3?(e[d.a].add(d.normal),e[d.b].add(d.normal),e[d.c].add(d.normal)):d instanceof THREE.Face4&&(e[d.a].add(d.normal),e[d.b].add(d.normal),e[d.c].add(d.normal),e[d.d].add(d.normal))}b=0;for(c=this.vertices.length;b<c;b++)e[b].normalize();b=0;for(c=
this.faces.length;b<c;b++)d=this.faces[b],d instanceof THREE.Face3?(d.vertexNormals[0].copy(e[d.a]),d.vertexNormals[1].copy(e[d.b]),d.vertexNormals[2].copy(e[d.c])):d instanceof THREE.Face4&&(d.vertexNormals[0].copy(e[d.a]),d.vertexNormals[1].copy(e[d.b]),d.vertexNormals[2].copy(e[d.c]),d.vertexNormals[3].copy(e[d.d]))},computeVertexNormalsAsync:function(a,b,c,d){function e(a,b,c){a[3*b]+=c.x;a[3*b+1]+=c.y;a[3*b+2]+=c.z}function f(a,b,d,e,f){for(var g=0,h=b,i=(d-b)/k.faces.length;g<k.faces.length;)(function(b){setTimeout(function(){var g=
b,j=0;do a(k.faces[g],g),g++,j++;while(j<f&&g<k.faces.length);g<k.faces.length?(h+=i*f,c&&c(h)):(c(d),e())},0)})(g),g+=f}function h(a){a instanceof THREE.Face3?(e(p,a.a,a.normal),e(p,a.b,a.normal),e(p,a.c,a.normal)):a instanceof THREE.Face4&&(e(p,a.a,a.normal),e(p,a.b,a.normal),e(p,a.c,a.normal),e(p,a.d,a.normal))}function g(){l=0;for(q=k.vertices.length;l<q;l++)n.x=p[3*l],n.y=p[3*l+1],n.z=p[3*l+2],n.normalize(),p[3*l]=n.x,p[3*l+1]=n.y,p[3*l+2]=n.z}function i(a){a instanceof THREE.Face3?(a.vertexNormals[0].set(p[3*
a.a],p[3*a.a+1],p[3*a.a+2]),a.vertexNormals[1].set(p[3*a.b],p[3*a.b+1],p[3*a.b+2]),a.vertexNormals[2].set(p[3*a.c],p[3*a.c+1],p[3*a.c+2])):a instanceof THREE.Face4&&(a.vertexNormals[0].set(p[3*a.a],p[3*a.a+1],p[3*a.a+2]),a.vertexNormals[1].set(p[3*a.b],p[3*a.b+1],p[3*a.b+2]),a.vertexNormals[2].set(p[3*a.c],p[3*a.c+1],p[3*a.c+2]),a.vertexNormals[3].set(p[3*a.d],p[3*a.d+1],p[3*a.d+2]))}function j(a){a instanceof THREE.Face3?(z.set(k.vertices[3*a.c]-k.vertices[3*a.b],k.vertices[3*a.c+1]-k.vertices[3*
a.b+1],k.vertices[3*a.c+2]-k.vertices[3*a.b+2]),y.set(k.vertices[3*a.a]-k.vertices[3*a.b],k.vertices[3*a.a+1]-k.vertices[3*a.b+1],k.vertices[3*a.a+2]-k.vertices[3*a.b+2]),z.cross(y),e(p,a.a,z),e(p,a.b,z),e(p,a.c,z)):a instanceof THREE.Face4&&(D.set(k.vertices[3*a.d]-k.vertices[3*a.b],k.vertices[3*a.d+1]-k.vertices[3*a.b+1],k.vertices[3*a.d+2]-k.vertices[3*a.b+2]),y.set(k.vertices[3*a.a]-k.vertices[3*a.b],k.vertices[3*a.a+1]-k.vertices[3*a.b+1],k.vertices[3*a.a+2]-k.vertices[3*a.b+2]),D.cross(y),e(p,
a.a,D),e(p,a.b,D),e(p,a.d,D),H.set(k.vertices[3*a.d]-k.vertices[3*a.c],k.vertices[3*a.d+1]-k.vertices[3*a.c+1],k.vertices[3*a.d+2]-k.vertices[3*a.c+2]),E.set(k.vertices[3*a.b]-k.vertices[3*a.c],k.vertices[3*a.b+1]-k.vertices[3*a.c+1],k.vertices[3*a.b+2]-k.vertices[3*a.c+2]),H.cross(E),e(p,a.b,H),e(p,a.c,H),e(p,a.d,H))}var l,q,t,r,x,p,n;n=new THREE.Vector3;var k=this,z=new THREE.Vector3,y=new THREE.Vector3,D=new THREE.Vector3,H=new THREE.Vector3,E=new THREE.Vector3;void 0===d&&(d=1E5);if(void 0===
this.__tmpVertices){t=new ArrayBuffer(12*this.vertices.length);p=this.__tmpVertices=new Float32Array(t);t=0;for(r=this.faces.length;t<r;t++)x=this.faces[t],x instanceof THREE.Face3?x.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]:x instanceof THREE.Face4&&(x.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3])}else{p=this.__tmpVertices;l=0;for(q=this.vertices.length;l<q;l++)p[3*l]=0,p[3*l+1]=0,p[3*l+2]=0}setTimeout(function(){a?f(j,0,0.5,
function(){g();f(i,0.5,1,function(){b&&b()},d)},d):f(h,0,0.5,function(){g();f(i,0.5,1,function(){b&&b()},d)},d)},0)},computeMorphNormals:function(){var a,b,c,d,e;c=0;for(d=this.faces.length;c<d;c++){e=this.faces[c];e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone();e.__originalVertexNormals||(e.__originalVertexNormals=[]);a=0;for(b=e.vertexNormals.length;a<b;a++)e.__originalVertexNormals[a]?e.__originalVertexNormals[a].copy(e.vertexNormals[a]):e.__originalVertexNormals[a]=
e.vertexNormals[a].clone()}var f=new THREE.Geometry;f.faces=this.faces;a=0;for(b=this.morphTargets.length;a<b;a++){if(!this.morphNormals[a]){this.morphNormals[a]={};this.morphNormals[a].faceNormals=[];this.morphNormals[a].vertexNormals=[];var h=this.morphNormals[a].faceNormals,g=this.morphNormals[a].vertexNormals,i,j;c=0;for(d=this.faces.length;c<d;c++)e=this.faces[c],i=new THREE.Vector3,j=e instanceof THREE.Face3?{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3}:{a:new THREE.Vector3,
b:new THREE.Vector3,c:new THREE.Vector3,d:new THREE.Vector3},h.push(i),g.push(j)}h=this.morphNormals[a];f.vertices=this.morphTargets[a].vertices;f.computeFaceNormals();f.computeVertexNormals();c=0;for(d=this.faces.length;c<d;c++)e=this.faces[c],i=h.faceNormals[c],j=h.vertexNormals[c],i.copy(e.normal),e instanceof THREE.Face3?(j.a.copy(e.vertexNormals[0]),j.b.copy(e.vertexNormals[1]),j.c.copy(e.vertexNormals[2])):(j.a.copy(e.vertexNormals[0]),j.b.copy(e.vertexNormals[1]),j.c.copy(e.vertexNormals[2]),
j.d.copy(e.vertexNormals[3]))}c=0;for(d=this.faces.length;c<d;c++)e=this.faces[c],e.normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals},computeTangents:function(){function a(a,b,c,d,e,f,m){g=a.vertices[b];i=a.vertices[c];j=a.vertices[d];l=h[e];q=h[f];t=h[m];r=i.x-g.x;x=j.x-g.x;p=i.y-g.y;n=j.y-g.y;k=i.z-g.z;z=j.z-g.z;y=q.x-l.x;D=t.x-l.x;H=q.y-l.y;E=t.y-l.y;K=1/(y*E-D*H);s.set((E*r-H*x)*K,(E*p-H*n)*K,(E*k-H*z)*K);A.set((y*x-D*r)*K,(y*n-D*p)*K,(y*z-D*k)*K);u[b].add(s);u[c].add(s);
u[d].add(s);C[b].add(A);C[c].add(A);C[d].add(A)}var b,c,d,e,f,h,g,i,j,l,q,t,r,x,p,n,k,z,y,D,H,E,K,L,u=[],C=[],s=new THREE.Vector3,A=new THREE.Vector3,G=new THREE.Vector3,m=new THREE.Vector3,F=new THREE.Vector3;b=0;for(c=this.vertices.length;b<c;b++)u[b]=new THREE.Vector3,C[b]=new THREE.Vector3;b=0;for(c=this.faces.length;b<c;b++)f=this.faces[b],h=this.faceVertexUvs[0][b],f instanceof THREE.Face3?a(this,f.a,f.b,f.c,0,1,2):f instanceof THREE.Face4&&(a(this,f.a,f.b,f.d,0,1,3),a(this,f.b,f.c,f.d,1,2,
3));var w=["a","b","c","d"];b=0;for(c=this.faces.length;b<c;b++){f=this.faces[b];for(d=0;d<f.vertexNormals.length;d++)F.copy(f.vertexNormals[d]),e=f[w[d]],L=u[e],G.copy(L),G.sub(F.multiplyScalar(F.dot(L))).normalize(),m.crossVectors(f.vertexNormals[d],L),e=m.dot(C[e]),e=0>e?-1:1,f.vertexTangents[d]=new THREE.Vector4(G.x,G.y,G.z,e)}this.hasTangents=!0},computeTangentsAsync:function(a,b,c){function d(a,b){ia.set(a[3*b],a[3*b+1],a[3*b+2]);return ia}function e(a,b,c){a[3*b]+=c.x;a[3*b+1]+=c.y;a[3*b+2]+=
c.z}function f(a,b,c,d,f,g,h){function i(a,b){!a[b]&&0!=a[b]?a[b]=0:Infinity===a[b]?a[b]=1:-Infinity===a[b]&&(a[b]=-1)}r=a.vertices[b];x=a.vertices[c];p=a.vertices[d];n=t[f];k=t[g];z=t[h];y=x.x-r.x;D=p.x-r.x;H=x.y-r.y;E=p.y-r.y;K=x.z-r.z;L=p.z-r.z;u=k.x-n.x;C=z.x-n.x;s=k.y-n.y;A=z.y-n.y;G=1/(u*A-C*s);w.set((A*y-s*D)*G,(A*H-s*E)*G,(A*K-s*L)*G);M.set((u*D-C*y)*G,(u*E-C*H)*G,(u*L-C*K)*G);i(w,"x");i(w,"y");i(w,"z");i(M,"x");i(M,"y");i(M,"z");e(pa,b,w);e(pa,c,w);e(pa,d,w);e(Z,b,M);e(Z,c,M);e(Z,d,M)}function h(a,
c,d,e,f){for(var g=0,h=c,i=(d-c)/N.faces.length;g<N.faces.length;)(function(c){setTimeout(function(){var g=c,j=0;do a(N.faces[g],g),g++,j++;while(j<f&&g<N.faces.length);g<N.faces.length?(h+=i*f,b&&b(h)):(b(d),e())},0)})(g),g+=f}function g(a){for(j=0;j<a.vertexNormals.length;j++)ha.copy(a.vertexNormals[j]),l=a[I[j]],m=d(pa,l),v.copy(m),v.sub(ha.multiplyScalar(ha.dot(m))).normalize(),S.crossVectors(a.vertexNormals[j],m),F=S.dot(d(Z,l)),sa=0>F?-1:1,a.vertexTangents[j].set(v.x,v.y,v.z,sa)}var i,j,l,q,
t,r,x,p,n,k,z,y,D,H,E,K,L,u,C,s,A,G,m,F,w=new THREE.Vector3,M=new THREE.Vector3,v=new THREE.Vector3,S=new THREE.Vector3,ha=new THREE.Vector3,sa;for(i=0;i<this.faces.length;i++){q=this.faces[i];for(j=0;j<q.vertexNormals.length;j++)q.vertexTangents[j]=new THREE.Vector4}void 0===c&&(c=1E5);i=12*this.vertices.length;var ta=new ArrayBuffer(i),ua=new ArrayBuffer(i),pa=new Float32Array(ta),Z=new Float32Array(ua),ia=new THREE.Vector3,I=["a","b","c","d"],N=this;h(function(a,b){t=N.faceVertexUvs[0][b];a instanceof
THREE.Face3?f(N,a.a,a.b,a.c,0,1,2):a instanceof THREE.Face4&&(f(N,a.a,a.b,a.d,0,1,3),f(N,a.b,a.c,a.d,1,2,3))},0,0.3,function(){h(g,0.3,1,function(){N.hasTangents=!0;a&&(ua=ta=Z=pa=ia=void 0,a())},c)},c)},computeTangentsAsync_Partial:function(a,b,c){function d(a,b,c,d,e,f,g){function h(a,b){!a[b]&&0!=a[b]?a[b]=0:Infinity===a[b]?a[b]=1:-Infinity===a[b]&&(a[b]=-1)}q=a.vertices[b];t=a.vertices[c];r=a.vertices[d];x=l[e];p=l[f];n=l[g];k=t.x-q.x;z=r.x-q.x;y=t.y-q.y;D=r.y-q.y;H=t.z-q.z;E=r.z-q.z;K=p.x-x.x;
L=n.x-x.x;u=p.y-x.y;C=n.y-x.y;s=1/(K*C-L*u);A.set((C*k-u*z)*s,(C*y-u*D)*s,(C*H-u*E)*s);G.set((K*z-L*k)*s,(K*D-L*y)*s,(K*E-L*H)*s);h(A,"x");h(A,"y");h(G,"x");h(G,"y");m[b].x+=A.x;m[b].y+=A.y;m[c].x+=A.x;m[c].y+=A.y;m[d].x+=A.x;m[d].y+=A.y;m[b].z+=G.x;m[b].w+=G.y;m[c].z+=G.x;m[c].w+=G.y;m[d].z+=G.x;m[d].w+=G.y}function e(a,c,d,e,f){for(var g=0,h=c,i=(d-c)/w.faces.length;g<w.faces.length;)(function(c){setTimeout(function(){var g=c,j=0;do a(w.faces[g],g),g++,j++;while(j<f&&g<w.faces.length);g<w.faces.length?
(h+=i*f,b&&b(h)):(b(d),e())},0)})(g),g+=f}function f(a){for(i=0;i<a.vertexNormals.length;i++)j=a[F[i]],a.vertexTangents[i]=m[j]}var h,g,i,j,l,q,t,r,x,p,n,k,z,y,D,H,E,K,L,u,C,s,A=new THREE.Vector3,G=new THREE.Vector3;new THREE.Vector3;new THREE.Vector3;new THREE.Vector3;var m=[];h=0;for(g=this.vertices.length;h<g;h++)m[h]=new THREE.Vector4;void 0===c&&(c=1E5);var F=["a","b","c","d"],w=this;e(function(a,b){l=w.faceVertexUvs[0][b];a instanceof THREE.Face3?d(w,a.a,a.b,a.c,0,1,2):a instanceof THREE.Face4&&
(d(w,a.a,a.b,a.d,0,1,3),d(w,a.b,a.c,a.d,1,2,3))},0,0.3,function(){e(f,0.3,1,function(){w.hasTangents=!0;a&&a()},c)},c)},computeLineDistances:function(){for(var a=0,b=this.vertices,c=0,d=b.length;c<d;c++)0<c&&(a+=b[c].distanceTo(b[c-1])),this.lineDistances[c]=a},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);this.boundingSphere.setFromPoints(this.vertices)},
mergeVertices:function(){var a={},b=[],c=[],d,e=Math.pow(10,4),f,h,g,i,j;this.__tmpVertices=void 0;f=0;for(h=this.vertices.length;f<h;f++)d=this.vertices[f],d=Math.round(d.x*e)+"_"+Math.round(d.y*e)+"_"+Math.round(d.z*e),void 0===a[d]?(a[d]=f,b.push(this.vertices[f]),c[f]=b.length-1):c[f]=c[a[d]];e=[];f=0;for(h=this.faces.length;f<h;f++)if(a=this.faces[f],a instanceof THREE.Face3){a.a=c[a.a];a.b=c[a.b];a.c=c[a.c];g=[a.a,a.b,a.c];d=-1;for(i=0;3>i;i++)if(g[i]==g[(i+1)%3]){e.push(f);break}}else if(a instanceof
THREE.Face4){a.a=c[a.a];a.b=c[a.b];a.c=c[a.c];a.d=c[a.d];g=[a.a,a.b,a.c,a.d];d=-1;for(i=0;4>i;i++)g[i]==g[(i+1)%4]&&(0<=d&&e.push(f),d=i);if(0<=d){g.splice(d,1);var l=new THREE.Face3(g[0],g[1],g[2],a.normal,a.color,a.materialIndex);g=0;for(i=this.faceVertexUvs.length;g<i;g++)(j=this.faceVertexUvs[g][f])&&j.splice(d,1);a.vertexNormals&&0<a.vertexNormals.length&&(l.vertexNormals=a.vertexNormals,l.vertexNormals.splice(d,1));a.vertexColors&&0<a.vertexColors.length&&(l.vertexColors=a.vertexColors,l.vertexColors.splice(d,
1));this.faces[f]=l}}for(f=e.length-1;0<=f;f--){this.faces.splice(f,1);g=0;for(i=this.faceVertexUvs.length;g<i;g++)this.faceVertexUvs[g].splice(f,1)}c=this.vertices.length-b.length;this.vertices=b;return c},clone:function(){for(var a=new THREE.Geometry,b=this.vertices,c=0,d=b.length;c<d;c++)a.vertices.push(b[c].clone());b=this.faces;c=0;for(d=b.length;c<d;c++)a.faces.push(b[c].clone());b=this.faceVertexUvs[0];c=0;for(d=b.length;c<d;c++){for(var e=b[c],f=[],h=0,g=e.length;h<g;h++)f.push(new THREE.Vector2(e[h].x,
e[h].y));a.faceVertexUvs[0].push(f)}return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.Camera=function(){THREE.Object3D.call(this);this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=new THREE.Matrix4;this.projectionMatrixInverse=new THREE.Matrix4};THREE.Camera.prototype=Object.create(THREE.Object3D.prototype);THREE.Camera.prototype.lookAt=function(){var a=new THREE.Matrix4;return function(b){a.lookAt(this.position,b,this.up);!0===this.useQuaternion?this.quaternion.setFromRotationMatrix(a):this.rotation.setEulerFromRotationMatrix(a,this.eulerOrder)}}();THREE.OrthographicCamera=function(a,b,c,d,e,f){THREE.Camera.call(this);this.left=a;this.right=b;this.top=c;this.bottom=d;this.near=void 0!==e?e:0.1;this.far=void 0!==f?f:2E3;this.updateProjectionMatrix()};THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype);THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)};THREE.PerspectiveCamera=function(a,b,c,d){THREE.Camera.call(this);this.fov=void 0!==a?a:50;this.aspect=void 0!==b?b:1;this.near=void 0!==c?c:0.1;this.far=void 0!==d?d:2E3;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype);THREE.PerspectiveCamera.prototype.setLens=function(a,b){void 0===b&&(b=24);this.fov=2*THREE.Math.radToDeg(Math.atan(b/(2*a)));this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.setViewOffset=function(a,b,c,d,e,f){this.fullWidth=a;this.fullHeight=b;this.x=c;this.y=d;this.width=e;this.height=f;this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var a=this.fullWidth/this.fullHeight,b=Math.tan(THREE.Math.degToRad(0.5*this.fov))*this.near,c=-b,d=a*c,a=Math.abs(a*b-d),c=Math.abs(b-c);this.projectionMatrix.makeFrustum(d+this.x*a/this.fullWidth,d+(this.x+this.width)*a/this.fullWidth,b-(this.y+this.height)*c/this.fullHeight,b-this.y*c/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)};THREE.Light=function(a){THREE.Object3D.call(this);this.color=new THREE.Color(a)};THREE.Light.prototype=Object.create(THREE.Object3D.prototype);THREE.Light.prototype.clone=function(a){void 0===a&&(a=new THREE.Light);THREE.Object3D.prototype.clone.call(this,a);a.color.copy(this.color);return a};THREE.AmbientLight=function(a){THREE.Light.call(this,a)};THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype);THREE.AmbientLight.prototype.clone=function(){var a=new THREE.AmbientLight;THREE.Light.prototype.clone.call(this,a);return a};THREE.DirectionalLight=function(a,b){THREE.Light.call(this,a);this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==b?b:1;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5E3;this.shadowCameraLeft=-500;this.shadowCameraTop=this.shadowCameraRight=500;this.shadowCameraBottom=-500;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowCascade=!1;this.shadowCascadeOffset=new THREE.Vector3(0,
0,-1E3);this.shadowCascadeCount=2;this.shadowCascadeBias=[0,0,0];this.shadowCascadeWidth=[512,512,512];this.shadowCascadeHeight=[512,512,512];this.shadowCascadeNearZ=[-1,0.99,0.998];this.shadowCascadeFarZ=[0.99,0.998,1];this.shadowCascadeArray=[];this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null};THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype);
THREE.DirectionalLight.prototype.clone=function(){var a=new THREE.DirectionalLight;THREE.Light.prototype.clone.call(this,a);a.target=this.target.clone();a.intensity=this.intensity;a.castShadow=this.castShadow;a.onlyShadow=this.onlyShadow;return a};THREE.PointLight=function(a,b,c){THREE.Light.call(this,a);this.intensity=void 0!==b?b:1;this.distance=void 0!==c?c:0};THREE.PointLight.prototype=Object.create(THREE.Light.prototype);THREE.PointLight.prototype.clone=function(){var a=new THREE.PointLight;THREE.Light.prototype.clone.call(this,a);a.intensity=this.intensity;a.distance=this.distance;return a};THREE.Loader=function(a){this.statusDomElement=(this.showStatus=a)?THREE.Loader.prototype.addStatusElement():null;this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};
THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:"anonymous",addStatusElement:function(){var a=document.createElement("div");a.style.position="absolute";a.style.right="0px";a.style.top="0px";a.style.fontSize="0.8em";a.style.textAlign="left";a.style.background="rgba(0,0,0,0.25)";a.style.color="#fff";a.style.width="120px";a.style.padding="0.5em 0.5em 0.5em 0.5em";a.style.zIndex=1E3;a.innerHTML="Loading ...";return a},updateProgress:function(a){var b="Loaded ",b=a.total?b+((100*a.loaded/
a.total).toFixed(0)+"%"):b+((a.loaded/1E3).toFixed(2)+" KB");this.statusDomElement.innerHTML=b},extractUrlBase:function(a){a=a.split("/");a.pop();return(1>a.length?".":a.join("/"))+"/"},initMaterials:function(a,b){for(var c=[],d=0;d<a.length;++d)c[d]=THREE.Loader.prototype.createMaterial(a[d],b);return c},needsTangents:function(a){for(var b=0,c=a.length;b<c;b++)if(a[b]instanceof THREE.ShaderMaterial)return!0;return!1},createMaterial:function(a,b){function c(a){a=Math.log(a)/Math.LN2;return Math.floor(a)==
a}function d(a){a=Math.log(a)/Math.LN2;return Math.pow(2,Math.round(a))}function e(a,e,f,g,i,j,n){var k=/\.dds$/i.test(f),z=b+"/"+f;if(k){var y=THREE.ImageUtils.loadCompressedTexture(z);a[e]=y}else y=document.createElement("canvas"),a[e]=new THREE.Texture(y);a[e].sourceFile=f;g&&(a[e].repeat.set(g[0],g[1]),1!==g[0]&&(a[e].wrapS=THREE.RepeatWrapping),1!==g[1]&&(a[e].wrapT=THREE.RepeatWrapping));i&&a[e].offset.set(i[0],i[1]);j&&(f={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==
f[j[0]]&&(a[e].wrapS=f[j[0]]),void 0!==f[j[1]]&&(a[e].wrapT=f[j[1]]));n&&(a[e].anisotropy=n);if(!k){var D=a[e],a=new Image;a.onload=function(){if(!c(this.width)||!c(this.height)){var a=d(this.width),b=d(this.height);D.image.width=a;D.image.height=b;D.image.getContext("2d").drawImage(this,0,0,a,b)}else D.image=this;D.needsUpdate=!0};a.crossOrigin=h.crossOrigin;a.src=z}}function f(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]}var h=this,g="MeshLambertMaterial",i={color:15658734,opacity:1,map:null,
lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(a.shading){var j=a.shading.toLowerCase();"phong"===j?g="MeshPhongMaterial":"basic"===j&&(g="MeshBasicMaterial")}void 0!==a.blending&&void 0!==THREE[a.blending]&&(i.blending=THREE[a.blending]);if(void 0!==a.transparent||1>a.opacity)i.transparent=a.transparent;void 0!==a.depthTest&&(i.depthTest=a.depthTest);void 0!==a.depthWrite&&(i.depthWrite=a.depthWrite);void 0!==a.visible&&(i.visible=a.visible);void 0!==a.flipSided&&(i.side=THREE.BackSide);
void 0!==a.doubleSided&&(i.side=THREE.DoubleSide);void 0!==a.wireframe&&(i.wireframe=a.wireframe);void 0!==a.vertexColors&&("face"===a.vertexColors?i.vertexColors=THREE.FaceColors:a.vertexColors&&(i.vertexColors=THREE.VertexColors));a.colorDiffuse?i.color=f(a.colorDiffuse):a.DbgColor&&(i.color=a.DbgColor);a.colorSpecular&&(i.specular=f(a.colorSpecular));a.colorAmbient&&(i.ambient=f(a.colorAmbient));a.transparency&&(i.opacity=a.transparency);a.specularCoef&&(i.shininess=a.specularCoef);a.mapDiffuse&&
b&&e(i,"map",a.mapDiffuse,a.mapDiffuseRepeat,a.mapDiffuseOffset,a.mapDiffuseWrap,a.mapDiffuseAnisotropy);a.mapLight&&b&&e(i,"lightMap",a.mapLight,a.mapLightRepeat,a.mapLightOffset,a.mapLightWrap,a.mapLightAnisotropy);a.mapBump&&b&&e(i,"bumpMap",a.mapBump,a.mapBumpRepeat,a.mapBumpOffset,a.mapBumpWrap,a.mapBumpAnisotropy);a.mapNormal&&b&&e(i,"normalMap",a.mapNormal,a.mapNormalRepeat,a.mapNormalOffset,a.mapNormalWrap,a.mapNormalAnisotropy);a.mapSpecular&&b&&e(i,"specularMap",a.mapSpecular,a.mapSpecularRepeat,
a.mapSpecularOffset,a.mapSpecularWrap,a.mapSpecularAnisotropy);a.mapBumpScale&&(i.bumpScale=a.mapBumpScale);a.mapNormal?(g=THREE.ShaderLib.normalmap,j=THREE.UniformsUtils.clone(g.uniforms),j.tNormal.value=i.normalMap,a.mapNormalFactor&&j.uNormalScale.value.set(a.mapNormalFactor,a.mapNormalFactor),i.map&&(j.tDiffuse.value=i.map,j.enableDiffuse.value=!0),i.specularMap&&(j.tSpecular.value=i.specularMap,j.enableSpecular.value=!0),i.lightMap&&(j.tAO.value=i.lightMap,j.enableAO.value=!0),j.uDiffuseColor.value.setHex(i.color),
j.uSpecularColor.value.setHex(i.specular),j.uAmbientColor.value.setHex(i.ambient),j.uShininess.value=i.shininess,void 0!==i.opacity&&(j.uOpacity.value=i.opacity),g=new THREE.ShaderMaterial({fragmentShader:g.fragmentShader,vertexShader:g.vertexShader,uniforms:j,lights:!0,fog:!0}),i.transparent&&(g.transparent=!0)):g=new THREE[g](i);void 0!==a.DbgName&&(g.name=a.DbgName);return g}};THREE.ImageLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(a,b,c,d){var e=this,f=document.createElement("img");void 0!==b&&f.addEventListener("load",function(){e.manager.itemEnd(a);b(this)},!1);void 0!==c&&f.addEventListener("progress",function(a){c(a)},!1);void 0!==d&&f.addEventListener("error",function(a){d(a)},!1);void 0!==this.crossOrigin&&(f.crossOrigin=this.crossOrigin);f.src=a;e.manager.itemStart(a)},setCrossOrigin:function(a){this.crossOrigin=a}};THREE.JSONLoader=function(a){THREE.Loader.call(this,a);this.withCredentials=!1};THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype);THREE.JSONLoader.prototype.load=function(a,b,c){c=c&&"string"===typeof c?c:this.extractUrlBase(a);this.onLoadStart();this.loadAjaxJSON(this,a,b,c)};
THREE.JSONLoader.prototype.loadAjaxJSON=function(a,b,c,d,e){var f=new XMLHttpRequest,h=0;f.onreadystatechange=function(){if(f.readyState===f.DONE)if(200===f.status||0===f.status){if(f.responseText){var g=JSON.parse(f.responseText),g=a.parse(g,d);c(g.geometry,g.materials)}else console.warn("THREE.JSONLoader: ["+b+"] seems to be unreachable or file there is empty");a.onLoadComplete()}else console.error("THREE.JSONLoader: Couldn't load ["+b+"] ["+f.status+"]");else f.readyState===f.LOADING?e&&(0===h&&
(h=f.getResponseHeader("Content-Length")),e({total:h,loaded:f.responseText.length})):f.readyState===f.HEADERS_RECEIVED&&void 0!==e&&(h=f.getResponseHeader("Content-Length"))};f.open("GET",b,!0);f.withCredentials=this.withCredentials;f.send(null)};
THREE.JSONLoader.prototype.parse=function(a,b){var c=new THREE.Geometry,d=void 0!==a.scale?1/a.scale:1,e,f,h,g,i,j,l,q,t,r,x,p,n,k,z,y=a.faces;r=a.vertices;var D=a.normals,H=a.colors,E=0;for(e=0;e<a.uvs.length;e++)a.uvs[e].length&&E++;for(e=0;e<E;e++)c.faceUvs[e]=[],c.faceVertexUvs[e]=[];g=0;for(i=r.length;g<i;)j=new THREE.Vector3,j.x=r[g++]*d,j.y=r[g++]*d,j.z=r[g++]*d,c.vertices.push(j);g=0;for(i=y.length;g<i;){r=y[g++];j=r&1;h=r&2;e=r&4;f=r&8;q=r&16;l=r&32;x=r&64;r&=128;j?(p=new THREE.Face4,p.a=
y[g++],p.b=y[g++],p.c=y[g++],p.d=y[g++],j=4):(p=new THREE.Face3,p.a=y[g++],p.b=y[g++],p.c=y[g++],j=3);h&&(h=y[g++],p.materialIndex=h);h=c.faces.length;if(e)for(e=0;e<E;e++)n=a.uvs[e],t=y[g++],z=n[2*t],t=n[2*t+1],c.faceUvs[e][h]=new THREE.Vector2(z,t);if(f)for(e=0;e<E;e++){n=a.uvs[e];k=[];for(f=0;f<j;f++)t=y[g++],z=n[2*t],t=n[2*t+1],k[f]=new THREE.Vector2(z,t);c.faceVertexUvs[e][h]=k}q&&(q=3*y[g++],f=new THREE.Vector3,f.x=D[q++],f.y=D[q++],f.z=D[q],p.normal=f);if(l)for(e=0;e<j;e++)q=3*y[g++],f=new THREE.Vector3,
f.x=D[q++],f.y=D[q++],f.z=D[q],p.vertexNormals.push(f);x&&(l=y[g++],l=new THREE.Color(H[l]),p.color=l);if(r)for(e=0;e<j;e++)l=y[g++],l=new THREE.Color(H[l]),p.vertexColors.push(l);c.faces.push(p)}if(a.skinWeights){g=0;for(i=a.skinWeights.length;g<i;g+=2)y=a.skinWeights[g],D=a.skinWeights[g+1],c.skinWeights.push(new THREE.Vector4(y,D,0,0))}if(a.skinIndices){g=0;for(i=a.skinIndices.length;g<i;g+=2)y=a.skinIndices[g],D=a.skinIndices[g+1],c.skinIndices.push(new THREE.Vector4(y,D,0,0))}c.bones=a.bones;
c.animation=a.animation;if(void 0!==a.morphTargets){g=0;for(i=a.morphTargets.length;g<i;g++){c.morphTargets[g]={};c.morphTargets[g].name=a.morphTargets[g].name;c.morphTargets[g].vertices=[];H=c.morphTargets[g].vertices;E=a.morphTargets[g].vertices;y=0;for(D=E.length;y<D;y+=3)r=new THREE.Vector3,r.x=E[y]*d,r.y=E[y+1]*d,r.z=E[y+2]*d,H.push(r)}}if(void 0!==a.morphColors){g=0;for(i=a.morphColors.length;g<i;g++){c.morphColors[g]={};c.morphColors[g].name=a.morphColors[g].name;c.morphColors[g].colors=[];
D=c.morphColors[g].colors;H=a.morphColors[g].colors;d=0;for(y=H.length;d<y;d+=3)E=new THREE.Color(16755200),E.setRGB(H[d],H[d+1],H[d+2]),D.push(E)}}c.computeCentroids();c.computeFaceNormals();if(void 0===a.materials)return{geometry:c};d=this.initMaterials(a.materials,b);this.needsTangents(d)&&c.computeTangents();return{geometry:c,materials:d}};THREE.GeometryLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};THREE.GeometryLoader.prototype={constructor:THREE.GeometryLoader,load:function(a,b){var c=this,d=new THREE.XHRLoader;d.setCrossOrigin(this.crossOrigin);d.load(a,function(a){b(c.parse(JSON.parse(a)))})},setCrossOrigin:function(a){this.crossOrigin=a},parse:function(){}};THREE.MaterialLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(a,b){var c=this,d=new THREE.XHRLoader;d.setCrossOrigin(this.crossOrigin);d.load(a,function(a){b(c.parse(JSON.parse(a)))})},setCrossOrigin:function(a){this.crossOrigin=a},parse:function(a){var b;switch(a.type){case "MeshBasicMaterial":b=new THREE.MeshBasicMaterial({color:a.color,opacity:a.opacity,transparent:a.transparent,wireframe:a.wireframe});break;case "MeshLambertMaterial":b=new THREE.MeshLambertMaterial({color:a.color,
ambient:a.ambient,emissive:a.emissive,opacity:a.opacity,transparent:a.transparent,wireframe:a.wireframe});break;case "MeshPhongMaterial":b=new THREE.MeshPhongMaterial({color:a.color,ambient:a.ambient,emissive:a.emissive,specular:a.specular,shininess:a.shininess,opacity:a.opacity,transparent:a.transparent,wireframe:a.wireframe});break;case "MeshNormalMaterial":b=new THREE.MeshNormalMaterial({opacity:a.opacity,transparent:a.transparent,wireframe:a.wireframe});break;case "MeshDepthMaterial":b=new THREE.MeshDepthMaterial({opacity:a.opacity,
transparent:a.transparent,wireframe:a.wireframe})}return b}};THREE.SceneLoader=function(){this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){};this.callbackSync=function(){};this.callbackProgress=function(){};this.geometryHandlers={};this.hierarchyHandlers={};this.addGeometryHandler("ascii",THREE.JSONLoader)};
THREE.SceneLoader.prototype={constructor:THREE.SceneLoader,load:function(a,b){var c=this,d=new THREE.XHRLoader(c.manager);d.setCrossOrigin(this.crossOrigin);d.load(a,function(d){c.parse(JSON.parse(d),b,a)})},setCrossOrigin:function(a){this.crossOrigin=a},addGeometryHandler:function(a,b){this.geometryHandlers[a]={loaderClass:b}},addHierarchyHandler:function(a,b){this.hierarchyHandlers[a]={loaderClass:b}},parse:function(a,b,c){function d(a,b){return"relativeToHTML"==b?a:t+"/"+a}function e(){f(u.scene,
s.objects)}function f(a,b){var c,e,h,i,j,m,n;for(n in b){var l=u.objects[n],k=b[n];if(void 0===l){if(k.type&&k.type in q.hierarchyHandlers){if(void 0===k.loading){e={type:1,url:1,material:1,position:1,rotation:1,scale:1,visible:1,children:1,userData:1,skin:1,morph:1,mirroredLoop:1,duration:1};h={};for(var t in k)t in e||(h[t]=k[t]);x=u.materials[k.material];k.loading=!0;e=q.hierarchyHandlers[k.type].loaderObject;e.options?e.load(d(k.url,s.urlBaseType),g(n,a,x,k)):e.load(d(k.url,s.urlBaseType),g(n,
a,x,k),h)}}else if(void 0!==k.geometry){if(r=u.geometries[k.geometry]){l=!1;x=u.materials[k.material];l=x instanceof THREE.ShaderMaterial;h=k.position;i=k.rotation;j=k.scale;c=k.matrix;m=k.quaternion;k.material||(x=new THREE.MeshFaceMaterial(u.face_materials[k.geometry]));x instanceof THREE.MeshFaceMaterial&&0===x.materials.length&&(x=new THREE.MeshFaceMaterial(u.face_materials[k.geometry]));if(x instanceof THREE.MeshFaceMaterial)for(e=0;e<x.materials.length;e++)l=l||x.materials[e]instanceof THREE.ShaderMaterial;
l&&r.computeTangents();k.skin?l=new THREE.SkinnedMesh(r,x):k.morph?(l=new THREE.MorphAnimMesh(r,x),void 0!==k.duration&&(l.duration=k.duration),void 0!==k.time&&(l.time=k.time),void 0!==k.mirroredLoop&&(l.mirroredLoop=k.mirroredLoop),x.morphNormals&&r.computeMorphNormals()):l=new THREE.Mesh(r,x);l.name=n;c?(l.matrixAutoUpdate=!1,l.matrix.set(c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8],c[9],c[10],c[11],c[12],c[13],c[14],c[15])):(l.position.fromArray(h),m?(l.quaternion.fromArray(m),l.useQuaternion=
!0):l.rotation.fromArray(i),l.scale.fromArray(j));l.visible=k.visible;l.castShadow=k.castShadow;l.receiveShadow=k.receiveShadow;a.add(l);u.objects[n]=l}}else"DirectionalLight"===k.type||"PointLight"===k.type||"AmbientLight"===k.type?(y=void 0!==k.color?k.color:16777215,D=void 0!==k.intensity?k.intensity:1,"DirectionalLight"===k.type?(h=k.direction,z=new THREE.DirectionalLight(y,D),z.position.fromArray(h),k.target&&(C.push({object:z,targetName:k.target}),z.target=null)):"PointLight"===k.type?(h=k.position,
e=k.distance,z=new THREE.PointLight(y,D,e),z.position.fromArray(h)):"AmbientLight"===k.type&&(z=new THREE.AmbientLight(y)),a.add(z),z.name=n,u.lights[n]=z,u.objects[n]=z):"PerspectiveCamera"===k.type||"OrthographicCamera"===k.type?(h=k.position,i=k.rotation,m=k.quaternion,"PerspectiveCamera"===k.type?p=new THREE.PerspectiveCamera(k.fov,k.aspect,k.near,k.far):"OrthographicCamera"===k.type&&(p=new THREE.OrthographicCamera(k.left,k.right,k.top,k.bottom,k.near,k.far)),p.name=n,p.position.fromArray(h),
void 0!==m?(p.quaternion.fromArray(m),p.useQuaternion=!0):void 0!==i&&p.rotation.fromArray(i),a.add(p),u.cameras[n]=p,u.objects[n]=p):(h=k.position,i=k.rotation,j=k.scale,m=k.quaternion,l=new THREE.Object3D,l.name=n,l.position.fromArray(h),m?(l.quaternion.fromArray(m),l.useQuaternion=!0):l.rotation.fromArray(i),l.scale.fromArray(j),l.visible=void 0!==k.visible?k.visible:!1,a.add(l),u.objects[n]=l,u.empties[n]=l);if(l){if(void 0!==k.userData)for(var w in k.userData)l.userData[w]=k.userData[w];if(void 0!==
k.groups)for(e=0;e<k.groups.length;e++)h=k.groups[e],void 0===u.groups[h]&&(u.groups[h]=[]),u.groups[h].push(n)}}void 0!==l&&void 0!==k.children&&f(l,k.children)}}function h(a){return function(b,c){b.name=a;u.geometries[a]=b;u.face_materials[a]=c;e();H-=1;q.onLoadComplete();j()}}function g(a,b,c,d){return function(f){var f=f.content?f.content:f.dae?f.scene:f,g=d.rotation,h=d.quaternion,i=d.scale;f.position.fromArray(d.position);h?(f.quaternion.fromArray(h),f.useQuaternion=!0):f.rotation.fromArray(g);
f.scale.fromArray(i);c&&f.traverse(function(a){a.material=c});var k=void 0!==d.visible?d.visible:!0;f.traverse(function(a){a.visible=k});b.add(f);f.name=a;u.objects[a]=f;e();H-=1;q.onLoadComplete();j()}}function i(a){return function(b,c){b.name=a;u.geometries[a]=b;u.face_materials[a]=c}}function j(){q.callbackProgress({totalModels:K,totalTextures:L,loadedModels:K-H,loadedTextures:L-E},u);q.onLoadProgress();if(0===H&&0===E){for(var a=0;a<C.length;a++){var c=C[a],d=u.objects[c.targetName];d?c.object.target=
d:(c.object.target=new THREE.Object3D,u.scene.add(c.object.target));c.object.target.userData.targetInverse=c.object}b(u)}}function l(a,b){b(a);if(void 0!==a.children)for(var c in a.children)l(a.children[c],b)}var q=this,t=THREE.Loader.prototype.extractUrlBase(c),r,x,p,n,k,z,y,D,H,E,K,L,u,C=[],s=a,A;for(A in this.geometryHandlers)a=this.geometryHandlers[A].loaderClass,this.geometryHandlers[A].loaderObject=new a;for(A in this.hierarchyHandlers)a=this.hierarchyHandlers[A].loaderClass,this.hierarchyHandlers[A].loaderObject=
new a;E=H=0;u={scene:new THREE.Scene,geometries:{},face_materials:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{},groups:{}};if(s.transform&&(A=s.transform.position,a=s.transform.rotation,c=s.transform.scale,A&&u.scene.position.fromArray(A),a&&u.scene.rotation.fromArray(a),c&&u.scene.scale.fromArray(c),A||a||c))u.scene.updateMatrix(),u.scene.updateMatrixWorld();A=function(a){return function(){E-=a;j();q.onLoadComplete()}};for(var G in s.fogs)a=s.fogs[G],"linear"===a.type?
n=new THREE.Fog(0,a.near,a.far):"exp2"===a.type&&(n=new THREE.FogExp2(0,a.density)),a=a.color,n.color.setRGB(a[0],a[1],a[2]),u.fogs[G]=n;for(var m in s.geometries)n=s.geometries[m],n.type in this.geometryHandlers&&(H+=1,q.onLoadStart());for(var F in s.objects)l(s.objects[F],function(a){a.type&&a.type in q.hierarchyHandlers&&(H+=1,q.onLoadStart())});K=H;for(m in s.geometries)if(n=s.geometries[m],"cube"===n.type)r=new THREE.CubeGeometry(n.width,n.height,n.depth,n.widthSegments,n.heightSegments,n.depthSegments),
r.name=m,u.geometries[m]=r;else if("plane"===n.type)r=new THREE.PlaneGeometry(n.width,n.height,n.widthSegments,n.heightSegments),r.name=m,u.geometries[m]=r;else if("sphere"===n.type)r=new THREE.SphereGeometry(n.radius,n.widthSegments,n.heightSegments),r.name=m,u.geometries[m]=r;else if("cylinder"===n.type)r=new THREE.CylinderGeometry(n.topRad,n.botRad,n.height,n.radSegs,n.heightSegs),r.name=m,u.geometries[m]=r;else if("torus"===n.type)r=new THREE.TorusGeometry(n.radius,n.tube,n.segmentsR,n.segmentsT),
r.name=m,u.geometries[m]=r;else if("icosahedron"===n.type)r=new THREE.IcosahedronGeometry(n.radius,n.subdivisions),r.name=m,u.geometries[m]=r;else if(n.type in this.geometryHandlers){F={};for(k in n)"type"!==k&&"url"!==k&&(F[k]=n[k]);this.geometryHandlers[n.type].loaderObject.load(d(n.url,s.urlBaseType),h(m),F)}else"embedded"===n.type&&(F=s.embeds[n.id],F.metadata=s.metadata,F&&(F=this.geometryHandlers.ascii.loaderObject.parse(F,""),i(m)(F.geometry,F.materials)));for(var w in s.textures)if(m=s.textures[w],
m.url instanceof Array){E+=m.url.length;for(k=0;k<m.url.length;k++)q.onLoadStart()}else E+=1,q.onLoadStart();L=E;for(w in s.textures){m=s.textures[w];void 0!==m.mapping&&void 0!==THREE[m.mapping]&&(m.mapping=new THREE[m.mapping]);if(m.url instanceof Array){F=m.url.length;n=[];for(k=0;k<F;k++)n[k]=d(m.url[k],s.urlBaseType);k=(k=/\.dds$/i.test(n[0]))?THREE.ImageUtils.loadCompressedTextureCube(n,m.mapping,A(F)):THREE.ImageUtils.loadTextureCube(n,m.mapping,A(F))}else k=/\.dds$/i.test(m.url),F=d(m.url,
s.urlBaseType),n=A(1),k=k?THREE.ImageUtils.loadCompressedTexture(F,m.mapping,n):THREE.ImageUtils.loadTexture(F,m.mapping,n),void 0!==THREE[m.minFilter]&&(k.minFilter=THREE[m.minFilter]),void 0!==THREE[m.magFilter]&&(k.magFilter=THREE[m.magFilter]),m.anisotropy&&(k.anisotropy=m.anisotropy),m.repeat&&(k.repeat.set(m.repeat[0],m.repeat[1]),1!==m.repeat[0]&&(k.wrapS=THREE.RepeatWrapping),1!==m.repeat[1]&&(k.wrapT=THREE.RepeatWrapping)),m.offset&&k.offset.set(m.offset[0],m.offset[1]),m.wrap&&(F={repeat:THREE.RepeatWrapping,
mirror:THREE.MirroredRepeatWrapping},void 0!==F[m.wrap[0]]&&(k.wrapS=F[m.wrap[0]]),void 0!==F[m.wrap[1]]&&(k.wrapT=F[m.wrap[1]]));u.textures[w]=k}var M,v;for(M in s.materials){w=s.materials[M];for(v in w.parameters)"envMap"===v||"map"===v||"lightMap"===v||"bumpMap"===v?w.parameters[v]=u.textures[w.parameters[v]]:"shading"===v?w.parameters[v]="flat"===w.parameters[v]?THREE.FlatShading:THREE.SmoothShading:"side"===v?w.parameters[v]="double"==w.parameters[v]?THREE.DoubleSide:"back"==w.parameters[v]?
THREE.BackSide:THREE.FrontSide:"blending"===v?w.parameters[v]=w.parameters[v]in THREE?THREE[w.parameters[v]]:THREE.NormalBlending:"combine"===v?w.parameters[v]=w.parameters[v]in THREE?THREE[w.parameters[v]]:THREE.MultiplyOperation:"vertexColors"===v?"face"==w.parameters[v]?w.parameters[v]=THREE.FaceColors:w.parameters[v]&&(w.parameters[v]=THREE.VertexColors):"wrapRGB"===v&&(A=w.parameters[v],w.parameters[v]=new THREE.Vector3(A[0],A[1],A[2]));void 0!==w.parameters.opacity&&1>w.parameters.opacity&&
(w.parameters.transparent=!0);w.parameters.normalMap?(A=THREE.ShaderLib.normalmap,m=THREE.UniformsUtils.clone(A.uniforms),k=w.parameters.color,F=w.parameters.specular,n=w.parameters.ambient,G=w.parameters.shininess,m.tNormal.value=u.textures[w.parameters.normalMap],w.parameters.normalScale&&m.uNormalScale.value.set(w.parameters.normalScale[0],w.parameters.normalScale[1]),w.parameters.map&&(m.tDiffuse.value=w.parameters.map,m.enableDiffuse.value=!0),w.parameters.envMap&&(m.tCube.value=w.parameters.envMap,
m.enableReflection.value=!0,m.uReflectivity.value=w.parameters.reflectivity),w.parameters.lightMap&&(m.tAO.value=w.parameters.lightMap,m.enableAO.value=!0),w.parameters.specularMap&&(m.tSpecular.value=u.textures[w.parameters.specularMap],m.enableSpecular.value=!0),w.parameters.displacementMap&&(m.tDisplacement.value=u.textures[w.parameters.displacementMap],m.enableDisplacement.value=!0,m.uDisplacementBias.value=w.parameters.displacementBias,m.uDisplacementScale.value=w.parameters.displacementScale),
m.uDiffuseColor.value.setHex(k),m.uSpecularColor.value.setHex(F),m.uAmbientColor.value.setHex(n),m.uShininess.value=G,w.parameters.opacity&&(m.uOpacity.value=w.parameters.opacity),x=new THREE.ShaderMaterial({fragmentShader:A.fragmentShader,vertexShader:A.vertexShader,uniforms:m,lights:!0,fog:!0})):x=new THREE[w.type](w.parameters);x.name=M;u.materials[M]=x}for(M in s.materials)if(w=s.materials[M],w.parameters.materials){v=[];for(k=0;k<w.parameters.materials.length;k++)v.push(u.materials[w.parameters.materials[k]]);
u.materials[M].materials=v}e();u.cameras&&s.defaults.camera&&(u.currentCamera=u.cameras[s.defaults.camera]);u.fogs&&s.defaults.fog&&(u.scene.fog=u.fogs[s.defaults.fog]);q.callbackSync(u);j()}};THREE.TextureLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(a,b){var c=new THREE.ImageLoader(this.manager);c.setCrossOrigin(this.crossOrigin);c.load(a,function(a){a=new THREE.Texture(a);a.needsUpdate=!0;void 0!==b&&b(a)})},setCrossOrigin:function(a){this.crossOrigin=a}};THREE.Material=function(){this.id=THREE.Math.generateUUID();this.name="";this.side=THREE.FrontSide;this.opacity=1;this.transparent=!1;this.blending=THREE.NormalBlending;this.blendSrc=THREE.SrcAlphaFactor;this.blendDst=THREE.OneMinusSrcAlphaFactor;this.blendEquation=THREE.AddEquation;this.depthWrite=this.depthTest=!0;this.polygonOffset=!1;this.overdraw=this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.needsUpdate=this.visible=!0};
THREE.Material.prototype={constructor:THREE.Material,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,setValues:function(a){if(void 0!==a)for(var b in a){var c=a[b];if(void 0===c)console.warn("THREE.Material: '"+b+"' parameter is undefined.");else if(b in this){var d=this[b];d instanceof
THREE.Color?d.set(c):d instanceof THREE.Vector3&&c instanceof THREE.Vector3?d.copy(c):this[b]="overdraw"==b?Number(c):c}}},clone:function(a){void 0===a&&(a=new THREE.Material);a.name=this.name;a.side=this.side;a.opacity=this.opacity;a.transparent=this.transparent;a.blending=this.blending;a.blendSrc=this.blendSrc;a.blendDst=this.blendDst;a.blendEquation=this.blendEquation;a.depthTest=this.depthTest;a.depthWrite=this.depthWrite;a.polygonOffset=this.polygonOffset;a.polygonOffsetFactor=this.polygonOffsetFactor;
a.polygonOffsetUnits=this.polygonOffsetUnits;a.alphaTest=this.alphaTest;a.overdraw=this.overdraw;a.visible=this.visible;return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.LineBasicMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.vertexColors=!1;this.fog=!0;this.setValues(a)};THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.LineBasicMaterial.prototype.clone=function(){var a=new THREE.LineBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.linewidth=this.linewidth;a.linecap=this.linecap;a.linejoin=this.linejoin;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};THREE.MeshBasicMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.envMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphTargets=this.skinning=!1;this.setValues(a)};
THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshBasicMaterial.prototype.clone=function(){var a=new THREE.MeshBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=
this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;return a};THREE.MeshLambertMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.envMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap=
"round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshLambertMaterial.prototype.clone=function(){var a=new THREE.MeshLambertMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;
a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};THREE.MeshPhongMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.specular=new THREE.Color(1118481);this.shininess=30;this.metal=!1;this.perPixel=!0;this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.bumpMap=this.lightMap=this.map=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new THREE.Vector2(1,1);this.envMap=this.specularMap=null;this.combine=THREE.MultiplyOperation;
this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshPhongMaterial.prototype.clone=function(){var a=new THREE.MeshPhongMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.specular.copy(this.specular);a.shininess=this.shininess;a.metal=this.metal;a.perPixel=this.perPixel;a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.bumpMap=this.bumpMap;a.bumpScale=this.bumpScale;a.normalMap=this.normalMap;a.normalScale.copy(this.normalScale);
a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};THREE.MeshDepthMaterial=function(a){THREE.Material.call(this);this.wireframe=!1;this.wireframeLinewidth=1;this.setValues(a)};THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshDepthMaterial.prototype.clone=function(){var a=new THREE.MeshDepthMaterial;THREE.Material.prototype.clone.call(this,a);a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;return a};THREE.MeshNormalMaterial=function(a){THREE.Material.call(this,a);this.shading=THREE.FlatShading;this.wireframe=!1;this.wireframeLinewidth=1;this.morphTargets=!1;this.setValues(a)};THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshNormalMaterial.prototype.clone=function(){var a=new THREE.MeshNormalMaterial;THREE.Material.prototype.clone.call(this,a);a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;return a};THREE.MeshFaceMaterial=function(a){this.materials=a instanceof Array?a:[]};THREE.MeshFaceMaterial.prototype.clone=function(){return new THREE.MeshFaceMaterial(this.materials.slice(0))};THREE.ParticleBasicMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.map=null;this.size=1;this.sizeAttenuation=!0;this.vertexColors=!1;this.fog=!0;this.setValues(a)};THREE.ParticleBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.ParticleBasicMaterial.prototype.clone=function(){var a=new THREE.ParticleBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.size=this.size;a.sizeAttenuation=this.sizeAttenuation;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};THREE.ParticleCanvasMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.program=function(){};this.setValues(a)};THREE.ParticleCanvasMaterial.prototype=Object.create(THREE.Material.prototype);THREE.ParticleCanvasMaterial.prototype.clone=function(){var a=new THREE.ParticleCanvasMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.program=this.program;return a};THREE.Texture=function(a,b,c,d,e,f,h,g,i){this.id=THREE.Math.generateUUID();this.name="";this.image=a;this.mipmaps=[];this.mapping=void 0!==b?b:new THREE.UVMapping;this.wrapS=void 0!==c?c:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==d?d:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==e?e:THREE.LinearFilter;this.minFilter=void 0!==f?f:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==i?i:1;this.format=void 0!==h?h:THREE.RGBAFormat;this.type=void 0!==g?g:THREE.UnsignedByteType;this.offset=
new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.needsUpdate=!1;this.onUpdate=null};
THREE.Texture.prototype={constructor:THREE.Texture,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,clone:function(a){void 0===a&&(a=new THREE.Texture);a.image=this.image;a.mipmaps=this.mipmaps.slice(0);a.mapping=this.mapping;a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;
a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.format=this.format;a.type=this.type;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.generateMipmaps=this.generateMipmaps;a.premultiplyAlpha=this.premultiplyAlpha;a.flipY=this.flipY;a.unpackAlignment=this.unpackAlignment;return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.DataTexture=function(a,b,c,d,e,f,h,g,i,j,l){THREE.Texture.call(this,null,f,h,g,i,j,d,e,l);this.image={data:a,width:b,height:c}};THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype);THREE.DataTexture.prototype.clone=function(){var a=new THREE.DataTexture;THREE.Texture.prototype.clone.call(this,a);return a};THREE.Particle=function(a){THREE.Object3D.call(this);this.material=a};THREE.Particle.prototype=Object.create(THREE.Object3D.prototype);THREE.Particle.prototype.clone=function(a){void 0===a&&(a=new THREE.Particle(this.material));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Line=function(a,b,c){THREE.Object3D.call(this);this.geometry=a;this.material=void 0!==b?b:new THREE.LineBasicMaterial({color:16777215*Math.random()});this.type=void 0!==c?c:THREE.LineStrip;this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere())};THREE.LineStrip=0;THREE.LinePieces=1;THREE.Line.prototype=Object.create(THREE.Object3D.prototype);
THREE.Line.prototype.clone=function(a){void 0===a&&(a=new THREE.Line(this.geometry,this.material,this.type));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Mesh=function(a,b){THREE.Object3D.call(this);this.material=this.geometry=null;this.setGeometry(a);this.setMaterial(b)};THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype);THREE.Mesh.prototype.setGeometry=function(a){void 0!==a&&(this.geometry=a,null===this.geometry.boundingSphere&&this.geometry.computeBoundingSphere(),this.updateMorphTargets())};THREE.Mesh.prototype.setMaterial=function(a){this.material=void 0!==a?a:new THREE.MeshBasicMaterial({color:16777215*Math.random(),wireframe:!0})};
THREE.Mesh.prototype.updateMorphTargets=function(){if(0<this.geometry.morphTargets.length){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var a=0,b=this.geometry.morphTargets.length;a<b;a++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[a].name]=a}};
THREE.Mesh.prototype.getMorphTargetIndexByName=function(a){if(void 0!==this.morphTargetDictionary[a])return this.morphTargetDictionary[a];console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+a+" does not exist. Returning 0.");return 0};THREE.Mesh.prototype.clone=function(a){void 0===a&&(a=new THREE.Mesh(this.geometry,this.material));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Bone=function(a){THREE.Object3D.call(this);this.skin=a;this.skinMatrix=new THREE.Matrix4};THREE.Bone.prototype=Object.create(THREE.Object3D.prototype);THREE.Bone.prototype.update=function(a,b){this.matrixAutoUpdate&&(b|=this.updateMatrix());if(b||this.matrixWorldNeedsUpdate)a?this.skinMatrix.multiplyMatrices(a,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,b=!0;var c,d=this.children.length;for(c=0;c<d;c++)this.children[c].update(this.skinMatrix,b)};THREE.Sprite=function(a){THREE.Object3D.call(this);this.material=void 0!==a?a:new THREE.SpriteMaterial;this.rotation3d=this.rotation;this.rotation=0};THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype);THREE.Sprite.prototype.updateMatrix=function(){this.rotation3d.set(0,0,this.rotation);this.quaternion.setFromEuler(this.rotation3d,this.eulerOrder);this.matrix.makeFromPositionQuaternionScale(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0};
THREE.Sprite.prototype.clone=function(a){void 0===a&&(a=new THREE.Sprite(this.material));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Scene=function(){THREE.Object3D.call(this);this.overrideMaterial=this.fog=null;this.autoUpdate=!0;this.matrixAutoUpdate=!1;this.__objects=[];this.__lights=[];this.__objectsAdded=[];this.__objectsRemoved=[]};THREE.Scene.prototype=Object.create(THREE.Object3D.prototype);
THREE.Scene.prototype.__addObject=function(a){if(a instanceof THREE.Light)-1===this.__lights.indexOf(a)&&this.__lights.push(a),a.target&&void 0===a.target.parent&&this.add(a.target);else if(!(a instanceof THREE.Camera||a instanceof THREE.Bone)&&-1===this.__objects.indexOf(a)){this.__objects.push(a);this.__objectsAdded.push(a);var b=this.__objectsRemoved.indexOf(a);-1!==b&&this.__objectsRemoved.splice(b,1)}for(b=0;b<a.children.length;b++)this.__addObject(a.children[b])};
THREE.Scene.prototype.__removeObject=function(a){if(a instanceof THREE.Light){var b=this.__lights.indexOf(a);-1!==b&&this.__lights.splice(b,1)}else a instanceof THREE.Camera||(b=this.__objects.indexOf(a),-1!==b&&(this.__objects.splice(b,1),this.__objectsRemoved.push(a),b=this.__objectsAdded.indexOf(a),-1!==b&&this.__objectsAdded.splice(b,1)));for(b=0;b<a.children.length;b++)this.__removeObject(a.children[b])};
THREE.Scene.prototype.clone=function(a){void 0===a&&(a=new THREE.Scene);THREE.Object3D.prototype.clone.call(this,a);null!==this.fog&&(a.fog=this.fog.clone());null!==this.overrideMaterial&&(a.overrideMaterial=this.overrideMaterial.clone());a.autoUpdate=this.autoUpdate;a.matrixAutoUpdate=this.matrixAutoUpdate;return a};THREE.CanvasRenderer=function(a){function b(a,b,c){for(var d=0,e=K.length;d<e;d++){var f=K[d];Ga.copy(f.color);if(f instanceof THREE.DirectionalLight){var g=ja.getPositionFromMatrix(f.matrixWorld).normalize(),h=b.dot(g);0>=h||(h*=f.intensity,c.add(Ga.multiplyScalar(h)))}else f instanceof THREE.PointLight&&(g=ja.getPositionFromMatrix(f.matrixWorld),h=b.dot(ja.subVectors(g,a).normalize()),0>=h||(h*=0==f.distance?1:1-Math.min(a.distanceTo(g)/f.distance,1),0!=h&&(h*=f.intensity,c.add(Ga.multiplyScalar(h)))))}}
function c(a,c,e,k,m,n,l,p){D.info.render.vertices+=3;D.info.render.faces++;q(p.opacity);t(p.blending);ea=a.positionScreen.x;fa=a.positionScreen.y;P=c.positionScreen.x;R=c.positionScreen.y;J=e.positionScreen.x;O=e.positionScreen.y;d(ea,fa,P,R,J,O);(p instanceof THREE.MeshLambertMaterial||p instanceof THREE.MeshPhongMaterial)&&null===p.map?(na.copy(p.color),qa.copy(p.emissive),p.vertexColors===THREE.FaceColors&&na.multiply(l.color),!1===p.wireframe&&p.shading==THREE.SmoothShading&&3==l.vertexNormalsLength?
($.copy(ra),W.copy(ra),X.copy(ra),b(l.v1.positionWorld,l.vertexNormalsModel[0],$),b(l.v2.positionWorld,l.vertexNormalsModel[1],W),b(l.v3.positionWorld,l.vertexNormalsModel[2],X),$.multiply(na).add(qa),W.multiply(na).add(qa),X.multiply(na).add(qa),ka.addColors(W,X).multiplyScalar(0.5),la=j($,W,X,ka),i(ea,fa,P,R,J,O,0,0,1,0,0,1,la)):(U.copy(ra),b(l.centroidModel,l.normalModel,U),U.multiply(na).add(qa),!0===p.wireframe?f(U,p.wireframeLinewidth,p.wireframeLinecap,p.wireframeLinejoin):h(U))):p instanceof
THREE.MeshBasicMaterial||p instanceof THREE.MeshLambertMaterial||p instanceof THREE.MeshPhongMaterial?null!==p.map?p.map.mapping instanceof THREE.UVMapping&&(ya=l.uvs[0],g(ea,fa,P,R,J,O,ya[k].x,ya[k].y,ya[m].x,ya[m].y,ya[n].x,ya[n].y,p.map)):null!==p.envMap?p.envMap.mapping instanceof THREE.SphericalReflectionMapping&&(ja.copy(l.vertexNormalsModelView[k]),Ka=0.5*ja.x+0.5,La=0.5*ja.y+0.5,ja.copy(l.vertexNormalsModelView[m]),Ma=0.5*ja.x+0.5,Na=0.5*ja.y+0.5,ja.copy(l.vertexNormalsModelView[n]),Oa=0.5*
ja.x+0.5,Pa=0.5*ja.y+0.5,g(ea,fa,P,R,J,O,Ka,La,Ma,Na,Oa,Pa,p.envMap)):(U.copy(p.color),p.vertexColors===THREE.FaceColors&&U.multiply(l.color),!0===p.wireframe?f(U,p.wireframeLinewidth,p.wireframeLinecap,p.wireframeLinejoin):h(U)):p instanceof THREE.MeshDepthMaterial?(va=ia.near,wa=ia.far,$.r=$.g=$.b=1-y(a.positionScreen.z*a.positionScreen.w,va,wa),W.r=W.g=W.b=1-y(c.positionScreen.z*c.positionScreen.w,va,wa),X.r=X.g=X.b=1-y(e.positionScreen.z*e.positionScreen.w,va,wa),ka.addColors(W,X).multiplyScalar(0.5),
la=j($,W,X,ka),i(ea,fa,P,R,J,O,0,0,1,0,0,1,la)):p instanceof THREE.MeshNormalMaterial&&(p.shading==THREE.FlatShading?(a=l.normalModelView,U.setRGB(a.x,a.y,a.z).multiplyScalar(0.5).addScalar(0.5),!0===p.wireframe?f(U,p.wireframeLinewidth,p.wireframeLinecap,p.wireframeLinejoin):h(U)):p.shading==THREE.SmoothShading&&(a=l.vertexNormalsModelView[k],$.setRGB(a.x,a.y,a.z).multiplyScalar(0.5).addScalar(0.5),a=l.vertexNormalsModelView[m],W.setRGB(a.x,a.y,a.z).multiplyScalar(0.5).addScalar(0.5),a=l.vertexNormalsModelView[n],
X.setRGB(a.x,a.y,a.z).multiplyScalar(0.5).addScalar(0.5),ka.addColors(W,X).multiplyScalar(0.5),la=j($,W,X,ka),i(ea,fa,P,R,J,O,0,0,1,0,0,1,la)))}function d(a,b,c,d,e,f){m.beginPath();m.moveTo(a,b);m.lineTo(c,d);m.lineTo(e,f);m.closePath()}function e(a,b,c,d,e,f,g,h){m.beginPath();m.moveTo(a,b);m.lineTo(c,d);m.lineTo(e,f);m.lineTo(g,h);m.closePath()}function f(a,b,c,d){r(b);x(c);p(d);n(a.getStyle());m.stroke();aa.expandByScalar(2*b)}function h(a){k(a.getStyle());m.fill()}function g(a,b,c,d,e,f,g,i,
j,l,n,p,q){if(!(q instanceof THREE.DataTexture||void 0===q.image||0==q.image.width)){if(!0===q.needsUpdate){var r=q.wrapS==THREE.RepeatWrapping,t=q.wrapT==THREE.RepeatWrapping;Ha[q.id]=m.createPattern(q.image,!0===r&&!0===t?"repeat":!0===r&&!1===t?"repeat-x":!1===r&&!0===t?"repeat-y":"no-repeat");q.needsUpdate=!1}void 0===Ha[q.id]?k("rgba(0,0,0,1)"):k(Ha[q.id]);var r=q.offset.x/q.repeat.x,t=q.offset.y/q.repeat.y,u=q.image.width*q.repeat.x,w=q.image.height*q.repeat.y,g=(g+r)*u,i=(1-i+t)*w,c=c-a,d=
d-b,e=e-a,f=f-b,j=(j+r)*u-g,l=(1-l+t)*w-i,n=(n+r)*u-g,p=(1-p+t)*w-i,r=j*p-n*l;0===r?(void 0===Ia[q.id]&&(b=document.createElement("canvas"),b.width=q.image.width,b.height=q.image.height,b=b.getContext("2d"),b.drawImage(q.image,0,0),Ia[q.id]=b.getImageData(0,0,q.image.width,q.image.height).data),b=Ia[q.id],g=4*(Math.floor(g)+Math.floor(i)*q.image.width),U.setRGB(b[g]/255,b[g+1]/255,b[g+2]/255),h(U)):(r=1/r,q=(p*c-l*e)*r,l=(p*d-l*f)*r,c=(j*e-n*c)*r,d=(j*f-n*d)*r,a=a-q*g-c*i,g=b-l*g-d*i,m.save(),m.transform(q,
l,c,d,a,g),m.fill(),m.restore())}}function i(a,b,c,d,e,f,g,h,i,j,k,l,n){var p,q;p=n.width-1;q=n.height-1;g*=p;h*=q;c-=a;d-=b;e-=a;f-=b;i=i*p-g;j=j*q-h;k=k*p-g;l=l*q-h;q=1/(i*l-k*j);p=(l*c-j*e)*q;j=(l*d-j*f)*q;c=(i*e-k*c)*q;d=(i*f-k*d)*q;a=a-p*g-c*h;b=b-j*g-d*h;m.save();m.transform(p,j,c,d,a,b);m.clip();m.drawImage(n,0,0);m.restore()}function j(a,b,c,d){ga[0]=255*a.r|0;ga[1]=255*a.g|0;ga[2]=255*a.b|0;ga[4]=255*b.r|0;ga[5]=255*b.g|0;ga[6]=255*b.b|0;ga[8]=255*c.r|0;ga[9]=255*c.g|0;ga[10]=255*c.b|0;ga[12]=
255*d.r|0;ga[13]=255*d.g|0;ga[14]=255*d.b|0;Aa.putImageData(Ja,0,0);Da.drawImage(Ba,0,0);return Ca}function l(a,b,c){var d=b.x-a.x,e=b.y-a.y,f=d*d+e*e;0!==f&&(c/=Math.sqrt(f),d*=c,e*=c,b.x+=d,b.y+=e,a.x-=d,a.y-=e)}function q(a){M!==a&&(M=m.globalAlpha=a)}function t(a){v!==a&&(a===THREE.NormalBlending?m.globalCompositeOperation="source-over":a===THREE.AdditiveBlending?m.globalCompositeOperation="lighter":a===THREE.SubtractiveBlending&&(m.globalCompositeOperation="darker"),v=a)}function r(a){sa!==a&&
(sa=m.lineWidth=a)}function x(a){ta!==a&&(ta=m.lineCap=a)}function p(a){ua!==a&&(ua=m.lineJoin=a)}function n(a){S!==a&&(S=m.strokeStyle=a)}function k(a){ha!==a&&(ha=m.fillStyle=a)}function z(a,b){if(pa!==a||Z!==b)m.setLineDash([a,b]),pa=a,Z=b}console.log("THREE.CanvasRenderer",THREE.REVISION);var y=THREE.Math.smoothstep,a=a||{},D=this,H,E,K,L=new THREE.Projector,u=void 0!==a.canvas?a.canvas:document.createElement("canvas"),C,s,A,G,m=u.getContext("2d"),F=new THREE.Color(0),w=0,M=1,v=0,S=null,ha=null,
sa=null,ta=null,ua=null,pa=null,Z=0,ia,I,N,ba,oa,Ea=new THREE.RenderableVertex,Fa=new THREE.RenderableVertex,ea,fa,P,R,J,O,Y,Q,T,da,ma,V,U=new THREE.Color,$=new THREE.Color,W=new THREE.Color,X=new THREE.Color,ka=new THREE.Color,na=new THREE.Color,qa=new THREE.Color,Ga=new THREE.Color,Ha={},Ia={},va,wa,la,ya,Ka,La,Ma,Na,Oa,Pa,xa=new THREE.Box2,ca=new THREE.Box2,aa=new THREE.Box2,ra=new THREE.Color,Qa=new THREE.Color,Ra=new THREE.Color,ja=new THREE.Vector3,Ba,Aa,Ja,ga,Ca,Da,za=16;Ba=document.createElement("canvas");
Ba.width=Ba.height=2;Aa=Ba.getContext("2d");Aa.fillStyle="rgba(0,0,0,1)";Aa.fillRect(0,0,2,2);Ja=Aa.getImageData(0,0,2,2);ga=Ja.data;Ca=document.createElement("canvas");Ca.width=Ca.height=za;Da=Ca.getContext("2d");Da.translate(-za/2,-za/2);Da.scale(za,za);za--;void 0===m.setLineDash&&(m.setLineDash=void 0!==m.mozDash?function(a){m.mozDash=null!==a[0]?a:null}:function(){});this.domElement=u;this.devicePixelRatio=void 0!==a.devicePixelRatio?a.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:
1;this.sortElements=this.sortObjects=this.autoClear=!0;this.info={render:{vertices:0,faces:0}};this.supportsVertexTextures=function(){};this.setFaceCulling=function(){};this.setSize=function(a,b,c){C=a*this.devicePixelRatio;s=b*this.devicePixelRatio;A=Math.floor(C/2);G=Math.floor(s/2);u.width=C;u.height=s;1!==this.devicePixelRatio&&!1!==c&&(u.style.width=a+"px",u.style.height=b+"px");xa.set(new THREE.Vector2(-A,-G),new THREE.Vector2(A,G));ca.set(new THREE.Vector2(-A,-G),new THREE.Vector2(A,G));M=
1;v=0;ua=ta=sa=ha=S=null};this.setClearColor=function(a,b){F.set(a);w=void 0!==b?b:1;ca.set(new THREE.Vector2(-A,-G),new THREE.Vector2(A,G))};this.setClearColorHex=function(a,b){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(a,b)};this.getMaxAnisotropy=function(){return 0};this.clear=function(){m.setTransform(1,0,0,-1,A,G);!1===ca.empty()&&(ca.intersect(xa),ca.expandByScalar(2),1>w&&m.clearRect(ca.min.x|0,ca.min.y|0,ca.max.x-ca.min.x|
0,ca.max.y-ca.min.y|0),0<w&&(t(THREE.NormalBlending),q(1),k("rgba("+Math.floor(255*F.r)+","+Math.floor(255*F.g)+","+Math.floor(255*F.b)+","+w+")"),m.fillRect(ca.min.x|0,ca.min.y|0,ca.max.x-ca.min.x|0,ca.max.y-ca.min.y|0)),ca.makeEmpty())};this.render=function(a,g){if(!1===g instanceof THREE.Camera)console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");else{!0===this.autoClear&&this.clear();m.setTransform(1,0,0,-1,A,G);D.info.render.vertices=0;D.info.render.faces=
0;H=L.projectScene(a,g,this.sortObjects,this.sortElements);E=H.elements;K=H.lights;ia=g;ra.setRGB(0,0,0);Qa.setRGB(0,0,0);Ra.setRGB(0,0,0);for(var u=0,w=K.length;u<w;u++){var B=K[u],s=B.color;B instanceof THREE.AmbientLight?ra.add(s):B instanceof THREE.DirectionalLight?Qa.add(s):B instanceof THREE.PointLight&&Ra.add(s)}u=0;for(w=E.length;u<w;u++){var v=E[u],B=v.material;if(!(void 0===B||!1===B.visible)){aa.makeEmpty();if(v instanceof THREE.RenderableParticle){I=v;I.x*=A;I.y*=G;s=I;q(B.opacity);t(B.blending);
var C=void 0,F=void 0,M=void 0,S=void 0,Z=void 0,ga=void 0,ja=void 0;B instanceof THREE.ParticleBasicMaterial?null===B.map?(M=v.object.scale.x,S=v.object.scale.y,M*=v.scale.x*A,S*=v.scale.y*G,aa.min.set(s.x-M,s.y-S),aa.max.set(s.x+M,s.y+S),!1===xa.isIntersectionBox(aa)?aa.makeEmpty():(k(B.color.getStyle()),m.save(),m.translate(s.x,s.y),m.rotate(-v.rotation),m.scale(M,S),m.fillRect(-1,-1,2,2),m.restore())):(Z=B.map.image,ga=Z.width>>1,ja=Z.height>>1,M=v.scale.x*A,S=v.scale.y*G,C=M*ga,F=S*ja,aa.min.set(s.x-
C,s.y-F),aa.max.set(s.x+C,s.y+F),!1===xa.isIntersectionBox(aa)?aa.makeEmpty():(m.save(),m.translate(s.x,s.y),m.rotate(-v.rotation),m.scale(M,-S),m.translate(-ga,-ja),m.drawImage(Z,0,0),m.restore())):B instanceof THREE.ParticleCanvasMaterial&&(C=v.scale.x*A,F=v.scale.y*G,aa.min.set(s.x-C,s.y-F),aa.max.set(s.x+C,s.y+F),!1===xa.isIntersectionBox(aa)?aa.makeEmpty():(n(B.color.getStyle()),k(B.color.getStyle()),m.save(),m.translate(s.x,s.y),m.rotate(-v.rotation),m.scale(C,F),B.program(m),m.restore()))}else if(v instanceof
THREE.RenderableLine){if(I=v.v1,N=v.v2,I.positionScreen.x*=A,I.positionScreen.y*=G,N.positionScreen.x*=A,N.positionScreen.y*=G,aa.setFromPoints([I.positionScreen,N.positionScreen]),!0===xa.isIntersectionBox(aa))if(s=I,C=N,q(B.opacity),t(B.blending),m.beginPath(),m.moveTo(s.positionScreen.x,s.positionScreen.y),m.lineTo(C.positionScreen.x,C.positionScreen.y),B instanceof THREE.LineBasicMaterial){r(B.linewidth);x(B.linecap);p(B.linejoin);if(B.vertexColors!==THREE.VertexColors)n(B.color.getStyle());else if(F=
v.vertexColors[0].getStyle(),v=v.vertexColors[1].getStyle(),F===v)n(F);else{try{var ha=m.createLinearGradient(s.positionScreen.x,s.positionScreen.y,C.positionScreen.x,C.positionScreen.y);ha.addColorStop(0,F);ha.addColorStop(1,v)}catch(pa){ha=F}n(ha)}m.stroke();aa.expandByScalar(2*B.linewidth)}else B instanceof THREE.LineDashedMaterial&&(r(B.linewidth),x(B.linecap),p(B.linejoin),n(B.color.getStyle()),z(B.dashSize,B.gapSize),m.stroke(),aa.expandByScalar(2*B.linewidth),z(null,null))}else if(v instanceof
THREE.RenderableFace3){I=v.v1;N=v.v2;ba=v.v3;if(-1>I.positionScreen.z||1<I.positionScreen.z)continue;if(-1>N.positionScreen.z||1<N.positionScreen.z)continue;if(-1>ba.positionScreen.z||1<ba.positionScreen.z)continue;I.positionScreen.x*=A;I.positionScreen.y*=G;N.positionScreen.x*=A;N.positionScreen.y*=G;ba.positionScreen.x*=A;ba.positionScreen.y*=G;0<B.overdraw&&(l(I.positionScreen,N.positionScreen,B.overdraw),l(N.positionScreen,ba.positionScreen,B.overdraw),l(ba.positionScreen,I.positionScreen,B.overdraw));
aa.setFromPoints([I.positionScreen,N.positionScreen,ba.positionScreen]);!0===xa.isIntersectionBox(aa)&&c(I,N,ba,0,1,2,v,B)}else if(v instanceof THREE.RenderableFace4){I=v.v1;N=v.v2;ba=v.v3;oa=v.v4;if(-1>I.positionScreen.z||1<I.positionScreen.z)continue;if(-1>N.positionScreen.z||1<N.positionScreen.z)continue;if(-1>ba.positionScreen.z||1<ba.positionScreen.z)continue;if(-1>oa.positionScreen.z||1<oa.positionScreen.z)continue;I.positionScreen.x*=A;I.positionScreen.y*=G;N.positionScreen.x*=A;N.positionScreen.y*=
G;ba.positionScreen.x*=A;ba.positionScreen.y*=G;oa.positionScreen.x*=A;oa.positionScreen.y*=G;Ea.positionScreen.copy(N.positionScreen);Fa.positionScreen.copy(oa.positionScreen);0<B.overdraw&&(l(I.positionScreen,N.positionScreen,B.overdraw),l(N.positionScreen,oa.positionScreen,B.overdraw),l(oa.positionScreen,I.positionScreen,B.overdraw),l(ba.positionScreen,Ea.positionScreen,B.overdraw),l(ba.positionScreen,Fa.positionScreen,B.overdraw));aa.setFromPoints([I.positionScreen,N.positionScreen,ba.positionScreen,
oa.positionScreen]);!0===xa.isIntersectionBox(aa)&&(s=I,C=N,F=ba,M=oa,S=Ea,Z=Fa,D.info.render.vertices+=4,D.info.render.faces++,q(B.opacity),t(B.blending),void 0!==B.map&&null!==B.map||void 0!==B.envMap&&null!==B.envMap?(c(s,C,M,0,1,3,v,B),c(S,F,Z,1,2,3,v,B)):(ea=s.positionScreen.x,fa=s.positionScreen.y,P=C.positionScreen.x,R=C.positionScreen.y,J=F.positionScreen.x,O=F.positionScreen.y,Y=M.positionScreen.x,Q=M.positionScreen.y,T=S.positionScreen.x,da=S.positionScreen.y,ma=Z.positionScreen.x,V=Z.positionScreen.y,
B instanceof THREE.MeshLambertMaterial||B instanceof THREE.MeshPhongMaterial?(na.copy(B.color),qa.copy(B.emissive),B.vertexColors===THREE.FaceColors&&na.multiply(v.color),!1===B.wireframe&&B.shading==THREE.SmoothShading&&4==v.vertexNormalsLength?($.copy(ra),W.copy(ra),X.copy(ra),ka.copy(ra),b(v.v1.positionWorld,v.vertexNormalsModel[0],$),b(v.v2.positionWorld,v.vertexNormalsModel[1],W),b(v.v4.positionWorld,v.vertexNormalsModel[3],X),b(v.v3.positionWorld,v.vertexNormalsModel[2],ka),$.multiply(na).add(qa),
W.multiply(na).add(qa),X.multiply(na).add(qa),ka.multiply(na).add(qa),la=j($,W,X,ka),d(ea,fa,P,R,Y,Q),i(ea,fa,P,R,Y,Q,0,0,1,0,0,1,la),d(T,da,J,O,ma,V),i(T,da,J,O,ma,V,1,0,1,1,0,1,la)):(U.copy(ra),b(v.centroidModel,v.normalModel,U),U.multiply(na).add(qa),e(ea,fa,P,R,J,O,Y,Q),!0===B.wireframe?f(U,B.wireframeLinewidth,B.wireframeLinecap,B.wireframeLinejoin):h(U))):B instanceof THREE.MeshBasicMaterial?(U.copy(B.color),B.vertexColors===THREE.FaceColors&&U.multiply(v.color),e(ea,fa,P,R,J,O,Y,Q),!0===B.wireframe?
f(U,B.wireframeLinewidth,B.wireframeLinecap,B.wireframeLinejoin):h(U)):B instanceof THREE.MeshNormalMaterial?(s=void 0,B.shading==THREE.FlatShading?(s=v.normalModelView,U.setRGB(s.x,s.y,s.z).multiplyScalar(0.5).addScalar(0.5),e(ea,fa,P,R,J,O,Y,Q),!0===B.wireframe?f(U,B.wireframeLinewidth,B.wireframeLinecap,B.wireframeLinejoin):h(U)):B.shading==THREE.SmoothShading&&(s=v.vertexNormalsModelView[0],$.setRGB(s.x,s.y,s.z).multiplyScalar(0.5).addScalar(0.5),s=v.vertexNormalsModelView[1],W.setRGB(s.x,s.y,
s.z).multiplyScalar(0.5).addScalar(0.5),s=v.vertexNormalsModelView[3],X.setRGB(s.x,s.y,s.z).multiplyScalar(0.5).addScalar(0.5),s=v.vertexNormalsModelView[2],ka.setRGB(s.x,s.y,s.z).multiplyScalar(0.5).addScalar(0.5),la=j($,W,X,ka),d(ea,fa,P,R,Y,Q),i(ea,fa,P,R,Y,Q,0,0,1,0,0,1,la),d(T,da,J,O,ma,V),i(T,da,J,O,ma,V,1,0,1,1,0,1,la))):B instanceof THREE.MeshDepthMaterial&&(va=ia.near,wa=ia.far,$.r=$.g=$.b=1-y(s.positionScreen.z*s.positionScreen.w,va,wa),W.r=W.g=W.b=1-y(C.positionScreen.z*C.positionScreen.w,
va,wa),X.r=X.g=X.b=1-y(M.positionScreen.z*M.positionScreen.w,va,wa),ka.r=ka.g=ka.b=1-y(F.positionScreen.z*F.positionScreen.w,va,wa),la=j($,W,X,ka),d(ea,fa,P,R,Y,Q),i(ea,fa,P,R,Y,Q,0,0,1,0,0,1,la),d(T,da,J,O,ma,V),i(T,da,J,O,ma,V,1,0,1,1,0,1,la))))}ca.union(aa)}}m.setTransform(1,0,0,1,0,0)}}};THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3;this.positionScreen=new THREE.Vector4;this.visible=!0};THREE.RenderableVertex.prototype.copy=function(a){this.positionWorld.copy(a.positionWorld);this.positionScreen.copy(a.positionScreen)};THREE.RenderableFace3=function(){this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.centroidModel=new THREE.Vector3;this.normalModel=new THREE.Vector3;this.normalModelView=new THREE.Vector3;this.vertexNormalsLength=0;this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.material=this.color=null;this.uvs=[[]];this.z=null};THREE.RenderableFace4=function(){this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.v4=new THREE.RenderableVertex;this.centroidModel=new THREE.Vector3;this.normalModel=new THREE.Vector3;this.normalModelView=new THREE.Vector3;this.vertexNormalsLength=0;this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];
this.material=this.color=null;this.uvs=[[]];this.z=null};THREE.RenderableObject=function(){this.z=this.object=null};THREE.RenderableParticle=function(){this.rotation=this.z=this.y=this.x=this.object=null;this.scale=new THREE.Vector2;this.material=null};THREE.RenderableLine=function(){this.z=null;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.vertexColors=[new THREE.Color,new THREE.Color];this.material=null};
