// threejs.org/license
'use strict';THREE.GeometryUtils={merge:function(a,b,c){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var d;b instanceof THREE.Mesh&&(b.matrixAutoUpdate&&b.updateMatrix(),d=b.matrix,b=b.geometry);a.merge(b,d,c)},center:function(a){console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.");return a.center()}};
THREE.ImageUtils={crossOrigin:void 0,loadTexture:function(a,b,c,d){var f=new THREE.ImageLoader;f.crossOrigin=this.crossOrigin;var e=new THREE.Texture(void 0,b);f.load(a,function(a){e.image=a;e.needsUpdate=!0;c&&c(e)},void 0,function(a){d&&d(a)});e.sourceFile=a;return e},loadTextureCube:function(a,b,c,d){var f=new THREE.ImageLoader;f.crossOrigin=this.crossOrigin;var e=new THREE.CubeTexture([],b);e.flipY=!1;var g=0;b=function(b){f.load(a[b],function(a){e.images[b]=a;g+=1;6===g&&(e.needsUpdate=!0,c&&
c(e))})};d=0;for(var k=a.length;d<k;++d)b(d);return e},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},getNormalMap:function(a,b){var c=function(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);return[a[0]/b,a[1]/b,a[2]/b]};b|=1;var d=a.width,f=a.height,e=document.createElement("canvas");
e.width=d;e.height=f;var g=e.getContext("2d");g.drawImage(a,0,0);for(var k=g.getImageData(0,0,d,f).data,l=g.createImageData(d,f),m=l.data,n=0;n<d;n++)for(var h=0;h<f;h++){var p=0>h-1?0:h-1,r=h+1>f-1?f-1:h+1,s=0>n-1?0:n-1,q=n+1>d-1?d-1:n+1,v=[],x=[0,0,k[4*(h*d+n)]/255*b];v.push([-1,0,k[4*(h*d+s)]/255*b]);v.push([-1,-1,k[4*(p*d+s)]/255*b]);v.push([0,-1,k[4*(p*d+n)]/255*b]);v.push([1,-1,k[4*(p*d+q)]/255*b]);v.push([1,0,k[4*(h*d+q)]/255*b]);v.push([1,1,k[4*(r*d+q)]/255*b]);v.push([0,1,k[4*(r*d+n)]/255*
b]);v.push([-1,1,k[4*(r*d+s)]/255*b]);p=[];s=v.length;for(r=0;r<s;r++){var q=v[r],t=v[(r+1)%s],q=[q[0]-x[0],q[1]-x[1],q[2]-x[2]],t=[t[0]-x[0],t[1]-x[1],t[2]-x[2]];p.push(c([q[1]*t[2]-q[2]*t[1],q[2]*t[0]-q[0]*t[2],q[0]*t[1]-q[1]*t[0]]))}v=[0,0,0];for(r=0;r<p.length;r++)v[0]+=p[r][0],v[1]+=p[r][1],v[2]+=p[r][2];v[0]/=p.length;v[1]/=p.length;v[2]/=p.length;x=4*(h*d+n);m[x]=(v[0]+1)/2*255|0;m[x+1]=(v[1]+1)/2*255|0;m[x+2]=255*v[2]|0;m[x+3]=255}g.putImageData(l,0,0);return e},generateDataTexture:function(a,
b,c){var d=a*b,f=new Uint8Array(3*d),e=Math.floor(255*c.r),g=Math.floor(255*c.g);c=Math.floor(255*c.b);for(var k=0;k<d;k++)f[3*k]=e,f[3*k+1]=g,f[3*k+2]=c;a=new THREE.DataTexture(f,a,b,THREE.RGBFormat);a.needsUpdate=!0;return a}};
THREE.SceneUtils={createMultiMaterialObject:function(a,b){for(var c=new THREE.Object3D,d=0,f=b.length;d<f;d++)c.add(new THREE.Mesh(a,b[d]));return c},detach:function(a,b,c){a.applyMatrix(b.matrixWorld);b.remove(a);c.add(a)},attach:function(a,b,c){var d=new THREE.Matrix4;d.getInverse(c.matrixWorld);a.applyMatrix(d);b.remove(a);c.add(a)}};
THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(a){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing.";}},loadFace:function(a){var b=a.familyName.toLowerCase();this.faces[b]=this.faces[b]||{};this.faces[b][a.cssFontWeight]=this.faces[b][a.cssFontWeight]||{};this.faces[b][a.cssFontWeight][a.cssFontStyle]=a;return this.faces[b][a.cssFontWeight][a.cssFontStyle]=
a},drawText:function(a){var b=this.getFace(),c=this.size/b.resolution,d=0,f=String(a).split(""),e=f.length,g=[];for(a=0;a<e;a++){var k=new THREE.Path,k=this.extractGlyphPoints(f[a],b,c,d,k),d=d+k.offset;g.push(k.path)}return{paths:g,offset:d/2}},extractGlyphPoints:function(a,b,c,d,f){var e=[],g,k,l,m,n,h,p,r,s,q,v,x=b.glyphs[a]||b.glyphs["?"];if(x){if(x.o)for(b=x._cachedOutline||(x._cachedOutline=x.o.split(" ")),m=b.length,a=0;a<m;)switch(l=b[a++],l){case "m":l=b[a++]*c+d;n=b[a++]*c;f.moveTo(l,n);
break;case "l":l=b[a++]*c+d;n=b[a++]*c;f.lineTo(l,n);break;case "q":l=b[a++]*c+d;n=b[a++]*c;r=b[a++]*c+d;s=b[a++]*c;f.quadraticCurveTo(r,s,l,n);if(g=e[e.length-1])for(h=g.x,p=g.y,g=1,k=this.divisions;g<=k;g++){var t=g/k;THREE.Shape.Utils.b2(t,h,r,l);THREE.Shape.Utils.b2(t,p,s,n)}break;case "b":if(l=b[a++]*c+d,n=b[a++]*c,r=b[a++]*c+d,s=b[a++]*c,q=b[a++]*c+d,v=b[a++]*c,f.bezierCurveTo(r,s,q,v,l,n),g=e[e.length-1])for(h=g.x,p=g.y,g=1,k=this.divisions;g<=k;g++)t=g/k,THREE.Shape.Utils.b3(t,h,r,q,l),THREE.Shape.Utils.b3(t,
p,s,v,n)}return{offset:x.ha*c,path:f}}}};
THREE.FontUtils.generateShapes=function(a,b){b=b||{};var c=void 0!==b.curveSegments?b.curveSegments:4,d=void 0!==b.font?b.font:"helvetiker",f=void 0!==b.weight?b.weight:"normal",e=void 0!==b.style?b.style:"normal";THREE.FontUtils.size=void 0!==b.size?b.size:100;THREE.FontUtils.divisions=c;THREE.FontUtils.face=d;THREE.FontUtils.weight=f;THREE.FontUtils.style=e;c=THREE.FontUtils.drawText(a).paths;d=[];f=0;for(e=c.length;f<e;f++)Array.prototype.push.apply(d,c[f].toShapes());return d};
(function(a){var b=function(a){for(var b=a.length,f=0,e=b-1,g=0;g<b;e=g++)f+=a[e].x*a[g].y-a[g].x*a[e].y;return.5*f};a.Triangulate=function(a,d){var f=a.length;if(3>f)return null;var e=[],g=[],k=[],l,m,n;if(0<b(a))for(m=0;m<f;m++)g[m]=m;else for(m=0;m<f;m++)g[m]=f-1-m;var h=2*f;for(m=f-1;2<f;){if(0>=h--){console.log("Warning, unable to triangulate polygon!");break}l=m;f<=l&&(l=0);m=l+1;f<=m&&(m=0);n=m+1;f<=n&&(n=0);var p;a:{var r=p=void 0,s=void 0,q=void 0,v=void 0,x=void 0,t=void 0,G=void 0,u=void 0,
r=a[g[l]].x,s=a[g[l]].y,q=a[g[m]].x,v=a[g[m]].y,x=a[g[n]].x,t=a[g[n]].y;if(1E-10>(q-r)*(t-s)-(v-s)*(x-r))p=!1;else{var F=void 0,C=void 0,y=void 0,z=void 0,A=void 0,w=void 0,I=void 0,B=void 0,E=void 0,L=void 0,E=B=I=u=G=void 0,F=x-q,C=t-v,y=r-x,z=s-t,A=q-r,w=v-s;for(p=0;p<f;p++)if(G=a[g[p]].x,u=a[g[p]].y,!(G===r&&u===s||G===q&&u===v||G===x&&u===t)&&(I=G-r,B=u-s,E=G-q,L=u-v,G-=x,u-=t,E=F*L-C*E,I=A*B-w*I,B=y*u-z*G,-1E-10<=E&&-1E-10<=B&&-1E-10<=I)){p=!1;break a}p=!0}}if(p){e.push([a[g[l]],a[g[m]],a[g[n]]]);
k.push([g[l],g[m],g[n]]);l=m;for(n=m+1;n<f;l++,n++)g[l]=g[n];f--;h=2*f}}return d?k:e};a.Triangulate.area=b;return a})(THREE.FontUtils);self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace};THREE.typeface_js=self._typeface_js;
THREE.Audio=function(a){THREE.Object3D.call(this);this.type="Audio";this.context=a.context;this.source=this.context.createBufferSource();this.gain=this.context.createGain();this.gain.connect(this.context.destination);this.panner=this.context.createPanner();this.panner.connect(this.gain)};THREE.Audio.prototype=Object.create(THREE.Object3D.prototype);
THREE.Audio.prototype.load=function(a){var b=this,c=new XMLHttpRequest;c.open("GET",a,!0);c.responseType="arraybuffer";c.onload=function(a){b.context.decodeAudioData(this.response,function(a){b.source.buffer=a;b.source.connect(b.panner);b.source.start(0)})};c.send();return this};THREE.Audio.prototype.setLoop=function(a){this.source.loop=a};THREE.Audio.prototype.setRefDistance=function(a){this.panner.refDistance=a};THREE.Audio.prototype.setRolloffFactor=function(a){this.panner.rolloffFactor=a};
THREE.Audio.prototype.updateMatrixWorld=function(){var a=new THREE.Vector3;return function(b){THREE.Object3D.prototype.updateMatrixWorld.call(this,b);a.setFromMatrixPosition(this.matrixWorld);this.panner.setPosition(a.x,a.y,a.z)}}();THREE.AudioListener=function(){THREE.Object3D.call(this);this.type="AudioListener";this.context=new (window.AudioContext||window.webkitAudioContext)};THREE.AudioListener.prototype=Object.create(THREE.Object3D.prototype);
THREE.AudioListener.prototype.updateMatrixWorld=function(){var a=new THREE.Vector3,b=new THREE.Quaternion,c=new THREE.Vector3,d=new THREE.Vector3,f=new THREE.Vector3,e=new THREE.Vector3;return function(g){THREE.Object3D.prototype.updateMatrixWorld.call(this,g);g=this.context.listener;this.matrixWorld.decompose(a,b,c);d.set(0,0,-1).applyQuaternion(b);f.subVectors(a,e);g.setPosition(a.x,a.y,a.z);g.setOrientation(d.x,d.y,d.z,this.up.x,this.up.y,this.up.z);g.setVelocity(f.x,f.y,f.z);e.copy(a)}}();
THREE.Curve=function(){};THREE.Curve.prototype.getPoint=function(a){console.log("Warning, getPoint() not implemented!");return null};THREE.Curve.prototype.getPointAt=function(a){a=this.getUtoTmapping(a);return this.getPoint(a)};THREE.Curve.prototype.getPoints=function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.getPoint(b/a));return c};THREE.Curve.prototype.getSpacedPoints=function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.getPointAt(b/a));return c};
THREE.Curve.prototype.getLength=function(){var a=this.getLengths();return a[a.length-1]};THREE.Curve.prototype.getLengths=function(a){a||(a=this.__arcLengthDivisions?this.__arcLengthDivisions:200);if(this.cacheArcLengths&&this.cacheArcLengths.length==a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var b=[],c,d=this.getPoint(0),f,e=0;b.push(0);for(f=1;f<=a;f++)c=this.getPoint(f/a),e+=c.distanceTo(d),b.push(e),d=c;return this.cacheArcLengths=b};
THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0;this.getLengths()};THREE.Curve.prototype.getUtoTmapping=function(a,b){var c=this.getLengths(),d=0,f=c.length,e;e=b?b:a*c[f-1];for(var g=0,k=f-1,l;g<=k;)if(d=Math.floor(g+(k-g)/2),l=c[d]-e,0>l)g=d+1;else if(0<l)k=d-1;else{k=d;break}d=k;if(c[d]==e)return d/(f-1);g=c[d];return c=(d+(e-g)/(c[d+1]-g))/(f-1)};THREE.Curve.prototype.getTangent=function(a){var b=a-1E-4;a+=1E-4;0>b&&(b=0);1<a&&(a=1);b=this.getPoint(b);return this.getPoint(a).clone().sub(b).normalize()};
THREE.Curve.prototype.getTangentAt=function(a){a=this.getUtoTmapping(a);return this.getTangent(a)};
THREE.Curve.Utils={tangentQuadraticBezier:function(a,b,c,d){return 2*(1-a)*(c-b)+2*a*(d-c)},tangentCubicBezier:function(a,b,c,d,f){return-3*b*(1-a)*(1-a)+3*c*(1-a)*(1-a)-6*a*c*(1-a)+6*a*d*(1-a)-3*a*a*d+3*a*a*f},tangentSpline:function(a,b,c,d,f){return 6*a*a-6*a+(3*a*a-4*a+1)+(-6*a*a+6*a)+(3*a*a-2*a)},interpolate:function(a,b,c,d,f){a=.5*(c-a);d=.5*(d-b);var e=f*f;return(2*b-2*c+a+d)*f*e+(-3*b+3*c-2*a-d)*e+a*f+b}};
THREE.Curve.create=function(a,b){a.prototype=Object.create(THREE.Curve.prototype);a.prototype.getPoint=b;return a};THREE.CurvePath=function(){this.curves=[];this.bends=[];this.autoClose=!1};THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype);THREE.CurvePath.prototype.add=function(a){this.curves.push(a)};THREE.CurvePath.prototype.checkConnection=function(){};
THREE.CurvePath.prototype.closePath=function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);a.equals(b)||this.curves.push(new THREE.LineCurve(b,a))};THREE.CurvePath.prototype.getPoint=function(a){var b=a*this.getLength(),c=this.getCurveLengths();for(a=0;a<c.length;){if(c[a]>=b)return b=c[a]-b,a=this.curves[a],b=1-b/a.getLength(),a.getPointAt(b);a++}return null};THREE.CurvePath.prototype.getLength=function(){var a=this.getCurveLengths();return a[a.length-1]};
THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var a=[],b=0,c,d=this.curves.length;for(c=0;c<d;c++)b+=this.curves[c].getLength(),a.push(b);return this.cacheLengths=a};
THREE.CurvePath.prototype.getBoundingBox=function(){var a=this.getPoints(),b,c,d,f,e,g;b=c=Number.NEGATIVE_INFINITY;f=e=Number.POSITIVE_INFINITY;var k,l,m,n,h=a[0]instanceof THREE.Vector3;n=h?new THREE.Vector3:new THREE.Vector2;l=0;for(m=a.length;l<m;l++)k=a[l],k.x>b?b=k.x:k.x<f&&(f=k.x),k.y>c?c=k.y:k.y<e&&(e=k.y),h&&(k.z>d?d=k.z:k.z<g&&(g=k.z)),n.add(k);a={minX:f,minY:e,maxX:b,maxY:c};h&&(a.maxZ=d,a.minZ=g);return a};
THREE.CurvePath.prototype.createPointsGeometry=function(a){a=this.getPoints(a,!0);return this.createGeometry(a)};THREE.CurvePath.prototype.createSpacedPointsGeometry=function(a){a=this.getSpacedPoints(a,!0);return this.createGeometry(a)};THREE.CurvePath.prototype.createGeometry=function(a){for(var b=new THREE.Geometry,c=0;c<a.length;c++)b.vertices.push(new THREE.Vector3(a[c].x,a[c].y,a[c].z||0));return b};THREE.CurvePath.prototype.addWrapPath=function(a){this.bends.push(a)};
THREE.CurvePath.prototype.getTransformedPoints=function(a,b){var c=this.getPoints(a),d,f;b||(b=this.bends);d=0;for(f=b.length;d<f;d++)c=this.getWrapPoints(c,b[d]);return c};THREE.CurvePath.prototype.getTransformedSpacedPoints=function(a,b){var c=this.getSpacedPoints(a),d,f;b||(b=this.bends);d=0;for(f=b.length;d<f;d++)c=this.getWrapPoints(c,b[d]);return c};
THREE.CurvePath.prototype.getWrapPoints=function(a,b){var c=this.getBoundingBox(),d,f,e,g,k,l;d=0;for(f=a.length;d<f;d++)e=a[d],g=e.x,k=e.y,l=g/c.maxX,l=b.getUtoTmapping(l,g),g=b.getPoint(l),l=b.getTangent(l),l.set(-l.y,l.x).multiplyScalar(k),e.x=g.x+l.x,e.y=g.y+l.y;return a};THREE.Gyroscope=function(){THREE.Object3D.call(this)};THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype);
THREE.Gyroscope.prototype.updateMatrixWorld=function(){var a=new THREE.Vector3,b=new THREE.Quaternion,c=new THREE.Vector3,d=new THREE.Vector3,f=new THREE.Quaternion,e=new THREE.Vector3;return function(g){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||g)this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(d,f,e),this.matrix.decompose(a,b,c),this.matrixWorld.compose(d,b,e)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=
!1,g=!0;for(var k=0,l=this.children.length;k<l;k++)this.children[k].updateMatrixWorld(g)}}();THREE.Path=function(a){THREE.CurvePath.call(this);this.actions=[];a&&this.fromPoints(a)};THREE.Path.prototype=Object.create(THREE.CurvePath.prototype);THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"};
THREE.Path.prototype.fromPoints=function(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y)};THREE.Path.prototype.moveTo=function(a,b){var c=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:c})};
THREE.Path.prototype.lineTo=function(a,b){var c=Array.prototype.slice.call(arguments),d=this.actions[this.actions.length-1].args,d=new THREE.LineCurve(new THREE.Vector2(d[d.length-2],d[d.length-1]),new THREE.Vector2(a,b));this.curves.push(d);this.actions.push({action:THREE.PathActions.LINE_TO,args:c})};
THREE.Path.prototype.quadraticCurveTo=function(a,b,c,d){var f=Array.prototype.slice.call(arguments),e=this.actions[this.actions.length-1].args,e=new THREE.QuadraticBezierCurve(new THREE.Vector2(e[e.length-2],e[e.length-1]),new THREE.Vector2(a,b),new THREE.Vector2(c,d));this.curves.push(e);this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:f})};
THREE.Path.prototype.bezierCurveTo=function(a,b,c,d,f,e){var g=Array.prototype.slice.call(arguments),k=this.actions[this.actions.length-1].args,k=new THREE.CubicBezierCurve(new THREE.Vector2(k[k.length-2],k[k.length-1]),new THREE.Vector2(a,b),new THREE.Vector2(c,d),new THREE.Vector2(f,e));this.curves.push(k);this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:g})};
THREE.Path.prototype.splineThru=function(a){var b=Array.prototype.slice.call(arguments),c=this.actions[this.actions.length-1].args,c=[new THREE.Vector2(c[c.length-2],c[c.length-1])];Array.prototype.push.apply(c,a);c=new THREE.SplineCurve(c);this.curves.push(c);this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:b})};THREE.Path.prototype.arc=function(a,b,c,d,f,e){var g=this.actions[this.actions.length-1].args;this.absarc(a+g[g.length-2],b+g[g.length-1],c,d,f,e)};
THREE.Path.prototype.absarc=function(a,b,c,d,f,e){this.absellipse(a,b,c,c,d,f,e)};THREE.Path.prototype.ellipse=function(a,b,c,d,f,e,g){var k=this.actions[this.actions.length-1].args;this.absellipse(a+k[k.length-2],b+k[k.length-1],c,d,f,e,g)};THREE.Path.prototype.absellipse=function(a,b,c,d,f,e,g){var k=Array.prototype.slice.call(arguments),l=new THREE.EllipseCurve(a,b,c,d,f,e,g);this.curves.push(l);l=l.getPoint(1);k.push(l.x);k.push(l.y);this.actions.push({action:THREE.PathActions.ELLIPSE,args:k})};
THREE.Path.prototype.getSpacedPoints=function(a,b){a||(a=40);for(var c=[],d=0;d<a;d++)c.push(this.getPoint(d/a));return c};
THREE.Path.prototype.getPoints=function(a,b){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(a,b);a=a||12;var c=[],d,f,e,g,k,l,m,n,h,p,r,s,q;d=0;for(f=this.actions.length;d<f;d++)switch(e=this.actions[d],g=e.action,e=e.args,g){case THREE.PathActions.MOVE_TO:c.push(new THREE.Vector2(e[0],e[1]));break;case THREE.PathActions.LINE_TO:c.push(new THREE.Vector2(e[0],e[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:k=e[2];l=e[3];h=e[0];p=e[1];0<c.length?(g=c[c.length-1],r=g.x,
s=g.y):(g=this.actions[d-1].args,r=g[g.length-2],s=g[g.length-1]);for(e=1;e<=a;e++)q=e/a,g=THREE.Shape.Utils.b2(q,r,h,k),q=THREE.Shape.Utils.b2(q,s,p,l),c.push(new THREE.Vector2(g,q));break;case THREE.PathActions.BEZIER_CURVE_TO:k=e[4];l=e[5];h=e[0];p=e[1];m=e[2];n=e[3];0<c.length?(g=c[c.length-1],r=g.x,s=g.y):(g=this.actions[d-1].args,r=g[g.length-2],s=g[g.length-1]);for(e=1;e<=a;e++)q=e/a,g=THREE.Shape.Utils.b3(q,r,h,m,k),q=THREE.Shape.Utils.b3(q,s,p,n,l),c.push(new THREE.Vector2(g,q));break;case THREE.PathActions.CSPLINE_THRU:g=
this.actions[d-1].args;q=[new THREE.Vector2(g[g.length-2],g[g.length-1])];g=a*e[0].length;q=q.concat(e[0]);q=new THREE.SplineCurve(q);for(e=1;e<=g;e++)c.push(q.getPointAt(e/g));break;case THREE.PathActions.ARC:k=e[0];l=e[1];p=e[2];m=e[3];g=e[4];h=!!e[5];r=g-m;s=2*a;for(e=1;e<=s;e++)q=e/s,h||(q=1-q),q=m+q*r,g=k+p*Math.cos(q),q=l+p*Math.sin(q),c.push(new THREE.Vector2(g,q));break;case THREE.PathActions.ELLIPSE:for(k=e[0],l=e[1],p=e[2],n=e[3],m=e[4],g=e[5],h=!!e[6],r=g-m,s=2*a,e=1;e<=s;e++)q=e/s,h||
(q=1-q),q=m+q*r,g=k+p*Math.cos(q),q=l+n*Math.sin(q),c.push(new THREE.Vector2(g,q))}d=c[c.length-1];1E-10>Math.abs(d.x-c[0].x)&&1E-10>Math.abs(d.y-c[0].y)&&c.splice(c.length-1,1);b&&c.push(c[0]);return c};
THREE.Path.prototype.toShapes=function(a,b){function c(a){for(var b=[],c=0,d=a.length;c<d;c++){var g=a[c],f=new THREE.Shape;f.actions=g.actions;f.curves=g.curves;b.push(f)}return b}function d(a,b){for(var c=b.length,d=!1,g=c-1,f=0;f<c;g=f++){var e=b[g],h=b[f],k=h.x-e.x,l=h.y-e.y;if(1E-10<Math.abs(l)){if(0>l&&(e=b[f],k=-k,h=b[g],l=-l),!(a.y<e.y||a.y>h.y))if(a.y==e.y){if(a.x==e.x)return!0}else{g=l*(a.x-e.x)-k*(a.y-e.y);if(0==g)return!0;0>g||(d=!d)}}else if(a.y==e.y&&(h.x<=a.x&&a.x<=e.x||e.x<=a.x&&a.x<=
h.x))return!0}return d}var f=function(a){var b,c,d,g,f=[],e=new THREE.Path;b=0;for(c=a.length;b<c;b++)d=a[b],g=d.args,d=d.action,d==THREE.PathActions.MOVE_TO&&0!=e.actions.length&&(f.push(e),e=new THREE.Path),e[d].apply(e,g);0!=e.actions.length&&f.push(e);return f}(this.actions);if(0==f.length)return[];if(!0===b)return c(f);var e,g,k,l=[];if(1==f.length)return g=f[0],k=new THREE.Shape,k.actions=g.actions,k.curves=g.curves,l.push(k),l;var m=!THREE.Shape.Utils.isClockWise(f[0].getPoints()),m=a?!m:m;
k=[];var n=[],h=[],p=0,r;n[p]=void 0;h[p]=[];var s,q;s=0;for(q=f.length;s<q;s++)g=f[s],r=g.getPoints(),e=THREE.Shape.Utils.isClockWise(r),(e=a?!e:e)?(!m&&n[p]&&p++,n[p]={s:new THREE.Shape,p:r},n[p].s.actions=g.actions,n[p].s.curves=g.curves,m&&p++,h[p]=[]):h[p].push({h:g,p:r[0]});if(!n[0])return c(f);if(1<n.length){s=!1;q=[];g=0;for(f=n.length;g<f;g++)k[g]=[];g=0;for(f=n.length;g<f;g++)for(e=h[g],m=0;m<e.length;m++){p=e[m];r=!0;for(var v=0;v<n.length;v++)d(p.p,n[v].p)&&(g!=v&&q.push({froms:g,tos:v,
hole:m}),r?(r=!1,k[v].push(p)):s=!0);r&&k[g].push(p)}0<q.length&&(s||(h=k))}s=0;for(q=n.length;s<q;s++)for(k=n[s].s,l.push(k),g=h[s],f=0,e=g.length;f<e;f++)k.holes.push(g[f].h);return l};THREE.Shape=function(){THREE.Path.apply(this,arguments);this.holes=[]};THREE.Shape.prototype=Object.create(THREE.Path.prototype);THREE.Shape.prototype.extrude=function(a){return new THREE.ExtrudeGeometry(this,a)};THREE.Shape.prototype.makeGeometry=function(a){return new THREE.ShapeGeometry(this,a)};
THREE.Shape.prototype.getPointsHoles=function(a){var b,c=this.holes.length,d=[];for(b=0;b<c;b++)d[b]=this.holes[b].getTransformedPoints(a,this.bends);return d};THREE.Shape.prototype.getSpacedPointsHoles=function(a){var b,c=this.holes.length,d=[];for(b=0;b<c;b++)d[b]=this.holes[b].getTransformedSpacedPoints(a,this.bends);return d};THREE.Shape.prototype.extractAllPoints=function(a){return{shape:this.getTransformedPoints(a),holes:this.getPointsHoles(a)}};
THREE.Shape.prototype.extractPoints=function(a){return this.useSpacedPoints?this.extractAllSpacedPoints(a):this.extractAllPoints(a)};THREE.Shape.prototype.extractAllSpacedPoints=function(a){return{shape:this.getTransformedSpacedPoints(a),holes:this.getSpacedPointsHoles(a)}};
THREE.Shape.Utils={triangulateShape:function(a,b){function c(a,b,c){return a.x!=b.x?a.x<b.x?a.x<=c.x&&c.x<=b.x:b.x<=c.x&&c.x<=a.x:a.y<b.y?a.y<=c.y&&c.y<=b.y:b.y<=c.y&&c.y<=a.y}function d(a,b,d,g,f){var e=b.x-a.x,h=b.y-a.y,k=g.x-d.x,l=g.y-d.y,m=a.x-d.x,n=a.y-d.y,y=h*k-e*l,z=h*m-e*n;if(1E-10<Math.abs(y)){if(0<y){if(0>z||z>y)return[];k=l*m-k*n;if(0>k||k>y)return[]}else{if(0<z||z<y)return[];k=l*m-k*n;if(0<k||k<y)return[]}if(0==k)return!f||0!=z&&z!=y?[a]:[];if(k==y)return!f||0!=z&&z!=y?[b]:[];if(0==z)return[d];
if(z==y)return[g];f=k/y;return[{x:a.x+f*e,y:a.y+f*h}]}if(0!=z||l*m!=k*n)return[];h=0==e&&0==h;k=0==k&&0==l;if(h&&k)return a.x!=d.x||a.y!=d.y?[]:[a];if(h)return c(d,g,a)?[a]:[];if(k)return c(a,b,d)?[d]:[];0!=e?(a.x<b.x?(e=a,k=a.x,h=b,a=b.x):(e=b,k=b.x,h=a,a=a.x),d.x<g.x?(b=d,y=d.x,l=g,d=g.x):(b=g,y=g.x,l=d,d=d.x)):(a.y<b.y?(e=a,k=a.y,h=b,a=b.y):(e=b,k=b.y,h=a,a=a.y),d.y<g.y?(b=d,y=d.y,l=g,d=g.y):(b=g,y=g.y,l=d,d=d.y));return k<=y?a<y?[]:a==y?f?[]:[b]:a<=d?[b,h]:[b,l]:k>d?[]:k==d?f?[]:[e]:a<=d?[e,h]:
[e,l]}function f(a,b,c,d){var g=b.x-a.x,f=b.y-a.y;b=c.x-a.x;c=c.y-a.y;var e=d.x-a.x;d=d.y-a.y;a=g*c-f*b;g=g*d-f*e;return 1E-10<Math.abs(a)?(b=e*c-d*b,0<a?0<=g&&0<=b:0<=g||0<=b):0<g}var e,g,k,l,m,n={};k=a.concat();e=0;for(g=b.length;e<g;e++)Array.prototype.push.apply(k,b[e]);e=0;for(g=k.length;e<g;e++)m=k[e].x+":"+k[e].y,void 0!==n[m]&&console.log("Duplicate point",m),n[m]=e;e=function(a,b){function c(a,b){var d=h.length-1,g=a-1;0>g&&(g=d);var e=a+1;e>d&&(e=0);d=f(h[a],h[g],h[e],k[b]);if(!d)return!1;
d=k.length-1;g=b-1;0>g&&(g=d);e=b+1;e>d&&(e=0);return(d=f(k[b],k[g],k[e],h[a]))?!0:!1}function g(a,b){var c,e;for(c=0;c<h.length;c++)if(e=c+1,e%=h.length,e=d(a,b,h[c],h[e],!0),0<e.length)return!0;return!1}function e(a,c){var g,f,h,k;for(g=0;g<l.length;g++)for(f=b[l[g]],h=0;h<f.length;h++)if(k=h+1,k%=f.length,k=d(a,c,f[h],f[k],!0),0<k.length)return!0;return!1}var h=a.concat(),k,l=[],m,n,C,y,z,A=[],w,I,B,E=0;for(m=b.length;E<m;E++)l.push(E);w=0;for(var L=2*l.length;0<l.length;){L--;if(0>L){console.log("Infinite Loop! Holes left:"+
l.length+", Probably Hole outside Shape!");break}for(n=w;n<h.length;n++){C=h[n];m=-1;for(E=0;E<l.length;E++)if(y=l[E],z=C.x+":"+C.y+":"+y,void 0===A[z]){k=b[y];for(I=0;I<k.length;I++)if(y=k[I],c(n,I)&&!g(C,y)&&!e(C,y)){m=I;l.splice(E,1);w=h.slice(0,n+1);y=h.slice(n);I=k.slice(m);B=k.slice(0,m+1);h=w.concat(I).concat(B).concat(y);w=n;break}if(0<=m)break;A[z]=!0}if(0<=m)break}}return h}(a,b);var h=THREE.FontUtils.Triangulate(e,!1);e=0;for(g=h.length;e<g;e++)for(l=h[e],k=0;3>k;k++)m=l[k].x+":"+l[k].y,
m=n[m],void 0!==m&&(l[k]=m);return h.concat()},isClockWise:function(a){return 0>THREE.FontUtils.Triangulate.area(a)},b2p0:function(a,b){var c=1-a;return c*c*b},b2p1:function(a,b){return 2*(1-a)*a*b},b2p2:function(a,b){return a*a*b},b2:function(a,b,c,d){return this.b2p0(a,b)+this.b2p1(a,c)+this.b2p2(a,d)},b3p0:function(a,b){var c=1-a;return c*c*c*b},b3p1:function(a,b){var c=1-a;return 3*c*c*a*b},b3p2:function(a,b){return 3*(1-a)*a*a*b},b3p3:function(a,b){return a*a*a*b},b3:function(a,b,c,d,f){return this.b3p0(a,
b)+this.b3p1(a,c)+this.b3p2(a,d)+this.b3p3(a,f)}};THREE.LineCurve=function(a,b){this.v1=a;this.v2=b};THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.LineCurve.prototype.getPoint=function(a){var b=this.v2.clone().sub(this.v1);b.multiplyScalar(a).add(this.v1);return b};THREE.LineCurve.prototype.getPointAt=function(a){return this.getPoint(a)};THREE.LineCurve.prototype.getTangent=function(a){return this.v2.clone().sub(this.v1).normalize()};
THREE.QuadraticBezierCurve=function(a,b,c){this.v0=a;this.v1=b;this.v2=c};THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.QuadraticBezierCurve.prototype.getPoint=function(a){var b;b=THREE.Shape.Utils.b2(a,this.v0.x,this.v1.x,this.v2.x);a=THREE.Shape.Utils.b2(a,this.v0.y,this.v1.y,this.v2.y);return new THREE.Vector2(b,a)};
THREE.QuadraticBezierCurve.prototype.getTangent=function(a){var b;b=THREE.Curve.Utils.tangentQuadraticBezier(a,this.v0.x,this.v1.x,this.v2.x);a=THREE.Curve.Utils.tangentQuadraticBezier(a,this.v0.y,this.v1.y,this.v2.y);b=new THREE.Vector2(b,a);b.normalize();return b};THREE.CubicBezierCurve=function(a,b,c,d){this.v0=a;this.v1=b;this.v2=c;this.v3=d};THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype);
THREE.CubicBezierCurve.prototype.getPoint=function(a){var b;b=THREE.Shape.Utils.b3(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x);a=THREE.Shape.Utils.b3(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y);return new THREE.Vector2(b,a)};THREE.CubicBezierCurve.prototype.getTangent=function(a){var b;b=THREE.Curve.Utils.tangentCubicBezier(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x);a=THREE.Curve.Utils.tangentCubicBezier(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y);b=new THREE.Vector2(b,a);b.normalize();return b};
THREE.SplineCurve=function(a){this.points=void 0==a?[]:a};THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.SplineCurve.prototype.getPoint=function(a){var b=new THREE.Vector2,c=[],d=this.points,f;f=(d.length-1)*a;a=Math.floor(f);f-=a;c[0]=0==a?a:a-1;c[1]=a;c[2]=a>d.length-2?d.length-1:a+1;c[3]=a>d.length-3?d.length-1:a+2;b.x=THREE.Curve.Utils.interpolate(d[c[0]].x,d[c[1]].x,d[c[2]].x,d[c[3]].x,f);b.y=THREE.Curve.Utils.interpolate(d[c[0]].y,d[c[1]].y,d[c[2]].y,d[c[3]].y,f);return b};
THREE.EllipseCurve=function(a,b,c,d,f,e,g){this.aX=a;this.aY=b;this.xRadius=c;this.yRadius=d;this.aStartAngle=f;this.aEndAngle=e;this.aClockwise=g};THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype);
THREE.EllipseCurve.prototype.getPoint=function(a){var b;b=this.aEndAngle-this.aStartAngle;0>b&&(b+=2*Math.PI);b>2*Math.PI&&(b-=2*Math.PI);b=!0===this.aClockwise?this.aEndAngle+(1-a)*(2*Math.PI-b):this.aStartAngle+a*b;a=this.aX+this.xRadius*Math.cos(b);b=this.aY+this.yRadius*Math.sin(b);return new THREE.Vector2(a,b)};THREE.ArcCurve=function(a,b,c,d,f,e){THREE.EllipseCurve.call(this,a,b,c,c,d,f,e)};THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype);
THREE.LineCurve3=THREE.Curve.create(function(a,b){this.v1=a;this.v2=b},function(a){var b=new THREE.Vector3;b.subVectors(this.v2,this.v1);b.multiplyScalar(a);b.add(this.v1);return b});THREE.QuadraticBezierCurve3=THREE.Curve.create(function(a,b,c){this.v0=a;this.v1=b;this.v2=c},function(a){var b,c;b=THREE.Shape.Utils.b2(a,this.v0.x,this.v1.x,this.v2.x);c=THREE.Shape.Utils.b2(a,this.v0.y,this.v1.y,this.v2.y);a=THREE.Shape.Utils.b2(a,this.v0.z,this.v1.z,this.v2.z);return new THREE.Vector3(b,c,a)});
THREE.CubicBezierCurve3=THREE.Curve.create(function(a,b,c,d){this.v0=a;this.v1=b;this.v2=c;this.v3=d},function(a){var b,c;b=THREE.Shape.Utils.b3(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x);c=THREE.Shape.Utils.b3(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y);a=THREE.Shape.Utils.b3(a,this.v0.z,this.v1.z,this.v2.z,this.v3.z);return new THREE.Vector3(b,c,a)});
THREE.SplineCurve3=THREE.Curve.create(function(a){this.points=void 0==a?[]:a},function(a){var b=new THREE.Vector3,c=[],d=this.points,f;a*=d.length-1;f=Math.floor(a);a-=f;c[0]=0==f?f:f-1;c[1]=f;c[2]=f>d.length-2?d.length-1:f+1;c[3]=f>d.length-3?d.length-1:f+2;f=d[c[0]];var e=d[c[1]],g=d[c[2]],c=d[c[3]];b.x=THREE.Curve.Utils.interpolate(f.x,e.x,g.x,c.x,a);b.y=THREE.Curve.Utils.interpolate(f.y,e.y,g.y,c.y,a);b.z=THREE.Curve.Utils.interpolate(f.z,e.z,g.z,c.z,a);return b});
THREE.ClosedSplineCurve3=THREE.Curve.create(function(a){this.points=void 0==a?[]:a},function(a){var b=new THREE.Vector3,c=[],d=this.points,f;f=(d.length-0)*a;a=Math.floor(f);f-=a;a+=0<a?0:(Math.floor(Math.abs(a)/d.length)+1)*d.length;c[0]=(a-1)%d.length;c[1]=a%d.length;c[2]=(a+1)%d.length;c[3]=(a+2)%d.length;b.x=THREE.Curve.Utils.interpolate(d[c[0]].x,d[c[1]].x,d[c[2]].x,d[c[3]].x,f);b.y=THREE.Curve.Utils.interpolate(d[c[0]].y,d[c[1]].y,d[c[2]].y,d[c[3]].y,f);b.z=THREE.Curve.Utils.interpolate(d[c[0]].z,
d[c[1]].z,d[c[2]].z,d[c[3]].z,f);return b});
THREE.AnimationHandler={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2,add:function(){console.warn("THREE.AnimationHandler.add() has been deprecated.")},get:function(){console.warn("THREE.AnimationHandler.get() has been deprecated.")},remove:function(){console.warn("THREE.AnimationHandler.remove() has been deprecated.")},animations:[],init:function(a){if(!0!==a.initialized){for(var b=0;b<a.hierarchy.length;b++){for(var c=0;c<a.hierarchy[b].keys.length;c++)if(0>a.hierarchy[b].keys[c].time&&(a.hierarchy[b].keys[c].time=
0),void 0!==a.hierarchy[b].keys[c].rot&&!(a.hierarchy[b].keys[c].rot instanceof THREE.Quaternion)){var d=a.hierarchy[b].keys[c].rot;a.hierarchy[b].keys[c].rot=(new THREE.Quaternion).fromArray(d)}if(a.hierarchy[b].keys.length&&void 0!==a.hierarchy[b].keys[0].morphTargets){d={};for(c=0;c<a.hierarchy[b].keys.length;c++)for(var f=0;f<a.hierarchy[b].keys[c].morphTargets.length;f++){var e=a.hierarchy[b].keys[c].morphTargets[f];d[e]=-1}a.hierarchy[b].usedMorphTargets=d;for(c=0;c<a.hierarchy[b].keys.length;c++){var g=
{};for(e in d){for(f=0;f<a.hierarchy[b].keys[c].morphTargets.length;f++)if(a.hierarchy[b].keys[c].morphTargets[f]===e){g[e]=a.hierarchy[b].keys[c].morphTargetsInfluences[f];break}f===a.hierarchy[b].keys[c].morphTargets.length&&(g[e]=0)}a.hierarchy[b].keys[c].morphTargetsInfluences=g}}for(c=1;c<a.hierarchy[b].keys.length;c++)a.hierarchy[b].keys[c].time===a.hierarchy[b].keys[c-1].time&&(a.hierarchy[b].keys.splice(c,1),c--);for(c=0;c<a.hierarchy[b].keys.length;c++)a.hierarchy[b].keys[c].index=c}a.initialized=
!0;return a}},parse:function(a){var b=function(a,c){c.push(a);for(var d=0;d<a.children.length;d++)b(a.children[d],c)},c=[];if(a instanceof THREE.SkinnedMesh)for(var d=0;d<a.skeleton.bones.length;d++)c.push(a.skeleton.bones[d]);else b(a,c);return c},play:function(a){-1===this.animations.indexOf(a)&&this.animations.push(a)},stop:function(a){a=this.animations.indexOf(a);-1!==a&&this.animations.splice(a,1)},update:function(a){for(var b=0;b<this.animations.length;b++)this.animations[b].resetBlendWeights();
for(b=0;b<this.animations.length;b++)this.animations[b].update(a)}};THREE.Animation=function(a,b){this.root=a;this.data=THREE.AnimationHandler.init(b);this.hierarchy=THREE.AnimationHandler.parse(a);this.currentTime=0;this.timeScale=1;this.isPlaying=!1;this.loop=!0;this.weight=0;this.interpolationType=THREE.AnimationHandler.LINEAR};THREE.Animation.prototype.keyTypes=["pos","rot","scl"];
THREE.Animation.prototype.play=function(a,b){this.currentTime=void 0!==a?a:0;this.weight=void 0!==b?b:1;this.isPlaying=!0;this.reset();THREE.AnimationHandler.play(this)};THREE.Animation.prototype.stop=function(){this.isPlaying=!1;THREE.AnimationHandler.stop(this)};
THREE.Animation.prototype.reset=function(){for(var a=0,b=this.hierarchy.length;a<b;a++){var c=this.hierarchy[a];c.matrixAutoUpdate=!0;void 0===c.animationCache&&(c.animationCache={animations:{},blending:{positionWeight:0,quaternionWeight:0,scaleWeight:0}});void 0===c.animationCache.animations[this.data.name]&&(c.animationCache.animations[this.data.name]={},c.animationCache.animations[this.data.name].prevKey={pos:0,rot:0,scl:0},c.animationCache.animations[this.data.name].nextKey={pos:0,rot:0,scl:0},
c.animationCache.animations[this.data.name].originalMatrix=c.matrix);for(var c=c.animationCache.animations[this.data.name],d=0;3>d;d++){var f=this.keyTypes[d],e=this.data.hierarchy[a].keys[0],g=this.getNextKeyWith(f,a,1);if(e&&e[f]&&g&&g[f]){for(;g.time<this.currentTime&&g.index>e.index;)e=g,g=this.getNextKeyWith(f,a,g.index+1);c.prevKey[f]=e;c.nextKey[f]=g}}}};
THREE.Animation.prototype.resetBlendWeights=function(){for(var a=0,b=this.hierarchy.length;a<b;a++){var c=this.hierarchy[a];void 0!==c.animationCache&&(c.animationCache.blending.positionWeight=0,c.animationCache.blending.quaternionWeight=0,c.animationCache.blending.scaleWeight=0)}};
THREE.Animation.prototype.update=function(){var a=[],b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Quaternion,f=function(a,b){var c=[],d=[],f,h,p,r,s,q;f=(a.length-1)*b;h=Math.floor(f);f-=h;c[0]=0===h?h:h-1;c[1]=h;c[2]=h>a.length-2?h:h+1;c[3]=h>a.length-3?h:h+2;h=a[c[0]];r=a[c[1]];s=a[c[2]];q=a[c[3]];c=f*f;p=f*c;d[0]=e(h[0],r[0],s[0],q[0],f,c,p);d[1]=e(h[1],r[1],s[1],q[1],f,c,p);d[2]=e(h[2],r[2],s[2],q[2],f,c,p);return d},e=function(a,b,c,d,e,f,p){a=.5*(c-a);d=.5*(d-b);return(2*(b-c)+a+d)*p+
(-3*(b-c)-2*a-d)*f+a*e+b};return function(e){if(!1!==this.isPlaying&&(this.currentTime+=e*this.timeScale,0!==this.weight)){e=this.data.length;if(this.currentTime>e||0>this.currentTime)if(this.loop)this.currentTime%=e,0>this.currentTime&&(this.currentTime+=e),this.reset();else{this.stop();return}e=0;for(var k=this.hierarchy.length;e<k;e++)for(var l=this.hierarchy[e],m=l.animationCache.animations[this.data.name],n=l.animationCache.blending,h=0;3>h;h++){var p=this.keyTypes[h],r=m.prevKey[p],s=m.nextKey[p];
if(r&&r[p]&&s&&s[p]){if(0<this.timeScale&&s.time<=this.currentTime||0>this.timeScale&&r.time>=this.currentTime){r=this.data.hierarchy[e].keys[0];for(s=this.getNextKeyWith(p,e,1);s.time<this.currentTime&&s.index>r.index;)r=s,s=this.getNextKeyWith(p,e,s.index+1);m.prevKey[p]=r;m.nextKey[p]=s}l.matrixAutoUpdate=!0;l.matrixWorldNeedsUpdate=!0;var q=(this.currentTime-r.time)/(s.time-r.time),v=r[p],x=s[p];0>q&&(q=0);1<q&&(q=1);if("pos"===p)if(this.interpolationType===THREE.AnimationHandler.LINEAR)c.x=v[0]+
(x[0]-v[0])*q,c.y=v[1]+(x[1]-v[1])*q,c.z=v[2]+(x[2]-v[2])*q,r=this.weight/(this.weight+n.positionWeight),l.position.lerp(c,r),n.positionWeight+=this.weight;else{if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)a[0]=this.getPrevKeyWith("pos",e,r.index-1).pos,a[1]=v,a[2]=x,a[3]=this.getNextKeyWith("pos",e,s.index+1).pos,q=.33*q+.33,s=f(a,q),r=this.weight/(this.weight+n.positionWeight),n.positionWeight+=this.weight,p=l.position,
p.x+=(s[0]-p.x)*r,p.y+=(s[1]-p.y)*r,p.z+=(s[2]-p.z)*r,this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(q=f(a,1.01*q),b.set(q[0],q[1],q[2]),b.sub(p),b.y=0,b.normalize(),q=Math.atan2(b.x,b.z),l.rotation.set(0,q,0))}else"rot"===p?(THREE.Quaternion.slerp(v,x,d,q),0===n.quaternionWeight?(l.quaternion.copy(d),n.quaternionWeight=this.weight):(r=this.weight/(this.weight+n.quaternionWeight),THREE.Quaternion.slerp(l.quaternion,d,l.quaternion,r),n.quaternionWeight+=this.weight)):"scl"===
p&&(c.x=v[0]+(x[0]-v[0])*q,c.y=v[1]+(x[1]-v[1])*q,c.z=v[2]+(x[2]-v[2])*q,r=this.weight/(this.weight+n.scaleWeight),l.scale.lerp(c,r),n.scaleWeight+=this.weight)}}return!0}}}();
THREE.Animation.prototype.getNextKeyWith=function(a,b,c){var d=this.data.hierarchy[b].keys;if(void 0!==d&&0<d.length){for(c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?c<d.length-1?c:d.length-1:c%d.length;c<d.length;c++)if(c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?c<d.length-1?c:d.length-1:c%d.length,void 0!==d[c][a])return d[c];
return this.data.hierarchy[b].keys[0]}return null};THREE.Animation.prototype.getPrevKeyWith=function(a,b,c){var d=this.data.hierarchy[b].keys;if(void 0!==d&&0<d.length){for(c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?0<c?c:0:0<=c?c:c+d.length;0<=c;c--)if(void 0!==d[c][a])return d[c];return this.data.hierarchy[b].keys[d.length-1]}return null};
THREE.KeyFrameAnimation=function(a){this.root=a.node;this.data=THREE.AnimationHandler.init(a);this.hierarchy=THREE.AnimationHandler.parse(this.root);this.currentTime=0;this.timeScale=.001;this.isPlaying=!1;this.loop=this.isPaused=!0;a=0;for(var b=this.hierarchy.length;a<b;a++){var c=this.data.hierarchy[a].sids,d=this.hierarchy[a];if(this.data.hierarchy[a].keys.length&&c){for(var f=0;f<c.length;f++){var e=c[f],g=this.getNextKeyWith(e,a,0);g&&g.apply(e)}d.matrixAutoUpdate=!1;this.data.hierarchy[a].node.updateMatrix();
d.matrixWorldNeedsUpdate=!0}}};
THREE.KeyFrameAnimation.prototype.play=function(a){this.currentTime=void 0!==a?a:0;if(!1===this.isPlaying){this.isPlaying=!0;var b=this.hierarchy.length,c,d;for(a=0;a<b;a++)c=this.hierarchy[a],d=this.data.hierarchy[a],void 0===d.animationCache&&(d.animationCache={},d.animationCache.prevKey=null,d.animationCache.nextKey=null,d.animationCache.originalMatrix=c.matrix),c=this.data.hierarchy[a].keys,c.length&&(d.animationCache.prevKey=c[0],d.animationCache.nextKey=c[1],this.startTime=Math.min(c[0].time,
this.startTime),this.endTime=Math.max(c[c.length-1].time,this.endTime));this.update(0)}this.isPaused=!1;THREE.AnimationHandler.play(this)};THREE.KeyFrameAnimation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.stop(this);for(var a=0;a<this.data.hierarchy.length;a++){var b=this.hierarchy[a],c=this.data.hierarchy[a];if(void 0!==c.animationCache){var d=c.animationCache.originalMatrix;d.copy(b.matrix);b.matrix=d;delete c.animationCache}}};
THREE.KeyFrameAnimation.prototype.update=function(a){if(!1!==this.isPlaying){this.currentTime+=a*this.timeScale;a=this.data.length;!0===this.loop&&this.currentTime>a&&(this.currentTime%=a);this.currentTime=Math.min(this.currentTime,a);a=0;for(var b=this.hierarchy.length;a<b;a++){var c=this.hierarchy[a],d=this.data.hierarchy[a],f=d.keys,d=d.animationCache;if(f.length){var e=d.prevKey,g=d.nextKey;if(g.time<=this.currentTime){for(;g.time<this.currentTime&&g.index>e.index;)e=g,g=f[e.index+1];d.prevKey=
e;d.nextKey=g}g.time>=this.currentTime?e.interpolate(g,this.currentTime):e.interpolate(g,g.time);this.data.hierarchy[a].node.updateMatrix();c.matrixWorldNeedsUpdate=!0}}}};THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(a,b,c){b=this.data.hierarchy[b].keys;for(c%=b.length;c<b.length;c++)if(b[c].hasTarget(a))return b[c];return b[0]};
THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(a,b,c){b=this.data.hierarchy[b].keys;for(c=0<=c?c:c+b.length;0<=c;c--)if(b[c].hasTarget(a))return b[c];return b[b.length-1]};THREE.MorphAnimation=function(a){this.mesh=a;this.frames=a.morphTargetInfluences.length;this.currentTime=0;this.duration=1E3;this.loop=!0;this.isPlaying=!1};
THREE.MorphAnimation.prototype={play:function(){this.isPlaying=!0},pause:function(){this.isPlaying=!1},update:function(){var a=0,b=0;return function(c){if(!1!==this.isPlaying){this.currentTime+=c;!0===this.loop&&this.currentTime>this.duration&&(this.currentTime%=this.duration);this.currentTime=Math.min(this.currentTime,this.duration);c=this.duration/this.frames;var d=Math.floor(this.currentTime/c);d!=b&&(this.mesh.morphTargetInfluences[a]=0,this.mesh.morphTargetInfluences[b]=1,this.mesh.morphTargetInfluences[d]=
0,a=b,b=d);this.mesh.morphTargetInfluences[d]=this.currentTime%c/c;this.mesh.morphTargetInfluences[a]=1-this.mesh.morphTargetInfluences[d]}}}()};
THREE.BoxGeometry=function(a,b,c,d,f,e){function g(a,b,c,d,e,f,g,q){var v,x=k.widthSegments,t=k.heightSegments,G=e/2,u=f/2,F=k.vertices.length;if("x"===a&&"y"===b||"y"===a&&"x"===b)v="z";else if("x"===a&&"z"===b||"z"===a&&"x"===b)v="y",t=k.depthSegments;else if("z"===a&&"y"===b||"y"===a&&"z"===b)v="x",x=k.depthSegments;var C=x+1,y=t+1,z=e/x,A=f/t,w=new THREE.Vector3;w[v]=0<g?1:-1;for(e=0;e<y;e++)for(f=0;f<C;f++){var I=new THREE.Vector3;I[a]=(f*z-G)*c;I[b]=(e*A-u)*d;I[v]=g;k.vertices.push(I)}for(e=
0;e<t;e++)for(f=0;f<x;f++)u=f+C*e,a=f+C*(e+1),b=f+1+C*(e+1),c=f+1+C*e,d=new THREE.Vector2(f/x,1-e/t),g=new THREE.Vector2(f/x,1-(e+1)/t),v=new THREE.Vector2((f+1)/x,1-(e+1)/t),G=new THREE.Vector2((f+1)/x,1-e/t),u=new THREE.Face3(u+F,a+F,c+F),u.normal.copy(w),u.vertexNormals.push(w.clone(),w.clone(),w.clone()),u.materialIndex=q,k.faces.push(u),k.faceVertexUvs[0].push([d,g,G]),u=new THREE.Face3(a+F,b+F,c+F),u.normal.copy(w),u.vertexNormals.push(w.clone(),w.clone(),w.clone()),u.materialIndex=q,k.faces.push(u),
k.faceVertexUvs[0].push([g.clone(),v,G.clone()])}THREE.Geometry.call(this);this.type="BoxGeometry";this.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:f,depthSegments:e};this.widthSegments=d||1;this.heightSegments=f||1;this.depthSegments=e||1;var k=this;d=a/2;f=b/2;e=c/2;g("z","y",-1,-1,c,b,d,0);g("z","y",1,-1,c,b,-d,1);g("x","z",1,1,a,c,f,2);g("x","z",1,-1,a,c,-f,3);g("x","y",1,-1,a,b,e,4);g("x","y",-1,-1,a,b,-e,5);this.mergeVertices()};THREE.BoxGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.CircleGeometry=function(a,b,c,d){THREE.Geometry.call(this);this.type="CircleGeometry";this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d};a=a||50;b=void 0!==b?Math.max(3,b):8;c=void 0!==c?c:0;d=void 0!==d?d:2*Math.PI;var f,e=[];f=new THREE.Vector3;var g=new THREE.Vector2(.5,.5);this.vertices.push(f);e.push(g);for(f=0;f<=b;f++){var k=new THREE.Vector3,l=c+f/b*d;k.x=a*Math.cos(l);k.y=a*Math.sin(l);this.vertices.push(k);e.push(new THREE.Vector2((k.x/a+1)/2,(k.y/a+1)/2))}c=new THREE.Vector3(0,
0,1);for(f=1;f<=b;f++)this.faces.push(new THREE.Face3(f,f+1,0,[c.clone(),c.clone(),c.clone()])),this.faceVertexUvs[0].push([e[f].clone(),e[f+1].clone(),g.clone()]);this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)};THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CubeGeometry=function(a,b,c,d,f,e){console.warn("THREE.CubeGeometry has been renamed to THREE.BoxGeometry.");return new THREE.BoxGeometry(a,b,c,d,f,e)};
THREE.CylinderGeometry=function(a,b,c,d,f,e){THREE.Geometry.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:f,openEnded:e};a=void 0!==a?a:20;b=void 0!==b?b:20;c=void 0!==c?c:100;d=d||8;f=f||1;e=void 0!==e?e:!1;var g=c/2,k,l,m=[],n=[];for(l=0;l<=f;l++){var h=[],p=[],r=l/f,s=r*(b-a)+a;for(k=0;k<=d;k++){var q=k/d,v=new THREE.Vector3;v.x=s*Math.sin(q*Math.PI*2);v.y=-r*c+g;v.z=s*Math.cos(q*Math.PI*2);this.vertices.push(v);h.push(this.vertices.length-
1);p.push(new THREE.Vector2(q,1-r))}m.push(h);n.push(p)}c=(b-a)/c;for(k=0;k<d;k++)for(0!==a?(h=this.vertices[m[0][k]].clone(),p=this.vertices[m[0][k+1]].clone()):(h=this.vertices[m[1][k]].clone(),p=this.vertices[m[1][k+1]].clone()),h.setY(Math.sqrt(h.x*h.x+h.z*h.z)*c).normalize(),p.setY(Math.sqrt(p.x*p.x+p.z*p.z)*c).normalize(),l=0;l<f;l++){var r=m[l][k],s=m[l+1][k],q=m[l+1][k+1],v=m[l][k+1],x=h.clone(),t=h.clone(),G=p.clone(),u=p.clone(),F=n[l][k].clone(),C=n[l+1][k].clone(),y=n[l+1][k+1].clone(),
z=n[l][k+1].clone();this.faces.push(new THREE.Face3(r,s,v,[x,t,u]));this.faceVertexUvs[0].push([F,C,z]);this.faces.push(new THREE.Face3(s,q,v,[t.clone(),G,u.clone()]));this.faceVertexUvs[0].push([C.clone(),y,z.clone()])}if(!1===e&&0<a)for(this.vertices.push(new THREE.Vector3(0,g,0)),k=0;k<d;k++)r=m[0][k],s=m[0][k+1],q=this.vertices.length-1,x=new THREE.Vector3(0,1,0),t=new THREE.Vector3(0,1,0),G=new THREE.Vector3(0,1,0),F=n[0][k].clone(),C=n[0][k+1].clone(),y=new THREE.Vector2(C.x,0),this.faces.push(new THREE.Face3(r,
s,q,[x,t,G])),this.faceVertexUvs[0].push([F,C,y]);if(!1===e&&0<b)for(this.vertices.push(new THREE.Vector3(0,-g,0)),k=0;k<d;k++)r=m[l][k+1],s=m[l][k],q=this.vertices.length-1,x=new THREE.Vector3(0,-1,0),t=new THREE.Vector3(0,-1,0),G=new THREE.Vector3(0,-1,0),F=n[l][k+1].clone(),C=n[l][k].clone(),y=new THREE.Vector2(C.x,1),this.faces.push(new THREE.Face3(r,s,q,[x,t,G])),this.faceVertexUvs[0].push([F,C,y]);this.computeFaceNormals()};THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ExtrudeGeometry=function(a,b){"undefined"!==typeof a&&(THREE.Geometry.call(this),this.type="ExtrudeGeometry",a=a instanceof Array?a:[a],this.addShapeList(a,b),this.computeFaceNormals())};THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry.prototype.addShapeList=function(a,b){for(var c=a.length,d=0;d<c;d++)this.addShape(a[d],b)};
THREE.ExtrudeGeometry.prototype.addShape=function(a,b){function c(a,b,c){b||console.log("die");return b.clone().multiplyScalar(c).add(a)}function d(a,b,c){var d=1,d=a.x-b.x,e=a.y-b.y,f=c.x-a.x,g=c.y-a.y,h=d*d+e*e;if(1E-10<Math.abs(d*g-e*f)){var k=Math.sqrt(h),l=Math.sqrt(f*f+g*g),h=b.x-e/k;b=b.y+d/k;f=((c.x-g/l-h)*g-(c.y+f/l-b)*f)/(d*g-e*f);c=h+d*f-a.x;a=b+e*f-a.y;d=c*c+a*a;if(2>=d)return new THREE.Vector2(c,a);d=Math.sqrt(d/2)}else a=!1,1E-10<d?1E-10<f&&(a=!0):-1E-10>d?-1E-10>f&&(a=!0):Math.sign(e)==
Math.sign(g)&&(a=!0),a?(c=-e,a=d,d=Math.sqrt(h)):(c=d,a=e,d=Math.sqrt(h/2));return new THREE.Vector2(c/d,a/d)}function f(c,d){var e,f;for(D=c.length;0<=--D;){e=D;f=D-1;0>f&&(f=c.length-1);for(var g=0,h=r+2*n,g=0;g<h;g++){var k=M*g,l=M*(g+1),m=d+e+k,k=d+f+k,q=d+f+l,l=d+e+l,p=c,s=g,u=h,v=e,x=f,m=m+B,k=k+B,q=q+B,l=l+B;I.faces.push(new THREE.Face3(m,k,l,null,null,t));I.faces.push(new THREE.Face3(k,q,l,null,null,t));m=G.generateSideWallUV(I,a,p,b,m,k,q,l,s,u,v,x);I.faceVertexUvs[0].push([m[0],m[1],m[3]]);
I.faceVertexUvs[0].push([m[1],m[2],m[3]])}}}function e(a,b,c){I.vertices.push(new THREE.Vector3(a,b,c))}function g(c,d,e,f){c+=B;d+=B;e+=B;I.faces.push(new THREE.Face3(c,d,e,null,null,x));c=f?G.generateBottomUV(I,a,b,c,d,e):G.generateTopUV(I,a,b,c,d,e);I.faceVertexUvs[0].push(c)}var k=void 0!==b.amount?b.amount:100,l=void 0!==b.bevelThickness?b.bevelThickness:6,m=void 0!==b.bevelSize?b.bevelSize:l-2,n=void 0!==b.bevelSegments?b.bevelSegments:3,h=void 0!==b.bevelEnabled?b.bevelEnabled:!0,p=void 0!==
b.curveSegments?b.curveSegments:12,r=void 0!==b.steps?b.steps:1,s=b.extrudePath,q,v=!1,x=b.material,t=b.extrudeMaterial,G=void 0!==b.UVGenerator?b.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator,u,F,C,y;s&&(q=s.getSpacedPoints(r),v=!0,h=!1,u=void 0!==b.frames?b.frames:new THREE.TubeGeometry.FrenetFrames(s,r,!1),F=new THREE.Vector3,C=new THREE.Vector3,y=new THREE.Vector3);h||(m=l=n=0);var z,A,w,I=this,B=this.vertices.length,s=a.extractPoints(p),p=s.shape,E=s.holes;if(s=!THREE.Shape.Utils.isClockWise(p)){p=
p.reverse();A=0;for(w=E.length;A<w;A++)z=E[A],THREE.Shape.Utils.isClockWise(z)&&(E[A]=z.reverse());s=!1}var L=THREE.Shape.Utils.triangulateShape(p,E),K=p;A=0;for(w=E.length;A<w;A++)z=E[A],p=p.concat(z);var H,O,J,Q,N,M=p.length,P,S=L.length,s=[],D=0;J=K.length;H=J-1;for(O=D+1;D<J;D++,H++,O++)H===J&&(H=0),O===J&&(O=0),s[D]=d(K[D],K[H],K[O]);var U=[],R,T=s.concat();A=0;for(w=E.length;A<w;A++){z=E[A];R=[];D=0;J=z.length;H=J-1;for(O=D+1;D<J;D++,H++,O++)H===J&&(H=0),O===J&&(O=0),R[D]=d(z[D],z[H],z[O]);
U.push(R);T=T.concat(R)}for(H=0;H<n;H++){J=H/n;Q=l*(1-J);O=m*Math.sin(J*Math.PI/2);D=0;for(J=K.length;D<J;D++)N=c(K[D],s[D],O),e(N.x,N.y,-Q);A=0;for(w=E.length;A<w;A++)for(z=E[A],R=U[A],D=0,J=z.length;D<J;D++)N=c(z[D],R[D],O),e(N.x,N.y,-Q)}O=m;for(D=0;D<M;D++)N=h?c(p[D],T[D],O):p[D],v?(C.copy(u.normals[0]).multiplyScalar(N.x),F.copy(u.binormals[0]).multiplyScalar(N.y),y.copy(q[0]).add(C).add(F),e(y.x,y.y,y.z)):e(N.x,N.y,0);for(J=1;J<=r;J++)for(D=0;D<M;D++)N=h?c(p[D],T[D],O):p[D],v?(C.copy(u.normals[J]).multiplyScalar(N.x),
F.copy(u.binormals[J]).multiplyScalar(N.y),y.copy(q[J]).add(C).add(F),e(y.x,y.y,y.z)):e(N.x,N.y,k/r*J);for(H=n-1;0<=H;H--){J=H/n;Q=l*(1-J);O=m*Math.sin(J*Math.PI/2);D=0;for(J=K.length;D<J;D++)N=c(K[D],s[D],O),e(N.x,N.y,k+Q);A=0;for(w=E.length;A<w;A++)for(z=E[A],R=U[A],D=0,J=z.length;D<J;D++)N=c(z[D],R[D],O),v?e(N.x,N.y+q[r-1].y,q[r-1].x+Q):e(N.x,N.y,k+Q)}(function(){if(h){var a;a=0*M;for(D=0;D<S;D++)P=L[D],g(P[2]+a,P[1]+a,P[0]+a,!0);a=r+2*n;a*=M;for(D=0;D<S;D++)P=L[D],g(P[0]+a,P[1]+a,P[2]+a,!1)}else{for(D=
0;D<S;D++)P=L[D],g(P[2],P[1],P[0],!0);for(D=0;D<S;D++)P=L[D],g(P[0]+M*r,P[1]+M*r,P[2]+M*r,!1)}})();(function(){var a=0;f(K,a);a+=K.length;A=0;for(w=E.length;A<w;A++)z=E[A],f(z,a),a+=z.length})()};
THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(a,b,c,d,f,e){b=a.vertices[d];f=a.vertices[f];a=a.vertices[e];return[new THREE.Vector2(b.x,b.y),new THREE.Vector2(f.x,f.y),new THREE.Vector2(a.x,a.y)]},generateBottomUV:function(a,b,c,d,f,e){return this.generateTopUV(a,b,c,d,f,e)},generateSideWallUV:function(a,b,c,d,f,e,g,k,l,m,n,h){b=a.vertices[f];e=a.vertices[e];g=a.vertices[g];a=a.vertices[k];return.01>Math.abs(b.y-e.y)?[new THREE.Vector2(b.x,1-b.z),new THREE.Vector2(e.x,1-e.z),new THREE.Vector2(g.x,
1-g.z),new THREE.Vector2(a.x,1-a.z)]:[new THREE.Vector2(b.y,1-b.z),new THREE.Vector2(e.y,1-e.z),new THREE.Vector2(g.y,1-g.z),new THREE.Vector2(a.y,1-a.z)]}};THREE.ShapeGeometry=function(a,b){THREE.Geometry.call(this);this.type="ShapeGeometry";!1===a instanceof Array&&(a=[a]);this.addShapeList(a,b);this.computeFaceNormals()};THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ShapeGeometry.prototype.addShapeList=function(a,b){for(var c=0,d=a.length;c<d;c++)this.addShape(a[c],b);return this};
THREE.ShapeGeometry.prototype.addShape=function(a,b){void 0===b&&(b={});var c=b.material,d=void 0===b.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:b.UVGenerator,f,e,g,k=this.vertices.length;f=a.extractPoints(void 0!==b.curveSegments?b.curveSegments:12);var l=f.shape,m=f.holes;if(!THREE.Shape.Utils.isClockWise(l))for(l=l.reverse(),f=0,e=m.length;f<e;f++)g=m[f],THREE.Shape.Utils.isClockWise(g)&&(m[f]=g.reverse());var n=THREE.Shape.Utils.triangulateShape(l,m);f=0;for(e=m.length;f<e;f++)g=m[f],
l=l.concat(g);m=l.length;e=n.length;for(f=0;f<m;f++)g=l[f],this.vertices.push(new THREE.Vector3(g.x,g.y,0));for(f=0;f<e;f++)m=n[f],l=m[0]+k,g=m[1]+k,m=m[2]+k,this.faces.push(new THREE.Face3(l,g,m,null,null,c)),this.faceVertexUvs[0].push(d.generateBottomUV(this,a,b,l,g,m))};
THREE.LatheGeometry=function(a,b,c,d){THREE.Geometry.call(this);this.type="LatheGeometry";this.parameters={points:a,segments:b,phiStart:c,phiLength:d};b=b||12;c=c||0;d=d||2*Math.PI;for(var f=1/(a.length-1),e=1/b,g=0,k=b;g<=k;g++)for(var l=c+g*e*d,m=Math.cos(l),n=Math.sin(l),l=0,h=a.length;l<h;l++){var p=a[l],r=new THREE.Vector3;r.x=m*p.x-n*p.y;r.y=n*p.x+m*p.y;r.z=p.z;this.vertices.push(r)}c=a.length;g=0;for(k=b;g<k;g++)for(l=0,h=a.length-1;l<h;l++){b=n=l+c*g;d=n+c;var m=n+1+c,n=n+1,p=g*e,r=l*f,s=
p+e,q=r+f;this.faces.push(new THREE.Face3(b,d,n));this.faceVertexUvs[0].push([new THREE.Vector2(p,r),new THREE.Vector2(s,r),new THREE.Vector2(p,q)]);this.faces.push(new THREE.Face3(d,m,n));this.faceVertexUvs[0].push([new THREE.Vector2(s,r),new THREE.Vector2(s,q),new THREE.Vector2(p,q)])}this.mergeVertices();this.computeFaceNormals();this.computeVertexNormals()};THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.PlaneGeometry=function(a,b,c,d){console.info("THREE.PlaneGeometry: Consider using THREE.PlaneBufferGeometry for lower memory footprint.");THREE.Geometry.call(this);this.type="PlaneGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};this.fromBufferGeometry(new THREE.PlaneBufferGeometry(a,b,c,d))};THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.PlaneBufferGeometry=function(a,b,c,d){THREE.BufferGeometry.call(this);this.type="PlaneBufferGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};var f=a/2,e=b/2;c=c||1;d=d||1;var g=c+1,k=d+1,l=a/c,m=b/d;b=new Float32Array(g*k*3);a=new Float32Array(g*k*3);for(var n=new Float32Array(g*k*2),h=0,p=0,r=0;r<k;r++)for(var s=r*m-e,q=0;q<g;q++)b[h]=q*l-f,b[h+1]=-s,a[h+2]=1,n[p]=q/c,n[p+1]=1-r/d,h+=3,p+=2;h=0;f=new (65535<b.length/3?Uint32Array:Uint16Array)(c*d*6);for(r=0;r<d;r++)for(q=
0;q<c;q++)e=q+g*(r+1),k=q+1+g*(r+1),l=q+1+g*r,f[h]=q+g*r,f[h+1]=e,f[h+2]=l,f[h+3]=e,f[h+4]=k,f[h+5]=l,h+=6;this.addAttribute("index",new THREE.BufferAttribute(f,1));this.addAttribute("position",new THREE.BufferAttribute(b,3));this.addAttribute("normal",new THREE.BufferAttribute(a,3));this.addAttribute("uv",new THREE.BufferAttribute(n,2))};THREE.PlaneBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);
THREE.RingGeometry=function(a,b,c,d,f,e){THREE.Geometry.call(this);this.type="RingGeometry";this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:f,thetaLength:e};a=a||0;b=b||50;f=void 0!==f?f:0;e=void 0!==e?e:2*Math.PI;c=void 0!==c?Math.max(3,c):8;d=void 0!==d?Math.max(1,d):8;var g,k=[],l=a,m=(b-a)/d;for(a=0;a<d+1;a++){for(g=0;g<c+1;g++){var n=new THREE.Vector3,h=f+g/c*e;n.x=l*Math.cos(h);n.y=l*Math.sin(h);this.vertices.push(n);k.push(new THREE.Vector2((n.x/b+1)/2,
(n.y/b+1)/2))}l+=m}b=new THREE.Vector3(0,0,1);for(a=0;a<d;a++)for(f=a*(c+1),g=0;g<c;g++)e=h=g+f,m=h+c+1,n=h+c+2,this.faces.push(new THREE.Face3(e,m,n,[b.clone(),b.clone(),b.clone()])),this.faceVertexUvs[0].push([k[e].clone(),k[m].clone(),k[n].clone()]),e=h,m=h+c+2,n=h+1,this.faces.push(new THREE.Face3(e,m,n,[b.clone(),b.clone(),b.clone()])),this.faceVertexUvs[0].push([k[e].clone(),k[m].clone(),k[n].clone()]);this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,l)};
THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.SphereGeometry=function(a,b,c,d,f,e,g){THREE.Geometry.call(this);this.type="SphereGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:f,thetaStart:e,thetaLength:g};a=a||50;b=Math.max(3,Math.floor(b)||8);c=Math.max(2,Math.floor(c)||6);d=void 0!==d?d:0;f=void 0!==f?f:2*Math.PI;e=void 0!==e?e:0;g=void 0!==g?g:Math.PI;var k,l,m=[],n=[];for(l=0;l<=c;l++){var h=[],p=[];for(k=0;k<=b;k++){var r=k/b,s=l/c,q=new THREE.Vector3;q.x=-a*Math.cos(d+r*f)*Math.sin(e+s*g);
q.y=a*Math.cos(e+s*g);q.z=a*Math.sin(d+r*f)*Math.sin(e+s*g);this.vertices.push(q);h.push(this.vertices.length-1);p.push(new THREE.Vector2(r,1-s))}m.push(h);n.push(p)}for(l=0;l<c;l++)for(k=0;k<b;k++){d=m[l][k+1];f=m[l][k];e=m[l+1][k];g=m[l+1][k+1];var h=this.vertices[d].clone().normalize(),p=this.vertices[f].clone().normalize(),r=this.vertices[e].clone().normalize(),s=this.vertices[g].clone().normalize(),q=n[l][k+1].clone(),v=n[l][k].clone(),x=n[l+1][k].clone(),t=n[l+1][k+1].clone();Math.abs(this.vertices[d].y)===
a?(q.x=(q.x+v.x)/2,this.faces.push(new THREE.Face3(d,e,g,[h,r,s])),this.faceVertexUvs[0].push([q,x,t])):Math.abs(this.vertices[e].y)===a?(x.x=(x.x+t.x)/2,this.faces.push(new THREE.Face3(d,f,e,[h,p,r])),this.faceVertexUvs[0].push([q,v,x])):(this.faces.push(new THREE.Face3(d,f,g,[h,p,s])),this.faceVertexUvs[0].push([q,v,t]),this.faces.push(new THREE.Face3(f,e,g,[p.clone(),r,s.clone()])),this.faceVertexUvs[0].push([v.clone(),x,t.clone()]))}this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,
a)};THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TextGeometry=function(a,b){b=b||{};var c=THREE.FontUtils.generateShapes(a,b);b.amount=void 0!==b.height?b.height:50;void 0===b.bevelThickness&&(b.bevelThickness=10);void 0===b.bevelSize&&(b.bevelSize=8);void 0===b.bevelEnabled&&(b.bevelEnabled=!1);THREE.ExtrudeGeometry.call(this,c,b);this.type="TextGeometry"};THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype);
THREE.TorusGeometry=function(a,b,c,d,f){THREE.Geometry.call(this);this.type="TorusGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:f};a=a||100;b=b||40;c=c||8;d=d||6;f=f||2*Math.PI;for(var e=new THREE.Vector3,g=[],k=[],l=0;l<=c;l++)for(var m=0;m<=d;m++){var n=m/d*f,h=l/c*Math.PI*2;e.x=a*Math.cos(n);e.y=a*Math.sin(n);var p=new THREE.Vector3;p.x=(a+b*Math.cos(h))*Math.cos(n);p.y=(a+b*Math.cos(h))*Math.sin(n);p.z=b*Math.sin(h);this.vertices.push(p);g.push(new THREE.Vector2(m/
d,l/c));k.push(p.clone().sub(e).normalize())}for(l=1;l<=c;l++)for(m=1;m<=d;m++)a=(d+1)*l+m-1,b=(d+1)*(l-1)+m-1,f=(d+1)*(l-1)+m,e=(d+1)*l+m,n=new THREE.Face3(a,b,e,[k[a].clone(),k[b].clone(),k[e].clone()]),this.faces.push(n),this.faceVertexUvs[0].push([g[a].clone(),g[b].clone(),g[e].clone()]),n=new THREE.Face3(b,f,e,[k[b].clone(),k[f].clone(),k[e].clone()]),this.faces.push(n),this.faceVertexUvs[0].push([g[b].clone(),g[f].clone(),g[e].clone()]);this.computeFaceNormals()};
THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TorusKnotGeometry=function(a,b,c,d,f,e,g){function k(a,b,c,d,e){var f=Math.cos(a),g=Math.sin(a);a*=b/c;b=Math.cos(a);f*=d*(2+b)*.5;g=d*(2+b)*g*.5;d=e*d*Math.sin(a)*.5;return new THREE.Vector3(f,g,d)}THREE.Geometry.call(this);this.type="TorusKnotGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,p:f,q:e,heightScale:g};a=a||100;b=b||40;c=c||64;d=d||8;f=f||2;e=e||3;g=g||1;for(var l=Array(c),m=new THREE.Vector3,n=new THREE.Vector3,h=new THREE.Vector3,p=0;p<c;++p){l[p]=
Array(d);var r=p/c*2*f*Math.PI,s=k(r,e,f,a,g),r=k(r+.01,e,f,a,g);m.subVectors(r,s);n.addVectors(r,s);h.crossVectors(m,n);n.crossVectors(h,m);h.normalize();n.normalize();for(r=0;r<d;++r){var q=r/d*2*Math.PI,v=-b*Math.cos(q),q=b*Math.sin(q),x=new THREE.Vector3;x.x=s.x+v*n.x+q*h.x;x.y=s.y+v*n.y+q*h.y;x.z=s.z+v*n.z+q*h.z;l[p][r]=this.vertices.push(x)-1}}for(p=0;p<c;++p)for(r=0;r<d;++r)f=(p+1)%c,e=(r+1)%d,a=l[p][r],b=l[f][r],f=l[f][e],e=l[p][e],g=new THREE.Vector2(p/c,r/d),m=new THREE.Vector2((p+1)/c,
r/d),n=new THREE.Vector2((p+1)/c,(r+1)/d),h=new THREE.Vector2(p/c,(r+1)/d),this.faces.push(new THREE.Face3(a,b,e)),this.faceVertexUvs[0].push([g,m,h]),this.faces.push(new THREE.Face3(b,f,e)),this.faceVertexUvs[0].push([m.clone(),n,h.clone()]);this.computeFaceNormals();this.computeVertexNormals()};THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TubeGeometry=function(a,b,c,d,f){THREE.Geometry.call(this);this.type="TubeGeometry";this.parameters={path:a,segments:b,radius:c,radialSegments:d,closed:f};b=b||64;c=c||1;d=d||8;f=f||!1;var e=[],g,k,l=b+1,m,n,h,p,r=new THREE.Vector3,s,q,v;s=new THREE.TubeGeometry.FrenetFrames(a,b,f);q=s.normals;v=s.binormals;this.tangents=s.tangents;this.normals=q;this.binormals=v;for(s=0;s<l;s++)for(e[s]=[],m=s/(l-1),p=a.getPointAt(m),g=q[s],k=v[s],m=0;m<d;m++)n=m/d*2*Math.PI,h=-c*Math.cos(n),n=c*Math.sin(n),
r.copy(p),r.x+=h*g.x+n*k.x,r.y+=h*g.y+n*k.y,r.z+=h*g.z+n*k.z,e[s][m]=this.vertices.push(new THREE.Vector3(r.x,r.y,r.z))-1;for(s=0;s<b;s++)for(m=0;m<d;m++)l=f?(s+1)%b:s+1,r=(m+1)%d,a=e[s][m],c=e[l][m],l=e[l][r],r=e[s][r],q=new THREE.Vector2(s/b,m/d),v=new THREE.Vector2((s+1)/b,m/d),g=new THREE.Vector2((s+1)/b,(m+1)/d),k=new THREE.Vector2(s/b,(m+1)/d),this.faces.push(new THREE.Face3(a,c,r)),this.faceVertexUvs[0].push([q,v,k]),this.faces.push(new THREE.Face3(c,l,r)),this.faceVertexUvs[0].push([v.clone(),
g,k.clone()]);this.computeFaceNormals();this.computeVertexNormals()};THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TubeGeometry.FrenetFrames=function(a,b,c){new THREE.Vector3;var d=new THREE.Vector3;new THREE.Vector3;var f=[],e=[],g=[],k=new THREE.Vector3,l=new THREE.Matrix4;b+=1;var m,n,h;this.tangents=f;this.normals=e;this.binormals=g;for(m=0;m<b;m++)n=m/(b-1),f[m]=a.getTangentAt(n),f[m].normalize();e[0]=new THREE.Vector3;g[0]=new THREE.Vector3;a=Number.MAX_VALUE;m=Math.abs(f[0].x);n=Math.abs(f[0].y);h=Math.abs(f[0].z);m<=a&&(a=m,d.set(1,0,0));n<=a&&(a=n,d.set(0,1,0));h<=a&&d.set(0,0,1);k.crossVectors(f[0],
d).normalize();e[0].crossVectors(f[0],k);g[0].crossVectors(f[0],e[0]);for(m=1;m<b;m++)e[m]=e[m-1].clone(),g[m]=g[m-1].clone(),k.crossVectors(f[m-1],f[m]),1E-4<k.length()&&(k.normalize(),d=Math.acos(THREE.Math.clamp(f[m-1].dot(f[m]),-1,1)),e[m].applyMatrix4(l.makeRotationAxis(k,d))),g[m].crossVectors(f[m],e[m]);if(c)for(d=Math.acos(THREE.Math.clamp(e[0].dot(e[b-1]),-1,1)),d/=b-1,0<f[0].dot(k.crossVectors(e[0],e[b-1]))&&(d=-d),m=1;m<b;m++)e[m].applyMatrix4(l.makeRotationAxis(f[m],d*m)),g[m].crossVectors(f[m],
e[m])};
THREE.PolyhedronGeometry=function(a,b,c,d){function f(a){var b=a.normalize().clone();b.index=l.vertices.push(b)-1;var c=Math.atan2(a.z,-a.x)/2/Math.PI+.5;a=Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5;b.uv=new THREE.Vector2(c,1-a);return b}function e(a,b,c){var d=new THREE.Face3(a.index,b.index,c.index,[a.clone(),b.clone(),c.clone()]);l.faces.push(d);v.copy(a).add(b).add(c).divideScalar(3);d=Math.atan2(v.z,-v.x);l.faceVertexUvs[0].push([k(a.uv,a,d),k(b.uv,b,d),k(c.uv,c,d)])}function g(a,b){var c=
Math.pow(2,b);Math.pow(4,b);for(var d=f(l.vertices[a.a]),g=f(l.vertices[a.b]),h=f(l.vertices[a.c]),k=[],m=0;m<=c;m++){k[m]=[];for(var n=f(d.clone().lerp(h,m/c)),r=f(g.clone().lerp(h,m/c)),q=c-m,p=0;p<=q;p++)k[m][p]=0==p&&m==c?n:f(n.clone().lerp(r,p/q))}for(m=0;m<c;m++)for(p=0;p<2*(c-m)-1;p++)d=Math.floor(p/2),0==p%2?e(k[m][d+1],k[m+1][d],k[m][d]):e(k[m][d+1],k[m+1][d+1],k[m+1][d])}function k(a,b,c){0>c&&1===a.x&&(a=new THREE.Vector2(a.x-1,a.y));0===b.x&&0===b.z&&(a=new THREE.Vector2(c/2/Math.PI+.5,
a.y));return a.clone()}THREE.Geometry.call(this);this.type="PolyhedronGeometry";this.parameters={vertices:a,indices:b,radius:c,detail:d};c=c||1;d=d||0;for(var l=this,m=0,n=a.length;m<n;m+=3)f(new THREE.Vector3(a[m],a[m+1],a[m+2]));a=this.vertices;for(var h=[],p=m=0,n=b.length;m<n;m+=3,p++){var r=a[b[m]],s=a[b[m+1]],q=a[b[m+2]];h[p]=new THREE.Face3(r.index,s.index,q.index,[r.clone(),s.clone(),q.clone()])}for(var v=new THREE.Vector3,m=0,n=h.length;m<n;m++)g(h[m],d);m=0;for(n=this.faceVertexUvs[0].length;m<
n;m++)b=this.faceVertexUvs[0][m],d=b[0].x,a=b[1].x,h=b[2].x,p=Math.max(d,Math.max(a,h)),r=Math.min(d,Math.min(a,h)),.9<p&&.1>r&&(.2>d&&(b[0].x+=1),.2>a&&(b[1].x+=1),.2>h&&(b[2].x+=1));m=0;for(n=this.vertices.length;m<n;m++)this.vertices[m].multiplyScalar(c);this.mergeVertices();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,c)};THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.DodecahedronGeometry=function(a,b){this.parameters={radius:a,detail:b};var c=(1+Math.sqrt(5))/2,d=1/c;THREE.PolyhedronGeometry.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-d,-c,0,-d,c,0,d,-c,0,d,c,-d,-c,0,-d,c,0,d,-c,0,d,c,0,-c,0,-d,c,0,-d,-c,0,d,c,0,d],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,
11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a,b)};THREE.DodecahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.IcosahedronGeometry=function(a,b){var c=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[-1,c,0,1,c,0,-1,-c,0,1,-c,0,0,-1,c,0,1,c,0,-1,-c,0,1,-c,c,0,-1,c,0,1,-c,0,-1,-c,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a,b);this.type="IcosahedronGeometry";this.parameters={radius:a,detail:b}};THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.OctahedronGeometry=function(a,b){this.parameters={radius:a,detail:b};THREE.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,b);this.type="OctahedronGeometry";this.parameters={radius:a,detail:b}};THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TetrahedronGeometry=function(a,b){THREE.PolyhedronGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],a,b);this.type="TetrahedronGeometry";this.parameters={radius:a,detail:b}};THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ParametricGeometry=function(a,b,c){THREE.Geometry.call(this);this.type="ParametricGeometry";this.parameters={func:a,slices:b,stacks:c};var d=this.vertices,f=this.faces,e=this.faceVertexUvs[0],g,k,l,m,n=b+1;for(g=0;g<=c;g++)for(m=g/c,k=0;k<=b;k++)l=k/b,l=a(l,m),d.push(l);var h,p,r,s;for(g=0;g<c;g++)for(k=0;k<b;k++)a=g*n+k,d=g*n+k+1,m=(g+1)*n+k+1,l=(g+1)*n+k,h=new THREE.Vector2(k/b,g/c),p=new THREE.Vector2((k+1)/b,g/c),r=new THREE.Vector2((k+1)/b,(g+1)/c),s=new THREE.Vector2(k/b,(g+1)/c),f.push(new THREE.Face3(a,
d,l)),e.push([h,p,s]),f.push(new THREE.Face3(d,m,l)),e.push([p.clone(),r,s.clone()]);this.computeFaceNormals();this.computeVertexNormals()};THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.AxisHelper=function(a){a=a||1;var b=new Float32Array([0,0,0,a,0,0,0,0,0,0,a,0,0,0,0,0,0,a]),c=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]);a=new THREE.BufferGeometry;a.addAttribute("position",new THREE.BufferAttribute(b,3));a.addAttribute("color",new THREE.BufferAttribute(c,3));b=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,a,b,THREE.LinePieces)};THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype);
THREE.ArrowHelper=function(){var a=new THREE.Geometry;a.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0));var b=new THREE.CylinderGeometry(0,.5,1,5,1);b.applyMatrix((new THREE.Matrix4).makeTranslation(0,-.5,0));return function(c,d,f,e,g,k){THREE.Object3D.call(this);void 0===e&&(e=16776960);void 0===f&&(f=1);void 0===g&&(g=.2*f);void 0===k&&(k=.2*g);this.position.copy(d);this.line=new THREE.Line(a,new THREE.LineBasicMaterial({color:e}));this.line.matrixAutoUpdate=!1;this.add(this.line);
this.cone=new THREE.Mesh(b,new THREE.MeshBasicMaterial({color:e}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(c);this.setLength(f,g,k)}}();THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.ArrowHelper.prototype.setDirection=function(){var a=new THREE.Vector3,b;return function(c){.99999<c.y?this.quaternion.set(0,0,0,1):-.99999>c.y?this.quaternion.set(1,0,0,0):(a.set(c.z,0,-c.x).normalize(),b=Math.acos(c.y),this.quaternion.setFromAxisAngle(a,b))}}();
THREE.ArrowHelper.prototype.setLength=function(a,b,c){void 0===b&&(b=.2*a);void 0===c&&(c=.2*b);this.line.scale.set(1,a,1);this.line.updateMatrix();this.cone.scale.set(c,b,c);this.cone.position.y=a;this.cone.updateMatrix()};THREE.ArrowHelper.prototype.setColor=function(a){this.line.material.color.set(a);this.cone.material.color.set(a)};
THREE.BoxHelper=function(a){var b=new THREE.BufferGeometry;b.addAttribute("position",new THREE.BufferAttribute(new Float32Array(72),3));THREE.Line.call(this,b,new THREE.LineBasicMaterial({color:16776960}),THREE.LinePieces);void 0!==a&&this.update(a)};THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype);
THREE.BoxHelper.prototype.update=function(a){var b=a.geometry;null===b.boundingBox&&b.computeBoundingBox();var c=b.boundingBox.min,b=b.boundingBox.max,d=this.geometry.attributes.position.array;d[0]=b.x;d[1]=b.y;d[2]=b.z;d[3]=c.x;d[4]=b.y;d[5]=b.z;d[6]=c.x;d[7]=b.y;d[8]=b.z;d[9]=c.x;d[10]=c.y;d[11]=b.z;d[12]=c.x;d[13]=c.y;d[14]=b.z;d[15]=b.x;d[16]=c.y;d[17]=b.z;d[18]=b.x;d[19]=c.y;d[20]=b.z;d[21]=b.x;d[22]=b.y;d[23]=b.z;d[24]=b.x;d[25]=b.y;d[26]=c.z;d[27]=c.x;d[28]=b.y;d[29]=c.z;d[30]=c.x;d[31]=b.y;
d[32]=c.z;d[33]=c.x;d[34]=c.y;d[35]=c.z;d[36]=c.x;d[37]=c.y;d[38]=c.z;d[39]=b.x;d[40]=c.y;d[41]=c.z;d[42]=b.x;d[43]=c.y;d[44]=c.z;d[45]=b.x;d[46]=b.y;d[47]=c.z;d[48]=b.x;d[49]=b.y;d[50]=b.z;d[51]=b.x;d[52]=b.y;d[53]=c.z;d[54]=c.x;d[55]=b.y;d[56]=b.z;d[57]=c.x;d[58]=b.y;d[59]=c.z;d[60]=c.x;d[61]=c.y;d[62]=b.z;d[63]=c.x;d[64]=c.y;d[65]=c.z;d[66]=b.x;d[67]=c.y;d[68]=b.z;d[69]=b.x;d[70]=c.y;d[71]=c.z;this.geometry.attributes.position.needsUpdate=!0;this.geometry.computeBoundingSphere();this.matrix=a.matrixWorld;
this.matrixAutoUpdate=!1};THREE.BoundingBoxHelper=function(a,b){var c=void 0!==b?b:8947848;this.object=a;this.box=new THREE.Box3;THREE.Mesh.call(this,new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:c,wireframe:!0}))};THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object);this.box.size(this.scale);this.box.center(this.position)};
THREE.CameraHelper=function(a){function b(a,b,d){c(a,d);c(b,d)}function c(a,b){d.vertices.push(new THREE.Vector3);d.colors.push(new THREE.Color(b));void 0===e[a]&&(e[a]=[]);e[a].push(d.vertices.length-1)}var d=new THREE.Geometry,f=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),e={};b("n1","n2",16755200);b("n2","n4",16755200);b("n4","n3",16755200);b("n3","n1",16755200);b("f1","f2",16755200);b("f2","f4",16755200);b("f4","f3",16755200);b("f3","f1",16755200);b("n1","f1",16755200);
b("n2","f2",16755200);b("n3","f3",16755200);b("n4","f4",16755200);b("p","n1",16711680);b("p","n2",16711680);b("p","n3",16711680);b("p","n4",16711680);b("u1","u2",43775);b("u2","u3",43775);b("u3","u1",43775);b("c","t",16777215);b("p","c",3355443);b("cn1","cn2",3355443);b("cn3","cn4",3355443);b("cf1","cf2",3355443);b("cf3","cf4",3355443);THREE.Line.call(this,d,f,THREE.LinePieces);this.camera=a;this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=e;this.update()};
THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype);THREE.CameraHelper.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};
THREE.CameraHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Camera;return function(){function c(c,e,g,k){a.set(e,g,k).unproject(b);c=d.pointMap[c];if(void 0!==c)for(e=0,g=c.length;e<g;e++)d.geometry.vertices[c[e]].copy(a)}var d=this;b.projectionMatrix.copy(this.camera.projectionMatrix);c("c",0,0,-1.00001);c("t",0,0,1);c("n1",-1,-1,-1.00001);c("n2",1,-1,-1.00001);c("n3",-1,1,-1.00001);c("n4",1,1,-1.00001);c("f1",-1,-1,1);c("f2",1,-1,1);c("f3",-1,1,1);c("f4",1,1,1);c("u1",.7,
1.1,-1.00001);c("u2",-.7,1.1,-1.00001);c("u3",0,2,-1.00001);c("cf1",-1,0,1);c("cf2",1,0,1);c("cf3",0,-1,1);c("cf4",0,1,1);c("cn1",-1,0,-1.00001);c("cn2",1,0,-1.00001);c("cn3",0,-1,-1.00001);c("cn4",0,1,-1.00001);this.geometry.verticesNeedUpdate=!0}}();
THREE.DirectionalLightHelper=function(a,b){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;b=b||1;var c=new THREE.Geometry;c.vertices.push(new THREE.Vector3(-b,b,0),new THREE.Vector3(b,b,0),new THREE.Vector3(b,-b,0),new THREE.Vector3(-b,-b,0),new THREE.Vector3(-b,b,0));var d=new THREE.LineBasicMaterial({fog:!1});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightPlane=new THREE.Line(c,d);this.add(this.lightPlane);
c=new THREE.Geometry;c.vertices.push(new THREE.Vector3,new THREE.Vector3);d=new THREE.LineBasicMaterial({fog:!1});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine=new THREE.Line(c,d);this.add(this.targetLine);this.update()};THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()};
THREE.DirectionalLightHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(){a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);c.subVectors(b,a);this.lightPlane.lookAt(c);this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine.geometry.vertices[1].copy(c);this.targetLine.geometry.verticesNeedUpdate=!0;this.targetLine.material.color.copy(this.lightPlane.material.color)}}();
THREE.EdgesHelper=function(a,b){var c=void 0!==b?b:16777215,d=[0,0],f={},e=function(a,b){return a-b},g=["a","b","c"],k=new THREE.BufferGeometry,l=a.geometry.clone();l.mergeVertices();l.computeFaceNormals();for(var m=l.vertices,l=l.faces,n=0,h=0,p=l.length;h<p;h++)for(var r=l[h],s=0;3>s;s++){d[0]=r[g[s]];d[1]=r[g[(s+1)%3]];d.sort(e);var q=d.toString();void 0===f[q]?(f[q]={vert1:d[0],vert2:d[1],face1:h,face2:void 0},n++):f[q].face2=h}k.addAttribute("position",new THREE.BufferAttribute(new Float32Array(6*
n),3));d=k.attributes.position.array;e=0;for(q in f)if(g=f[q],void 0===g.face2||.9999>l[g.face1].normal.dot(l[g.face2].normal))n=m[g.vert1],d[e++]=n.x,d[e++]=n.y,d[e++]=n.z,n=m[g.vert2],d[e++]=n.x,d[e++]=n.y,d[e++]=n.z;THREE.Line.call(this,k,new THREE.LineBasicMaterial({color:c}),THREE.LinePieces);this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1};THREE.EdgesHelper.prototype=Object.create(THREE.Line.prototype);
THREE.FaceNormalsHelper=function(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16776960;d=void 0!==d?d:1;b=new THREE.Geometry;c=0;for(var f=this.object.geometry.faces.length;c<f;c++)b.vertices.push(new THREE.Vector3,new THREE.Vector3);THREE.Line.call(this,b,new THREE.LineBasicMaterial({color:a,linewidth:d}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.normalMatrix=new THREE.Matrix3;this.update()};THREE.FaceNormalsHelper.prototype=Object.create(THREE.Line.prototype);
THREE.FaceNormalsHelper.prototype.update=function(){var a=this.geometry.vertices,b=this.object,c=b.geometry.vertices,d=b.geometry.faces,f=b.matrixWorld;b.updateMatrixWorld(!0);this.normalMatrix.getNormalMatrix(f);for(var e=b=0,g=d.length;b<g;b++,e+=2){var k=d[b];a[e].copy(c[k.a]).add(c[k.b]).add(c[k.c]).divideScalar(3).applyMatrix4(f);a[e+1].copy(k.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size).add(a[e])}this.geometry.verticesNeedUpdate=!0;return this};
THREE.GridHelper=function(a,b){var c=new THREE.Geometry,d=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924);this.color2=new THREE.Color(8947848);for(var f=-a;f<=a;f+=b){c.vertices.push(new THREE.Vector3(-a,0,f),new THREE.Vector3(a,0,f),new THREE.Vector3(f,0,-a),new THREE.Vector3(f,0,a));var e=0===f?this.color1:this.color2;c.colors.push(e,e,e,e)}THREE.Line.call(this,c,d,THREE.LinePieces)};THREE.GridHelper.prototype=Object.create(THREE.Line.prototype);
THREE.GridHelper.prototype.setColors=function(a,b){this.color1.set(a);this.color2.set(b);this.geometry.colorsNeedUpdate=!0};
THREE.HemisphereLightHelper=function(a,b,c,d){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.colors=[new THREE.Color,new THREE.Color];a=new THREE.SphereGeometry(b,4,2);a.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(b=0;8>b;b++)a.faces[b].color=this.colors[4>b?0:1];b=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0});this.lightSphere=new THREE.Mesh(a,b);this.add(this.lightSphere);
this.update()};THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose();this.lightSphere.material.dispose()};
THREE.HemisphereLightHelper.prototype.update=function(){var a=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity);this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity);this.lightSphere.lookAt(a.setFromMatrixPosition(this.light.matrixWorld).negate());this.lightSphere.geometry.colorsNeedUpdate=!0}}();
THREE.PointLightHelper=function(a,b){this.light=a;this.light.updateMatrixWorld();var c=new THREE.SphereGeometry(b,12,8),d=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);THREE.Mesh.call(this,c,d);this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=!1};THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.PointLightHelper.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};
THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};
THREE.SkeletonHelper=function(a){this.bones=this.getBoneList(a);for(var b=new THREE.Geometry,c=0;c<this.bones.length;c++)this.bones[c].parent instanceof THREE.Bone&&(b.vertices.push(new THREE.Vector3),b.vertices.push(new THREE.Vector3),b.colors.push(new THREE.Color(0,0,1)),b.colors.push(new THREE.Color(0,1,0)));c=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});THREE.Line.call(this,b,c,THREE.LinePieces);this.root=a;this.matrix=a.matrixWorld;
this.matrixAutoUpdate=!1;this.update()};THREE.SkeletonHelper.prototype=Object.create(THREE.Line.prototype);THREE.SkeletonHelper.prototype.getBoneList=function(a){var b=[];a instanceof THREE.Bone&&b.push(a);for(var c=0;c<a.children.length;c++)b.push.apply(b,this.getBoneList(a.children[c]));return b};
THREE.SkeletonHelper.prototype.update=function(){for(var a=this.geometry,b=(new THREE.Matrix4).getInverse(this.root.matrixWorld),c=new THREE.Matrix4,d=0,f=0;f<this.bones.length;f++){var e=this.bones[f];e.parent instanceof THREE.Bone&&(c.multiplyMatrices(b,e.matrixWorld),a.vertices[d].setFromMatrixPosition(c),c.multiplyMatrices(b,e.parent.matrixWorld),a.vertices[d+1].setFromMatrixPosition(c),d+=2)}a.verticesNeedUpdate=!0;a.computeBoundingSphere()};
THREE.SpotLightHelper=function(a){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;a=new THREE.CylinderGeometry(0,1,1,8,1,!0);a.applyMatrix((new THREE.Matrix4).makeTranslation(0,-.5,0));a.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));var b=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new THREE.Mesh(a,b);this.add(this.cone);this.update()};THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};THREE.SpotLightHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(){var c=this.light.distance?this.light.distance:1E4,d=c*Math.tan(this.light.angle);this.cone.scale.set(d,d,c);a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(b.sub(a));this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}();
THREE.VertexNormalsHelper=function(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;b=void 0!==c?c:16711680;d=void 0!==d?d:1;c=new THREE.Geometry;a=a.geometry.faces;for(var f=0,e=a.length;f<e;f++)for(var g=0,k=a[f].vertexNormals.length;g<k;g++)c.vertices.push(new THREE.Vector3,new THREE.Vector3);THREE.Line.call(this,c,new THREE.LineBasicMaterial({color:b,linewidth:d}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.normalMatrix=new THREE.Matrix3;this.update()};THREE.VertexNormalsHelper.prototype=Object.create(THREE.Line.prototype);
THREE.VertexNormalsHelper.prototype.update=function(a){var b=new THREE.Vector3;return function(a){a=["a","b","c","d"];this.object.updateMatrixWorld(!0);this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var d=this.geometry.vertices,f=this.object.geometry.vertices,e=this.object.geometry.faces,g=this.object.matrixWorld,k=0,l=0,m=e.length;l<m;l++)for(var n=e[l],h=0,p=n.vertexNormals.length;h<p;h++){var r=n.vertexNormals[h];d[k].copy(f[n[a[h]]]).applyMatrix4(g);b.copy(r).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);
b.add(d[k]);k+=1;d[k].copy(b);k+=1}this.geometry.verticesNeedUpdate=!0;return this}}();
THREE.VertexTangentsHelper=function(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;b=void 0!==c?c:255;d=void 0!==d?d:1;c=new THREE.Geometry;a=a.geometry.faces;for(var f=0,e=a.length;f<e;f++)for(var g=0,k=a[f].vertexTangents.length;g<k;g++)c.vertices.push(new THREE.Vector3),c.vertices.push(new THREE.Vector3);THREE.Line.call(this,c,new THREE.LineBasicMaterial({color:b,linewidth:d}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.update()};THREE.VertexTangentsHelper.prototype=Object.create(THREE.Line.prototype);
THREE.VertexTangentsHelper.prototype.update=function(a){var b=new THREE.Vector3;return function(a){a=["a","b","c","d"];this.object.updateMatrixWorld(!0);for(var d=this.geometry.vertices,f=this.object.geometry.vertices,e=this.object.geometry.faces,g=this.object.matrixWorld,k=0,l=0,m=e.length;l<m;l++)for(var n=e[l],h=0,p=n.vertexTangents.length;h<p;h++){var r=n.vertexTangents[h];d[k].copy(f[n[a[h]]]).applyMatrix4(g);b.copy(r).transformDirection(g).multiplyScalar(this.size);b.add(d[k]);k+=1;d[k].copy(b);
k+=1}this.geometry.verticesNeedUpdate=!0;return this}}();
THREE.WireframeHelper=function(a,b){var c=void 0!==b?b:16777215,d=[0,0],f={},e=function(a,b){return a-b},g=["a","b","c"],k=new THREE.BufferGeometry;if(a.geometry instanceof THREE.Geometry){for(var l=a.geometry.vertices,m=a.geometry.faces,n=0,h=new Uint32Array(6*m.length),p=0,r=m.length;p<r;p++)for(var s=m[p],q=0;3>q;q++){d[0]=s[g[q]];d[1]=s[g[(q+1)%3]];d.sort(e);var v=d.toString();void 0===f[v]&&(h[2*n]=d[0],h[2*n+1]=d[1],f[v]=!0,n++)}d=new Float32Array(6*n);p=0;for(r=n;p<r;p++)for(q=0;2>q;q++)n=
l[h[2*p+q]],g=6*p+3*q,d[g+0]=n.x,d[g+1]=n.y,d[g+2]=n.z;k.addAttribute("position",new THREE.BufferAttribute(d,3))}else if(a.geometry instanceof THREE.BufferGeometry){if(void 0!==a.geometry.attributes.index){for(var l=a.geometry.attributes.position.array,r=a.geometry.attributes.index.array,m=a.geometry.offsets,n=0,h=new Uint32Array(2*r.length),s=0,x=m.length;s<x;++s)for(var q=m[s].start,v=m[s].count,g=m[s].index,p=q,t=q+v;p<t;p+=3)for(q=0;3>q;q++)d[0]=g+r[p+q],d[1]=g+r[p+(q+1)%3],d.sort(e),v=d.toString(),
void 0===f[v]&&(h[2*n]=d[0],h[2*n+1]=d[1],f[v]=!0,n++);d=new Float32Array(6*n);p=0;for(r=n;p<r;p++)for(q=0;2>q;q++)g=6*p+3*q,n=3*h[2*p+q],d[g+0]=l[n],d[g+1]=l[n+1],d[g+2]=l[n+2]}else for(l=a.geometry.attributes.position.array,n=l.length/3,h=n/3,d=new Float32Array(6*n),p=0,r=h;p<r;p++)for(q=0;3>q;q++)g=18*p+6*q,h=9*p+3*q,d[g+0]=l[h],d[g+1]=l[h+1],d[g+2]=l[h+2],n=9*p+(q+1)%3*3,d[g+3]=l[n],d[g+4]=l[n+1],d[g+5]=l[n+2];k.addAttribute("position",new THREE.BufferAttribute(d,3))}THREE.Line.call(this,k,new THREE.LineBasicMaterial({color:c}),
THREE.LinePieces);this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1};THREE.WireframeHelper.prototype=Object.create(THREE.Line.prototype);THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this);this.render=function(a){}};THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype);THREE.LensFlare=function(a,b,c,d,f){THREE.Object3D.call(this);this.lensFlares=[];this.positionScreen=new THREE.Vector3;this.customUpdateCallback=void 0;void 0!==a&&this.add(a,b,c,d,f)};
THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype);THREE.LensFlare.prototype.add=function(a,b,c,d,f,e){void 0===b&&(b=-1);void 0===c&&(c=0);void 0===e&&(e=1);void 0===f&&(f=new THREE.Color(16777215));void 0===d&&(d=THREE.NormalBlending);c=Math.min(c,Math.max(0,c));this.lensFlares.push({texture:a,size:b,distance:c,x:0,y:0,z:0,scale:1,rotation:1,opacity:e,color:f,blending:d})};
THREE.LensFlare.prototype.updateLensFlares=function(){var a,b=this.lensFlares.length,c,d=2*-this.positionScreen.x,f=2*-this.positionScreen.y;for(a=0;a<b;a++)c=this.lensFlares[a],c.x=this.positionScreen.x+d*c.distance,c.y=this.positionScreen.y+f*c.distance,c.wantedRotation=c.x*Math.PI*.25,c.rotation+=.25*(c.wantedRotation-c.rotation)};
THREE.MorphBlendMesh=function(a,b){THREE.Mesh.call(this,a,b);this.animationsMap={};this.animationsList=[];var c=this.geometry.morphTargets.length;this.createAnimation("__default",0,c-1,c/1);this.setAnimationWeight("__default",1)};THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype);
THREE.MorphBlendMesh.prototype.createAnimation=function(a,b,c,d){b={startFrame:b,endFrame:c,length:c-b+1,fps:d,duration:(c-b)/d,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[a]=b;this.animationsList.push(b)};
THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(a){for(var b=/([a-z]+)_?(\d+)/,c,d={},f=this.geometry,e=0,g=f.morphTargets.length;e<g;e++){var k=f.morphTargets[e].name.match(b);if(k&&1<k.length){var l=k[1];d[l]||(d[l]={start:Infinity,end:-Infinity});k=d[l];e<k.start&&(k.start=e);e>k.end&&(k.end=e);c||(c=l)}}for(l in d)k=d[l],this.createAnimation(l,k.start,k.end,a);this.firstAnimation=c};
THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(a){if(a=this.animationsMap[a])a.direction=1,a.directionBackwards=!1};THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(a){if(a=this.animationsMap[a])a.direction=-1,a.directionBackwards=!0};THREE.MorphBlendMesh.prototype.setAnimationFPS=function(a,b){var c=this.animationsMap[a];c&&(c.fps=b,c.duration=(c.end-c.start)/c.fps)};
THREE.MorphBlendMesh.prototype.setAnimationDuration=function(a,b){var c=this.animationsMap[a];c&&(c.duration=b,c.fps=(c.end-c.start)/c.duration)};THREE.MorphBlendMesh.prototype.setAnimationWeight=function(a,b){var c=this.animationsMap[a];c&&(c.weight=b)};THREE.MorphBlendMesh.prototype.setAnimationTime=function(a,b){var c=this.animationsMap[a];c&&(c.time=b)};THREE.MorphBlendMesh.prototype.getAnimationTime=function(a){var b=0;if(a=this.animationsMap[a])b=a.time;return b};
THREE.MorphBlendMesh.prototype.getAnimationDuration=function(a){var b=-1;if(a=this.animationsMap[a])b=a.duration;return b};THREE.MorphBlendMesh.prototype.playAnimation=function(a){var b=this.animationsMap[a];b?(b.time=0,b.active=!0):console.warn("animation["+a+"] undefined")};THREE.MorphBlendMesh.prototype.stopAnimation=function(a){if(a=this.animationsMap[a])a.active=!1};
THREE.MorphBlendMesh.prototype.update=function(a){for(var b=0,c=this.animationsList.length;b<c;b++){var d=this.animationsList[b];if(d.active){var f=d.duration/d.length;d.time+=d.direction*a;if(d.mirroredLoop){if(d.time>d.duration||0>d.time)d.direction*=-1,d.time>d.duration&&(d.time=d.duration,d.directionBackwards=!0),0>d.time&&(d.time=0,d.directionBackwards=!1)}else d.time%=d.duration,0>d.time&&(d.time+=d.duration);var e=d.startFrame+THREE.Math.clamp(Math.floor(d.time/f),0,d.length-1),g=d.weight;
e!==d.currentFrame&&(this.morphTargetInfluences[d.lastFrame]=0,this.morphTargetInfluences[d.currentFrame]=1*g,this.morphTargetInfluences[e]=0,d.lastFrame=d.currentFrame,d.currentFrame=e);f=d.time%f/f;d.directionBackwards&&(f=1-f);this.morphTargetInfluences[d.currentFrame]=f*g;this.morphTargetInfluences[d.lastFrame]=(1-f)*g}}};
THREE.LensFlarePlugin=function(){var a,b,c,d,f,e,g,k,l,m;function n(a,b){var c=h.createProgram(),d=h.createShader(h.FRAGMENT_SHADER),e=h.createShader(h.VERTEX_SHADER),f="precision "+b+" float;\nprecision "+b+" int;\n";h.shaderSource(d,f+a.fragmentShader);h.shaderSource(e,f+a.vertexShader);h.compileShader(d);h.compileShader(e);h.attachShader(c,d);h.attachShader(c,e);h.linkProgram(c);return c}var h,p,r,s=[],q,v,x,t,G,u;this.init=function(s){h=s.context;p=s;r=s.getPrecision();s=new Float32Array([-1,
-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]);var C=new Uint16Array([0,1,2,0,2,3]);q=h.createBuffer();v=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,q);h.bufferData(h.ARRAY_BUFFER,s,h.STATIC_DRAW);h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,v);h.bufferData(h.ELEMENT_ARRAY_BUFFER,C,h.STATIC_DRAW);G=h.createTexture();u=h.createTexture();h.bindTexture(h.TEXTURE_2D,G);h.texImage2D(h.TEXTURE_2D,0,h.RGB,16,16,0,h.RGB,h.UNSIGNED_BYTE,null);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE);h.texParameteri(h.TEXTURE_2D,
h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST);h.bindTexture(h.TEXTURE_2D,u);h.texImage2D(h.TEXTURE_2D,0,h.RGBA,16,16,0,h.RGBA,h.UNSIGNED_BYTE,null);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST);
x=(t=0<h.getParameter(h.MAX_VERTEX_TEXTURE_IMAGE_UNITS))?n(THREE.ShaderFlares.lensFlare,r):n(THREE.ShaderFlares.lensFlareVertexTexture,r);l=h.getAttribLocation(x,"position");m=h.getAttribLocation(x,"uv");a=h.getUniformLocation(x,"renderType");b=h.getUniformLocation(x,"map");c=h.getUniformLocation(x,"occlusionMap");d=h.getUniformLocation(x,"opacity");f=h.getUniformLocation(x,"color");e=h.getUniformLocation(x,"scale");g=h.getUniformLocation(x,"rotation");k=h.getUniformLocation(x,"screenPosition")};
this.render=function(n,r,y,z){s.length=0;n.traverseVisible(function(a){a instanceof THREE.LensFlare&&s.push(a)});if(0!==s.length){n=new THREE.Vector3;var A=z/y,w=.5*y,I=.5*z,B=16/z,E=new THREE.Vector2(B*A,B),L=new THREE.Vector3(1,1,0),K=new THREE.Vector2(1,1);h.useProgram(x);h.enableVertexAttribArray(l);h.enableVertexAttribArray(m);h.uniform1i(c,0);h.uniform1i(b,1);h.bindBuffer(h.ARRAY_BUFFER,q);h.vertexAttribPointer(l,2,h.FLOAT,!1,16,0);h.vertexAttribPointer(m,2,h.FLOAT,!1,16,8);h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,
v);h.disable(h.CULL_FACE);h.depthMask(!1);for(var H=0,O=s.length;H<O;H++){B=16/z;E.set(B*A,B);var J=s[H];n.set(J.matrixWorld.elements[12],J.matrixWorld.elements[13],J.matrixWorld.elements[14]);n.applyMatrix4(r.matrixWorldInverse);n.applyProjection(r.projectionMatrix);L.copy(n);K.x=L.x*w+w;K.y=L.y*I+I;if(t||0<K.x&&K.x<y&&0<K.y&&K.y<z){h.activeTexture(h.TEXTURE1);h.bindTexture(h.TEXTURE_2D,G);h.copyTexImage2D(h.TEXTURE_2D,0,h.RGB,K.x-8,K.y-8,16,16,0);h.uniform1i(a,0);h.uniform2f(e,E.x,E.y);h.uniform3f(k,
L.x,L.y,L.z);h.disable(h.BLEND);h.enable(h.DEPTH_TEST);h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0);h.activeTexture(h.TEXTURE0);h.bindTexture(h.TEXTURE_2D,u);h.copyTexImage2D(h.TEXTURE_2D,0,h.RGBA,K.x-8,K.y-8,16,16,0);h.uniform1i(a,1);h.disable(h.DEPTH_TEST);h.activeTexture(h.TEXTURE1);h.bindTexture(h.TEXTURE_2D,G);h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0);J.positionScreen.copy(L);J.customUpdateCallback?J.customUpdateCallback(J):J.updateLensFlares();h.uniform1i(a,2);h.enable(h.BLEND);for(var Q=
0,N=J.lensFlares.length;Q<N;Q++){var M=J.lensFlares[Q];.001<M.opacity&&.001<M.scale&&(L.x=M.x,L.y=M.y,L.z=M.z,B=M.size*M.scale/z,E.x=B*A,E.y=B,h.uniform3f(k,L.x,L.y,L.z),h.uniform2f(e,E.x,E.y),h.uniform1f(g,M.rotation),h.uniform1f(d,M.opacity),h.uniform3f(f,M.color.r,M.color.g,M.color.b),p.setBlending(M.blending,M.blendEquation,M.blendSrc,M.blendDst),p.setTexture(M.texture,1),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0))}}}h.enable(h.CULL_FACE);h.enable(h.DEPTH_TEST);h.depthMask(!0);p.resetGLState()}};
this.dispose=function(){h.deleteProgram(x);h.deleteTexture(G);h.deleteTexture(u)}};
THREE.ShadowMapPlugin=function(){function a(b,c,d){if(c.visible){var e=f[c.id];if(e&&c.castShadow&&(!1===c.frustumCulled||!0===n.intersectsObject(c)))for(var g=0,h=e.length;g<h;g++){var k=e[g];c._modelViewMatrix.multiplyMatrices(d.matrixWorldInverse,c.matrixWorld);q.push(k)}g=0;for(h=c.children.length;g<h;g++)a(b,c.children[g],d)}}var b,c,d,f,e,g,k,l,m,n=new THREE.Frustum,h=new THREE.Matrix4,p=new THREE.Vector3,r=new THREE.Vector3,s=new THREE.Vector3,q=[];this.init=function(a,h,n,p){b=a.context;c=
a;d=h;f=n;e=p;a=THREE.ShaderLib.depthRGBA;h=THREE.UniformsUtils.clone(a.uniforms);g=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,uniforms:h});k=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,uniforms:h,morphTargets:!0});l=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,uniforms:h,skinning:!0});m=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,
uniforms:h,morphTargets:!0,skinning:!0});g._shadowPass=!0;k._shadowPass=!0;l._shadowPass=!0;m._shadowPass=!0};this.dispose=function(){g.dispose();g=null;l.dispose();l=null;k.dispose();k=null;m.dispose();c=m=null;q.splice(0,q.length)};this.render=function(a,b){!1!==c.shadowMapEnabled&&!1!==c.shadowMapAutoUpdate&&this.update(a,b)};this.update=function(f,x){var t,G,u,F,C,y,z,A,w,I=[];F=0;b.clearColor(1,1,1,1);b.disable(b.BLEND);b.enable(b.CULL_FACE);b.frontFace(b.CCW);c.shadowMapCullFace===THREE.CullFaceFront?
b.cullFace(b.FRONT):b.cullFace(b.BACK);c.setDepthTest(!0);t=0;for(G=d.length;t<G;t++)if(u=d[t],u.castShadow)if(u instanceof THREE.DirectionalLight&&u.shadowCascade)for(C=0;C<u.shadowCascadeCount;C++){if(u.shadowCascadeArray[C])y=u.shadowCascadeArray[C];else{w=u;var B=C;y=new THREE.DirectionalLight;y.isVirtual=!0;y.onlyShadow=!0;y.castShadow=!0;y.shadowCameraNear=w.shadowCameraNear;y.shadowCameraFar=w.shadowCameraFar;y.shadowCameraLeft=w.shadowCameraLeft;y.shadowCameraRight=w.shadowCameraRight;y.shadowCameraBottom=
w.shadowCameraBottom;y.shadowCameraTop=w.shadowCameraTop;y.shadowCameraVisible=w.shadowCameraVisible;y.shadowDarkness=w.shadowDarkness;y.shadowBias=w.shadowCascadeBias[B];y.shadowMapWidth=w.shadowCascadeWidth[B];y.shadowMapHeight=w.shadowCascadeHeight[B];y.pointsWorld=[];y.pointsFrustum=[];z=y.pointsWorld;A=y.pointsFrustum;for(var E=0;8>E;E++)z[E]=new THREE.Vector3,A[E]=new THREE.Vector3;z=w.shadowCascadeNearZ[B];w=w.shadowCascadeFarZ[B];A[0].set(-1,-1,z);A[1].set(1,-1,z);A[2].set(-1,1,z);A[3].set(1,
1,z);A[4].set(-1,-1,w);A[5].set(1,-1,w);A[6].set(-1,1,w);A[7].set(1,1,w);y.originalCamera=x;A=new THREE.Gyroscope;A.position.copy(u.shadowCascadeOffset);A.add(y);A.add(y.target);x.add(A);u.shadowCascadeArray[C]=y;console.log("Created virtualLight",y)}B=u;z=C;w=B.shadowCascadeArray[z];w.position.copy(B.position);w.target.position.copy(B.target.position);w.lookAt(w.target.position);w.shadowCameraVisible=B.shadowCameraVisible;w.shadowDarkness=B.shadowDarkness;w.shadowBias=B.shadowCascadeBias[z];A=B.shadowCascadeNearZ[z];
B=B.shadowCascadeFarZ[z];w=w.pointsFrustum;w[0].z=A;w[1].z=A;w[2].z=A;w[3].z=A;w[4].z=B;w[5].z=B;w[6].z=B;w[7].z=B;I[F]=y;F++}else I[F]=u,F++;t=0;for(G=I.length;t<G;t++){u=I[t];u.shadowMap||(C=THREE.LinearFilter,c.shadowMapType===THREE.PCFSoftShadowMap&&(C=THREE.NearestFilter),u.shadowMap=new THREE.WebGLRenderTarget(u.shadowMapWidth,u.shadowMapHeight,{minFilter:C,magFilter:C,format:THREE.RGBAFormat}),u.shadowMapSize=new THREE.Vector2(u.shadowMapWidth,u.shadowMapHeight),u.shadowMatrix=new THREE.Matrix4);
if(!u.shadowCamera){if(u instanceof THREE.SpotLight)u.shadowCamera=new THREE.PerspectiveCamera(u.shadowCameraFov,u.shadowMapWidth/u.shadowMapHeight,u.shadowCameraNear,u.shadowCameraFar);else if(u instanceof THREE.DirectionalLight)u.shadowCamera=new THREE.OrthographicCamera(u.shadowCameraLeft,u.shadowCameraRight,u.shadowCameraTop,u.shadowCameraBottom,u.shadowCameraNear,u.shadowCameraFar);else{console.error("Unsupported light type for shadow");continue}f.add(u.shadowCamera);!0===f.autoUpdate&&f.updateMatrixWorld()}u.shadowCameraVisible&&
!u.cameraHelper&&(u.cameraHelper=new THREE.CameraHelper(u.shadowCamera),u.shadowCamera.add(u.cameraHelper));if(u.isVirtual&&u.originalCamera==x){C=x;F=u.shadowCamera;y=u.pointsFrustum;A=u.pointsWorld;p.set(Infinity,Infinity,Infinity);r.set(-Infinity,-Infinity,-Infinity);for(w=0;8>w;w++)B=A[w],B.copy(y[w]),B.unproject(C),B.applyMatrix4(F.matrixWorldInverse),B.x<p.x&&(p.x=B.x),B.x>r.x&&(r.x=B.x),B.y<p.y&&(p.y=B.y),B.y>r.y&&(r.y=B.y),B.z<p.z&&(p.z=B.z),B.z>r.z&&(r.z=B.z);F.left=p.x;F.right=r.x;F.top=
r.y;F.bottom=p.y;F.updateProjectionMatrix()}F=u.shadowMap;y=u.shadowMatrix;C=u.shadowCamera;C.position.setFromMatrixPosition(u.matrixWorld);s.setFromMatrixPosition(u.target.matrixWorld);C.lookAt(s);C.updateMatrixWorld();C.matrixWorldInverse.getInverse(C.matrixWorld);u.cameraHelper&&(u.cameraHelper.visible=u.shadowCameraVisible);u.shadowCameraVisible&&u.cameraHelper.update();y.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);y.multiply(C.projectionMatrix);y.multiply(C.matrixWorldInverse);h.multiplyMatrices(C.projectionMatrix,
C.matrixWorldInverse);n.setFromMatrix(h);c.setRenderTarget(F);c.clear();q.length=0;a(f,f,C);u=0;for(F=q.length;u<F;u++)A=q[u],w=A.object,y=A.buffer,B=w.material instanceof THREE.MeshFaceMaterial?w.material.materials[0]:w.material,z=void 0!==w.geometry.morphTargets&&0<w.geometry.morphTargets.length&&B.morphTargets,E=w instanceof THREE.SkinnedMesh&&B.skinning,z=w.customDepthMaterial?w.customDepthMaterial:E?z?m:l:z?k:g,c.setMaterialFaces(B),y instanceof THREE.BufferGeometry?c.renderBufferDirect(C,d,
null,z,y,w,A.offsetIndices):c.renderBuffer(C,d,null,z,y,w);u=0;for(F=e.length;u<F;u++)A=e[u],w=A.object,w.visible&&w.castShadow&&(w._modelViewMatrix.multiplyMatrices(C.matrixWorldInverse,w.matrixWorld),c.renderImmediateObject(C,d,null,g,w))}t=c.getClearColor();G=c.getClearAlpha();b.clearColor(t.r,t.g,t.b,G);b.enable(b.BLEND);c.shadowMapCullFace===THREE.CullFaceFront&&b.cullFace(b.BACK);c.resetGLState()}};
THREE.SpritePlugin=function(){var a,b,c,d,f,e,g,k,l,m,n,h,p,r,s,q,v;function x(a,b){return a.z!==b.z?b.z-a.z:b.id-a.id}var t,G,u,F=[],C,y,z;this.init=function(x){t=x.context;G=x;x=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]);var w=new Uint16Array([0,1,2,0,2,3]);C=t.createBuffer();y=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,C);t.bufferData(t.ARRAY_BUFFER,x,t.STATIC_DRAW);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,y);t.bufferData(t.ELEMENT_ARRAY_BUFFER,w,t.STATIC_DRAW);x=t.createProgram();
var w=t.createShader(t.VERTEX_SHADER),F=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(w,["precision "+G.getPrecision()+" float;","uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition;\nfinalPosition = projectionMatrix * finalPosition;\ngl_Position = finalPosition;\n}"].join("\n"));
t.shaderSource(F,["precision "+G.getPrecision()+" float;","uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"].join("\n"));
t.compileShader(w);t.compileShader(F);t.attachShader(x,w);t.attachShader(x,F);t.linkProgram(x);z=x;q=t.getAttribLocation(z,"position");v=t.getAttribLocation(z,"uv");a=t.getUniformLocation(z,"uvOffset");b=t.getUniformLocation(z,"uvScale");c=t.getUniformLocation(z,"rotation");d=t.getUniformLocation(z,"scale");f=t.getUniformLocation(z,"color");e=t.getUniformLocation(z,"map");g=t.getUniformLocation(z,"opacity");k=t.getUniformLocation(z,"modelViewMatrix");l=t.getUniformLocation(z,"projectionMatrix");m=
t.getUniformLocation(z,"fogType");n=t.getUniformLocation(z,"fogDensity");h=t.getUniformLocation(z,"fogNear");p=t.getUniformLocation(z,"fogFar");r=t.getUniformLocation(z,"fogColor");s=t.getUniformLocation(z,"alphaTest");x=document.createElement("canvas");x.width=8;x.height=8;w=x.getContext("2d");w.fillStyle="white";w.fillRect(0,0,8,8);u=new THREE.Texture(x);u.needsUpdate=!0};this.render=function(A,w,I,B){F.length=0;A.traverseVisible(function(a){a instanceof THREE.Sprite&&F.push(a)});if(0!==F.length){t.useProgram(z);
t.enableVertexAttribArray(q);t.enableVertexAttribArray(v);t.disable(t.CULL_FACE);t.enable(t.BLEND);t.bindBuffer(t.ARRAY_BUFFER,C);t.vertexAttribPointer(q,2,t.FLOAT,!1,16,0);t.vertexAttribPointer(v,2,t.FLOAT,!1,16,8);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,y);t.uniformMatrix4fv(l,!1,w.projectionMatrix.elements);t.activeTexture(t.TEXTURE0);t.uniform1i(e,0);B=I=0;var E=A.fog;E?(t.uniform3f(r,E.color.r,E.color.g,E.color.b),E instanceof THREE.Fog?(t.uniform1f(h,E.near),t.uniform1f(p,E.far),t.uniform1i(m,1),
B=I=1):E instanceof THREE.FogExp2&&(t.uniform1f(n,E.density),t.uniform1i(m,2),B=I=2)):(t.uniform1i(m,0),B=I=0);for(var E=0,L=F.length;E<L;E++){var K=F[E],H=K.material;K._modelViewMatrix.multiplyMatrices(w.matrixWorldInverse,K.matrixWorld);K.z=-K._modelViewMatrix.elements[14]}F.sort(x);w=[];E=0;for(L=F.length;E<L;E++)K=F[E],H=K.material,t.uniform1f(s,H.alphaTest),t.uniformMatrix4fv(k,!1,K._modelViewMatrix.elements),w[0]=K.scale.x,w[1]=K.scale.y,K=0,A.fog&&H.fog&&(K=B),I!==K&&(t.uniform1i(m,K),I=K),
null!==H.map?(t.uniform2f(a,H.map.offset.x,H.map.offset.y),t.uniform2f(b,H.map.repeat.x,H.map.repeat.y)):(t.uniform2f(a,0,0),t.uniform2f(b,1,1)),t.uniform1f(g,H.opacity),t.uniform3f(f,H.color.r,H.color.g,H.color.b),t.uniform1f(c,H.rotation),t.uniform2fv(d,w),G.setBlending(H.blending,H.blendEquation,H.blendSrc,H.blendDst),G.setDepthTest(H.depthTest),G.setDepthWrite(H.depthWrite),H.map&&H.map.image&&H.map.image.width?G.setTexture(H.map,0):G.setTexture(u,0),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,
0);t.enable(t.CULL_FACE);G.resetGLState()}};this.dispose=function(){u.dispose();t.deleteProgram(z);for(var a in F)F[a].material.dispose();t.deleteBuffer(C);t.deleteBuffer(y)}};
THREE.DepthPassPlugin=function(){function a(b,c,d){if(c.visible){var e=f[c.id];if(e&&(!1===c.frustumCulled||!0===n.intersectsObject(c)))for(var g=0,h=e.length;g<h;g++){var k=e[g];c._modelViewMatrix.multiplyMatrices(d.matrixWorldInverse,c.matrixWorld);p.push(k)}g=0;for(h=c.children.length;g<h;g++)a(b,c.children[g],d)}}this.enabled=!1;this.renderTarget=null;var b,c,d,f,e,g,k,l,m,n=new THREE.Frustum,h=new THREE.Matrix4,p=[];this.init=function(a,h,n,p){b=a.context;c=a;d=h;f=n;e=p;a=THREE.ShaderLib.depthRGBA;
h=THREE.UniformsUtils.clone(a.uniforms);g=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,uniforms:h});k=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,uniforms:h,morphTargets:!0});l=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,uniforms:h,skinning:!0});m=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,uniforms:h,morphTargets:!0,skinning:!0});g._shadowPass=
!0;k._shadowPass=!0;l._shadowPass=!0;m._shadowPass=!0};this.render=function(a,b){this.enabled&&this.update(a,b)};this.update=function(f,s){var q,v,x,t,G,u;b.clearColor(1,1,1,1);b.disable(b.BLEND);c.setDepthTest(!0);!0===f.autoUpdate&&f.updateMatrixWorld();s.matrixWorldInverse.getInverse(s.matrixWorld);h.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse);n.setFromMatrix(h);c.setRenderTarget(this.renderTarget);c.clear();p.length=0;a(f,f,s);var F;q=0;for(v=p.length;q<v;q++)G=p[q],u=G.object,x=
G.buffer,u instanceof THREE.PointCloud&&!u.customDepthMaterial||((F=u.material instanceof THREE.MeshFaceMaterial?u.material.materials[0]:u.material)&&c.setMaterialFaces(u.material),t=void 0!==u.geometry.morphTargets&&0<u.geometry.morphTargets.length&&F.morphTargets,F=u instanceof THREE.SkinnedMesh&&F.skinning,t=u.customDepthMaterial?u.customDepthMaterial:F?t?m:l:t?k:g,x instanceof THREE.BufferGeometry?c.renderBufferDirect(s,d,null,t,x,u,G.offsetIndices):c.renderBuffer(s,d,null,t,x,u));q=0;for(v=e.length;q<
v;q++)G=e[q],u=G.object,u.visible&&(u._modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,u.matrixWorld),c.renderImmediateObject(s,d,null,g,u));q=c.getClearColor();v=c.getClearAlpha();b.clearColor(q.r,q.g,q.b,v);b.enable(b.BLEND)}};
THREE.ShaderFlares={lensFlareVertexTexture:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},
lensFlare:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",
fragmentShader:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}};
