// threejs.org/license
'use strict';THREE.GeometryUtils={merge:function(a,c,b){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var d;c instanceof THREE.Mesh&&(c.matrixAutoUpdate&&c.updateMatrix(),d=c.matrix,c=c.geometry);a.merge(c,d,b)},center:function(a){console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.");return a.center()}};
THREE.ImageUtils={crossOrigin:void 0,loadTexture:function(a,c,b,d){var f=new THREE.ImageLoader;f.crossOrigin=this.crossOrigin;var e=new THREE.Texture(void 0,c);f.load(a,function(a){e.image=a;e.needsUpdate=!0;b&&b(e)},void 0,function(b){d&&d(b)});e.sourceFile=a;return e},loadTextureCube:function(a,c,b,d){var f=new THREE.ImageLoader;f.crossOrigin=this.crossOrigin;var e=new THREE.CubeTexture([],c);e.flipY=!1;var g=0;c=function(c){f.load(a[c],function(a){e.images[c]=a;g+=1;6===g&&(e.needsUpdate=!0,b&&
b(e))})};d=0;for(var h=a.length;d<h;++d)c(d);return e},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},getNormalMap:function(a,c){var b=function(b){var a=Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]);return[b[0]/a,b[1]/a,b[2]/a]};c|=1;var d=a.width,f=a.height,e=document.createElement("canvas");
e.width=d;e.height=f;var g=e.getContext("2d");g.drawImage(a,0,0);for(var h=g.getImageData(0,0,d,f).data,k=g.createImageData(d,f),l=k.data,m=0;m<d;m++)for(var r=0;r<f;r++){var n=0>r-1?0:r-1,q=r+1>f-1?f-1:r+1,s=0>m-1?0:m-1,p=m+1>d-1?d-1:m+1,w=[],y=[0,0,h[4*(r*d+m)]/255*c];w.push([-1,0,h[4*(r*d+s)]/255*c]);w.push([-1,-1,h[4*(n*d+s)]/255*c]);w.push([0,-1,h[4*(n*d+m)]/255*c]);w.push([1,-1,h[4*(n*d+p)]/255*c]);w.push([1,0,h[4*(r*d+p)]/255*c]);w.push([1,1,h[4*(q*d+p)]/255*c]);w.push([0,1,h[4*(q*d+m)]/255*
c]);w.push([-1,1,h[4*(q*d+s)]/255*c]);n=[];s=w.length;for(q=0;q<s;q++){var p=w[q],t=w[(q+1)%s],p=[p[0]-y[0],p[1]-y[1],p[2]-y[2]],t=[t[0]-y[0],t[1]-y[1],t[2]-y[2]];n.push(b([p[1]*t[2]-p[2]*t[1],p[2]*t[0]-p[0]*t[2],p[0]*t[1]-p[1]*t[0]]))}w=[0,0,0];for(q=0;q<n.length;q++)w[0]+=n[q][0],w[1]+=n[q][1],w[2]+=n[q][2];w[0]/=n.length;w[1]/=n.length;w[2]/=n.length;y=4*(r*d+m);l[y]=(w[0]+1)/2*255|0;l[y+1]=(w[1]+1)/2*255|0;l[y+2]=255*w[2]|0;l[y+3]=255}g.putImageData(k,0,0);return e},generateDataTexture:function(a,
c,b){var d=a*c,f=new Uint8Array(3*d),e=Math.floor(255*b.r),g=Math.floor(255*b.g);b=Math.floor(255*b.b);for(var h=0;h<d;h++)f[3*h]=e,f[3*h+1]=g,f[3*h+2]=b;a=new THREE.DataTexture(f,a,c,THREE.RGBFormat);a.needsUpdate=!0;return a}};
THREE.SceneUtils={createMultiMaterialObject:function(a,c){for(var b=new THREE.Object3D,d=0,f=c.length;d<f;d++)b.add(new THREE.Mesh(a,c[d]));return b},detach:function(a,c,b){a.applyMatrix(c.matrixWorld);c.remove(a);b.add(a)},attach:function(a,c,b){var d=new THREE.Matrix4;d.getInverse(b.matrixWorld);a.applyMatrix(d);c.remove(a);b.add(a)}};
THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(a){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing.";}},loadFace:function(a){var c=a.familyName.toLowerCase();this.faces[c]=this.faces[c]||{};this.faces[c][a.cssFontWeight]=this.faces[c][a.cssFontWeight]||{};this.faces[c][a.cssFontWeight][a.cssFontStyle]=a;return this.faces[c][a.cssFontWeight][a.cssFontStyle]=
a},drawText:function(a){var c=this.getFace(),b=this.size/c.resolution,d=0,f=String(a).split(""),e=f.length,g=[];for(a=0;a<e;a++){var h=new THREE.Path,h=this.extractGlyphPoints(f[a],c,b,d,h),d=d+h.offset;g.push(h.path)}return{paths:g,offset:d/2}},extractGlyphPoints:function(a,c,b,d,f){var e=[],g,h,k,l,m,r,n,q,s,p,w,y=c.glyphs[a]||c.glyphs["?"];if(y){if(y.o)for(c=y._cachedOutline||(y._cachedOutline=y.o.split(" ")),l=c.length,a=0;a<l;)switch(k=c[a++],k){case "m":k=c[a++]*b+d;m=c[a++]*b;f.moveTo(k,m);
break;case "l":k=c[a++]*b+d;m=c[a++]*b;f.lineTo(k,m);break;case "q":k=c[a++]*b+d;m=c[a++]*b;q=c[a++]*b+d;s=c[a++]*b;f.quadraticCurveTo(q,s,k,m);if(g=e[e.length-1])for(r=g.x,n=g.y,g=1,h=this.divisions;g<=h;g++){var t=g/h;THREE.Shape.Utils.b2(t,r,q,k);THREE.Shape.Utils.b2(t,n,s,m)}break;case "b":if(k=c[a++]*b+d,m=c[a++]*b,q=c[a++]*b+d,s=c[a++]*b,p=c[a++]*b+d,w=c[a++]*b,f.bezierCurveTo(q,s,p,w,k,m),g=e[e.length-1])for(r=g.x,n=g.y,g=1,h=this.divisions;g<=h;g++)t=g/h,THREE.Shape.Utils.b3(t,r,q,p,k),THREE.Shape.Utils.b3(t,
n,s,w,m)}return{offset:y.ha*b,path:f}}}};
THREE.FontUtils.generateShapes=function(a,c){c=c||{};var b=void 0!==c.curveSegments?c.curveSegments:4,d=void 0!==c.font?c.font:"helvetiker",f=void 0!==c.weight?c.weight:"normal",e=void 0!==c.style?c.style:"normal";THREE.FontUtils.size=void 0!==c.size?c.size:100;THREE.FontUtils.divisions=b;THREE.FontUtils.face=d;THREE.FontUtils.weight=f;THREE.FontUtils.style=e;b=THREE.FontUtils.drawText(a).paths;d=[];f=0;for(e=b.length;f<e;f++)Array.prototype.push.apply(d,b[f].toShapes());return d};
(function(a){var c=function(b){for(var a=b.length,c=0,e=a-1,g=0;g<a;e=g++)c+=b[e].x*b[g].y-b[g].x*b[e].y;return 0.5*c};a.Triangulate=function(b,a){var f=b.length;if(3>f)return null;var e=[],g=[],h=[],k,l,m;if(0<c(b))for(l=0;l<f;l++)g[l]=l;else for(l=0;l<f;l++)g[l]=f-1-l;var r=2*f;for(l=f-1;2<f;){if(0>=r--){console.log("Warning, unable to triangulate polygon!");break}k=l;f<=k&&(k=0);l=k+1;f<=l&&(l=0);m=l+1;f<=m&&(m=0);var n;a:{var q=n=void 0,s=void 0,p=void 0,w=void 0,y=void 0,t=void 0,H=void 0,u=
void 0,q=b[g[k]].x,s=b[g[k]].y,p=b[g[l]].x,w=b[g[l]].y,y=b[g[m]].x,t=b[g[m]].y;if(1E-10>(p-q)*(t-s)-(w-s)*(y-q))n=!1;else{var D=void 0,z=void 0,x=void 0,A=void 0,B=void 0,v=void 0,J=void 0,C=void 0,G=void 0,N=void 0,G=C=J=u=H=void 0,D=y-p,z=t-w,x=q-y,A=s-t,B=p-q,v=w-s;for(n=0;n<f;n++)if(H=b[g[n]].x,u=b[g[n]].y,!(H===q&&u===s||H===p&&u===w||H===y&&u===t)&&(J=H-q,C=u-s,G=H-p,N=u-w,H-=y,u-=t,G=D*N-z*G,J=B*C-v*J,C=x*u-A*H,-1E-10<=G&&-1E-10<=C&&-1E-10<=J)){n=!1;break a}n=!0}}if(n){e.push([b[g[k]],b[g[l]],
b[g[m]]]);h.push([g[k],g[l],g[m]]);k=l;for(m=l+1;m<f;k++,m++)g[k]=g[m];f--;r=2*f}}return a?h:e};a.Triangulate.area=c;return a})(THREE.FontUtils);self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace};THREE.typeface_js=self._typeface_js;THREE.Curve=function(){};THREE.Curve.prototype.getPoint=function(a){console.log("Warning, getPoint() not implemented!");return null};THREE.Curve.prototype.getPointAt=function(a){a=this.getUtoTmapping(a);return this.getPoint(a)};
THREE.Curve.prototype.getPoints=function(a){a||(a=5);var c,b=[];for(c=0;c<=a;c++)b.push(this.getPoint(c/a));return b};THREE.Curve.prototype.getSpacedPoints=function(a){a||(a=5);var c,b=[];for(c=0;c<=a;c++)b.push(this.getPointAt(c/a));return b};THREE.Curve.prototype.getLength=function(){var a=this.getLengths();return a[a.length-1]};
THREE.Curve.prototype.getLengths=function(a){a||(a=this.__arcLengthDivisions?this.__arcLengthDivisions:200);if(this.cacheArcLengths&&this.cacheArcLengths.length==a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var c=[],b,d=this.getPoint(0),f,e=0;c.push(0);for(f=1;f<=a;f++)b=this.getPoint(f/a),e+=b.distanceTo(d),c.push(e),d=b;return this.cacheArcLengths=c};THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0;this.getLengths()};
THREE.Curve.prototype.getUtoTmapping=function(a,c){var b=this.getLengths(),d=0,f=b.length,e;e=c?c:a*b[f-1];for(var g=0,h=f-1,k;g<=h;)if(d=Math.floor(g+(h-g)/2),k=b[d]-e,0>k)g=d+1;else if(0<k)h=d-1;else{h=d;break}d=h;if(b[d]==e)return d/(f-1);g=b[d];return b=(d+(e-g)/(b[d+1]-g))/(f-1)};THREE.Curve.prototype.getTangent=function(a){var c=a-1E-4;a+=1E-4;0>c&&(c=0);1<a&&(a=1);c=this.getPoint(c);return this.getPoint(a).clone().sub(c).normalize()};
THREE.Curve.prototype.getTangentAt=function(a){a=this.getUtoTmapping(a);return this.getTangent(a)};
THREE.Curve.Utils={tangentQuadraticBezier:function(a,c,b,d){return 2*(1-a)*(b-c)+2*a*(d-b)},tangentCubicBezier:function(a,c,b,d,f){return-3*c*(1-a)*(1-a)+3*b*(1-a)*(1-a)-6*a*b*(1-a)+6*a*d*(1-a)-3*a*a*d+3*a*a*f},tangentSpline:function(a,c,b,d,f){return 6*a*a-6*a+(3*a*a-4*a+1)+(-6*a*a+6*a)+(3*a*a-2*a)},interpolate:function(a,c,b,d,f){a=0.5*(b-a);d=0.5*(d-c);var e=f*f;return(2*c-2*b+a+d)*f*e+(-3*c+3*b-2*a-d)*e+a*f+c}};
THREE.Curve.create=function(a,c){a.prototype=Object.create(THREE.Curve.prototype);a.prototype.getPoint=c;return a};THREE.CurvePath=function(){this.curves=[];this.bends=[];this.autoClose=!1};THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype);THREE.CurvePath.prototype.add=function(a){this.curves.push(a)};THREE.CurvePath.prototype.checkConnection=function(){};
THREE.CurvePath.prototype.closePath=function(){var a=this.curves[0].getPoint(0),c=this.curves[this.curves.length-1].getPoint(1);a.equals(c)||this.curves.push(new THREE.LineCurve(c,a))};THREE.CurvePath.prototype.getPoint=function(a){var c=a*this.getLength(),b=this.getCurveLengths();for(a=0;a<b.length;){if(b[a]>=c)return c=b[a]-c,a=this.curves[a],c=1-c/a.getLength(),a.getPointAt(c);a++}return null};THREE.CurvePath.prototype.getLength=function(){var a=this.getCurveLengths();return a[a.length-1]};
THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var a=[],c=0,b,d=this.curves.length;for(b=0;b<d;b++)c+=this.curves[b].getLength(),a.push(c);return this.cacheLengths=a};
THREE.CurvePath.prototype.getBoundingBox=function(){var a=this.getPoints(),c,b,d,f,e,g;c=b=Number.NEGATIVE_INFINITY;f=e=Number.POSITIVE_INFINITY;var h,k,l,m,r=a[0]instanceof THREE.Vector3;m=r?new THREE.Vector3:new THREE.Vector2;k=0;for(l=a.length;k<l;k++)h=a[k],h.x>c?c=h.x:h.x<f&&(f=h.x),h.y>b?b=h.y:h.y<e&&(e=h.y),r&&(h.z>d?d=h.z:h.z<g&&(g=h.z)),m.add(h);a={minX:f,minY:e,maxX:c,maxY:b};r&&(a.maxZ=d,a.minZ=g);return a};
THREE.CurvePath.prototype.createPointsGeometry=function(a){a=this.getPoints(a,!0);return this.createGeometry(a)};THREE.CurvePath.prototype.createSpacedPointsGeometry=function(a){a=this.getSpacedPoints(a,!0);return this.createGeometry(a)};THREE.CurvePath.prototype.createGeometry=function(a){for(var c=new THREE.Geometry,b=0;b<a.length;b++)c.vertices.push(new THREE.Vector3(a[b].x,a[b].y,a[b].z||0));return c};THREE.CurvePath.prototype.addWrapPath=function(a){this.bends.push(a)};
THREE.CurvePath.prototype.getTransformedPoints=function(a,c){var b=this.getPoints(a),d,f;c||(c=this.bends);d=0;for(f=c.length;d<f;d++)b=this.getWrapPoints(b,c[d]);return b};THREE.CurvePath.prototype.getTransformedSpacedPoints=function(a,c){var b=this.getSpacedPoints(a),d,f;c||(c=this.bends);d=0;for(f=c.length;d<f;d++)b=this.getWrapPoints(b,c[d]);return b};
THREE.CurvePath.prototype.getWrapPoints=function(a,c){var b=this.getBoundingBox(),d,f,e,g,h,k;d=0;for(f=a.length;d<f;d++)e=a[d],g=e.x,h=e.y,k=g/b.maxX,k=c.getUtoTmapping(k,g),g=c.getPoint(k),k=c.getTangent(k),k.set(-k.y,k.x).multiplyScalar(h),e.x=g.x+k.x,e.y=g.y+k.y;return a};THREE.Gyroscope=function(){THREE.Object3D.call(this)};THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype);
THREE.Gyroscope.prototype.updateMatrixWorld=function(a){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||a)this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.quaternionWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.quaternionObject,this.scaleObject),this.matrixWorld.compose(this.translationWorld,this.quaternionObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),
this.matrixWorldNeedsUpdate=!1,a=!0;for(var c=0,b=this.children.length;c<b;c++)this.children[c].updateMatrixWorld(a)};THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3;THREE.Gyroscope.prototype.translationObject=new THREE.Vector3;THREE.Gyroscope.prototype.quaternionWorld=new THREE.Quaternion;THREE.Gyroscope.prototype.quaternionObject=new THREE.Quaternion;THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3;THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3;
THREE.Path=function(a){THREE.CurvePath.call(this);this.actions=[];a&&this.fromPoints(a)};THREE.Path.prototype=Object.create(THREE.CurvePath.prototype);THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"};THREE.Path.prototype.fromPoints=function(a){this.moveTo(a[0].x,a[0].y);for(var c=1,b=a.length;c<b;c++)this.lineTo(a[c].x,a[c].y)};
THREE.Path.prototype.moveTo=function(a,c){var b=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:b})};THREE.Path.prototype.lineTo=function(a,c){var b=Array.prototype.slice.call(arguments),d=this.actions[this.actions.length-1].args,d=new THREE.LineCurve(new THREE.Vector2(d[d.length-2],d[d.length-1]),new THREE.Vector2(a,c));this.curves.push(d);this.actions.push({action:THREE.PathActions.LINE_TO,args:b})};
THREE.Path.prototype.quadraticCurveTo=function(a,c,b,d){var f=Array.prototype.slice.call(arguments),e=this.actions[this.actions.length-1].args,e=new THREE.QuadraticBezierCurve(new THREE.Vector2(e[e.length-2],e[e.length-1]),new THREE.Vector2(a,c),new THREE.Vector2(b,d));this.curves.push(e);this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:f})};
THREE.Path.prototype.bezierCurveTo=function(a,c,b,d,f,e){var g=Array.prototype.slice.call(arguments),h=this.actions[this.actions.length-1].args,h=new THREE.CubicBezierCurve(new THREE.Vector2(h[h.length-2],h[h.length-1]),new THREE.Vector2(a,c),new THREE.Vector2(b,d),new THREE.Vector2(f,e));this.curves.push(h);this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:g})};
THREE.Path.prototype.splineThru=function(a){var c=Array.prototype.slice.call(arguments),b=this.actions[this.actions.length-1].args,b=[new THREE.Vector2(b[b.length-2],b[b.length-1])];Array.prototype.push.apply(b,a);b=new THREE.SplineCurve(b);this.curves.push(b);this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:c})};THREE.Path.prototype.arc=function(a,c,b,d,f,e){var g=this.actions[this.actions.length-1].args;this.absarc(a+g[g.length-2],c+g[g.length-1],b,d,f,e)};
THREE.Path.prototype.absarc=function(a,c,b,d,f,e){this.absellipse(a,c,b,b,d,f,e)};THREE.Path.prototype.ellipse=function(a,c,b,d,f,e,g){var h=this.actions[this.actions.length-1].args;this.absellipse(a+h[h.length-2],c+h[h.length-1],b,d,f,e,g)};THREE.Path.prototype.absellipse=function(a,c,b,d,f,e,g){var h=Array.prototype.slice.call(arguments),k=new THREE.EllipseCurve(a,c,b,d,f,e,g);this.curves.push(k);k=k.getPoint(1);h.push(k.x);h.push(k.y);this.actions.push({action:THREE.PathActions.ELLIPSE,args:h})};
THREE.Path.prototype.getSpacedPoints=function(a,c){a||(a=40);for(var b=[],d=0;d<a;d++)b.push(this.getPoint(d/a));return b};
THREE.Path.prototype.getPoints=function(a,c){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(a,c);a=a||12;var b=[],d,f,e,g,h,k,l,m,r,n,q,s,p;d=0;for(f=this.actions.length;d<f;d++)switch(e=this.actions[d],g=e.action,e=e.args,g){case THREE.PathActions.MOVE_TO:b.push(new THREE.Vector2(e[0],e[1]));break;case THREE.PathActions.LINE_TO:b.push(new THREE.Vector2(e[0],e[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:h=e[2];k=e[3];r=e[0];n=e[1];0<b.length?(g=b[b.length-1],q=g.x,
s=g.y):(g=this.actions[d-1].args,q=g[g.length-2],s=g[g.length-1]);for(e=1;e<=a;e++)p=e/a,g=THREE.Shape.Utils.b2(p,q,r,h),p=THREE.Shape.Utils.b2(p,s,n,k),b.push(new THREE.Vector2(g,p));break;case THREE.PathActions.BEZIER_CURVE_TO:h=e[4];k=e[5];r=e[0];n=e[1];l=e[2];m=e[3];0<b.length?(g=b[b.length-1],q=g.x,s=g.y):(g=this.actions[d-1].args,q=g[g.length-2],s=g[g.length-1]);for(e=1;e<=a;e++)p=e/a,g=THREE.Shape.Utils.b3(p,q,r,l,h),p=THREE.Shape.Utils.b3(p,s,n,m,k),b.push(new THREE.Vector2(g,p));break;case THREE.PathActions.CSPLINE_THRU:g=
this.actions[d-1].args;p=[new THREE.Vector2(g[g.length-2],g[g.length-1])];g=a*e[0].length;p=p.concat(e[0]);p=new THREE.SplineCurve(p);for(e=1;e<=g;e++)b.push(p.getPointAt(e/g));break;case THREE.PathActions.ARC:h=e[0];k=e[1];n=e[2];l=e[3];g=e[4];r=!!e[5];q=g-l;s=2*a;for(e=1;e<=s;e++)p=e/s,r||(p=1-p),p=l+p*q,g=h+n*Math.cos(p),p=k+n*Math.sin(p),b.push(new THREE.Vector2(g,p));break;case THREE.PathActions.ELLIPSE:for(h=e[0],k=e[1],n=e[2],m=e[3],l=e[4],g=e[5],r=!!e[6],q=g-l,s=2*a,e=1;e<=s;e++)p=e/s,r||
(p=1-p),p=l+p*q,g=h+n*Math.cos(p),p=k+m*Math.sin(p),b.push(new THREE.Vector2(g,p))}d=b[b.length-1];1E-10>Math.abs(d.x-b[0].x)&&1E-10>Math.abs(d.y-b[0].y)&&b.splice(b.length-1,1);c&&b.push(b[0]);return b};
THREE.Path.prototype.toShapes=function(a,c){function b(b){for(var a=[],c=0,d=b.length;c<d;c++){var g=b[c],e=new THREE.Shape;e.actions=g.actions;e.curves=g.curves;a.push(e)}return a}function d(b,a){for(var c=a.length,d=!1,g=c-1,e=0;e<c;g=e++){var f=a[g],h=a[e],n=h.x-f.x,k=h.y-f.y;if(1E-10<Math.abs(k)){if(0>k&&(f=a[e],n=-n,h=a[g],k=-k),!(b.y<f.y||b.y>h.y))if(b.y==f.y){if(b.x==f.x)return!0}else{g=k*(b.x-f.x)-n*(b.y-f.y);if(0==g)return!0;0>g||(d=!d)}}else if(b.y==f.y&&(h.x<=b.x&&b.x<=f.x||f.x<=b.x&&b.x<=
h.x))return!0}return d}var f=function(b){var a,c,d,g,e=[],f=new THREE.Path;a=0;for(c=b.length;a<c;a++)d=b[a],g=d.args,d=d.action,d==THREE.PathActions.MOVE_TO&&0!=f.actions.length&&(e.push(f),f=new THREE.Path),f[d].apply(f,g);0!=f.actions.length&&e.push(f);return e}(this.actions);if(0==f.length)return[];if(!0===c)return b(f);var e,g,h,k=[];if(1==f.length)return g=f[0],h=new THREE.Shape,h.actions=g.actions,h.curves=g.curves,k.push(h),k;var l=!THREE.Shape.Utils.isClockWise(f[0].getPoints()),l=a?!l:l;
h=[];var m=[],r=[],n=0,q;m[n]=void 0;r[n]=[];var s,p;s=0;for(p=f.length;s<p;s++)g=f[s],q=g.getPoints(),e=THREE.Shape.Utils.isClockWise(q),(e=a?!e:e)?(!l&&m[n]&&n++,m[n]={s:new THREE.Shape,p:q},m[n].s.actions=g.actions,m[n].s.curves=g.curves,l&&n++,r[n]=[]):r[n].push({h:g,p:q[0]});if(!m[0])return b(f);if(1<m.length){s=!1;p=[];g=0;for(f=m.length;g<f;g++)h[g]=[];g=0;for(f=m.length;g<f;g++)for(e=r[g],l=0;l<e.length;l++){n=e[l];q=!0;for(var w=0;w<m.length;w++)d(n.p,m[w].p)&&(g!=w&&p.push({froms:g,tos:w,
hole:l}),q?(q=!1,h[w].push(n)):s=!0);q&&h[g].push(n)}0<p.length&&(s||(r=h))}s=0;for(p=m.length;s<p;s++)for(h=m[s].s,k.push(h),g=r[s],f=0,e=g.length;f<e;f++)h.holes.push(g[f].h);return k};THREE.Shape=function(){THREE.Path.apply(this,arguments);this.holes=[]};THREE.Shape.prototype=Object.create(THREE.Path.prototype);THREE.Shape.prototype.extrude=function(a){return new THREE.ExtrudeGeometry(this,a)};THREE.Shape.prototype.makeGeometry=function(a){return new THREE.ShapeGeometry(this,a)};
THREE.Shape.prototype.getPointsHoles=function(a){var c,b=this.holes.length,d=[];for(c=0;c<b;c++)d[c]=this.holes[c].getTransformedPoints(a,this.bends);return d};THREE.Shape.prototype.getSpacedPointsHoles=function(a){var c,b=this.holes.length,d=[];for(c=0;c<b;c++)d[c]=this.holes[c].getTransformedSpacedPoints(a,this.bends);return d};THREE.Shape.prototype.extractAllPoints=function(a){return{shape:this.getTransformedPoints(a),holes:this.getPointsHoles(a)}};
THREE.Shape.prototype.extractPoints=function(a){return this.useSpacedPoints?this.extractAllSpacedPoints(a):this.extractAllPoints(a)};THREE.Shape.prototype.extractAllSpacedPoints=function(a){return{shape:this.getTransformedSpacedPoints(a),holes:this.getSpacedPointsHoles(a)}};
THREE.Shape.Utils={triangulateShape:function(a,c){function b(b,a,c){return b.x!=a.x?b.x<a.x?b.x<=c.x&&c.x<=a.x:a.x<=c.x&&c.x<=b.x:b.y<a.y?b.y<=c.y&&c.y<=a.y:a.y<=c.y&&c.y<=b.y}function d(a,c,d,g,e){var f=c.x-a.x,h=c.y-a.y,k=g.x-d.x,l=g.y-d.y,m=a.x-d.x,r=a.y-d.y,x=h*k-f*l,A=h*m-f*r;if(1E-10<Math.abs(x)){if(0<x){if(0>A||A>x)return[];k=l*m-k*r;if(0>k||k>x)return[]}else{if(0<A||A<x)return[];k=l*m-k*r;if(0<k||k<x)return[]}if(0==k)return!e||0!=A&&A!=x?[a]:[];if(k==x)return!e||0!=A&&A!=x?[c]:[];if(0==A)return[d];
if(A==x)return[g];e=k/x;return[{x:a.x+e*f,y:a.y+e*h}]}if(0!=A||l*m!=k*r)return[];h=0==f&&0==h;k=0==k&&0==l;if(h&&k)return a.x!=d.x||a.y!=d.y?[]:[a];if(h)return b(d,g,a)?[a]:[];if(k)return b(a,c,d)?[d]:[];0!=f?(a.x<c.x?(f=a,k=a.x,h=c,a=c.x):(f=c,k=c.x,h=a,a=a.x),d.x<g.x?(c=d,x=d.x,l=g,d=g.x):(c=g,x=g.x,l=d,d=d.x)):(a.y<c.y?(f=a,k=a.y,h=c,a=c.y):(f=c,k=c.y,h=a,a=a.y),d.y<g.y?(c=d,x=d.y,l=g,d=g.y):(c=g,x=g.y,l=d,d=d.y));return k<=x?a<x?[]:a==x?e?[]:[c]:a<=d?[c,h]:[c,l]:k>d?[]:k==d?e?[]:[f]:a<=d?[f,h]:
[f,l]}function f(a,b,c,d){var g=b.x-a.x,f=b.y-a.y;b=c.x-a.x;c=c.y-a.y;var e=d.x-a.x;d=d.y-a.y;a=g*c-f*b;g=g*d-f*e;return 1E-10<Math.abs(a)?(b=e*c-d*b,0<a?0<=g&&0<=b:0<=g||0<=b):0<g}var e,g,h,k,l,m={};h=a.concat();e=0;for(g=c.length;e<g;e++)Array.prototype.push.apply(h,c[e]);e=0;for(g=h.length;e<g;e++)l=h[e].x+":"+h[e].y,void 0!==m[l]&&console.log("Duplicate point",l),m[l]=e;e=function(a,b){function c(a,b){var d=h.length-1,g=a-1;0>g&&(g=d);var e=a+1;e>d&&(e=0);d=f(h[a],h[g],h[e],k[b]);if(!d)return!1;
d=k.length-1;g=b-1;0>g&&(g=d);e=b+1;e>d&&(e=0);return(d=f(k[b],k[g],k[e],h[a]))?!0:!1}function g(a,b){var c,e;for(c=0;c<h.length;c++)if(e=c+1,e%=h.length,e=d(a,b,h[c],h[e],!0),0<e.length)return!0;return!1}function e(a,c){var g,f,h,k;for(g=0;g<l.length;g++)for(f=b[l[g]],h=0;h<f.length;h++)if(k=h+1,k%=f.length,k=d(a,c,f[h],f[k],!0),0<k.length)return!0;return!1}var h=a.concat(),k,l=[],m,r,z,x,A,B=[],v,J,C,G=0;for(m=b.length;G<m;G++)l.push(G);v=0;for(var N=2*l.length;0<l.length;){N--;if(0>N){console.log("Infinite Loop! Holes left:"+
l.length+", Probably Hole outside Shape!");break}for(r=v;r<h.length;r++){z=h[r];m=-1;for(G=0;G<l.length;G++)if(x=l[G],A=z.x+":"+z.y+":"+x,void 0===B[A]){k=b[x];for(J=0;J<k.length;J++)if(x=k[J],c(r,J)&&!g(z,x)&&!e(z,x)){m=J;l.splice(G,1);v=h.slice(0,r+1);x=h.slice(r);J=k.slice(m);C=k.slice(0,m+1);h=v.concat(J).concat(C).concat(x);v=r;break}if(0<=m)break;B[A]=!0}if(0<=m)break}}return h}(a,c);var r=THREE.FontUtils.Triangulate(e,!1);e=0;for(g=r.length;e<g;e++)for(k=r[e],h=0;3>h;h++)l=k[h].x+":"+k[h].y,
l=m[l],void 0!==l&&(k[h]=l);return r.concat()},isClockWise:function(a){return 0>THREE.FontUtils.Triangulate.area(a)},b2p0:function(a,c){var b=1-a;return b*b*c},b2p1:function(a,c){return 2*(1-a)*a*c},b2p2:function(a,c){return a*a*c},b2:function(a,c,b,d){return this.b2p0(a,c)+this.b2p1(a,b)+this.b2p2(a,d)},b3p0:function(a,c){var b=1-a;return b*b*b*c},b3p1:function(a,c){var b=1-a;return 3*b*b*a*c},b3p2:function(a,c){return 3*(1-a)*a*a*c},b3p3:function(a,c){return a*a*a*c},b3:function(a,c,b,d,f){return this.b3p0(a,
c)+this.b3p1(a,b)+this.b3p2(a,d)+this.b3p3(a,f)}};THREE.LineCurve=function(a,c){this.v1=a;this.v2=c};THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.LineCurve.prototype.getPoint=function(a){var c=this.v2.clone().sub(this.v1);c.multiplyScalar(a).add(this.v1);return c};THREE.LineCurve.prototype.getPointAt=function(a){return this.getPoint(a)};THREE.LineCurve.prototype.getTangent=function(a){return this.v2.clone().sub(this.v1).normalize()};
THREE.QuadraticBezierCurve=function(a,c,b){this.v0=a;this.v1=c;this.v2=b};THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.QuadraticBezierCurve.prototype.getPoint=function(a){var c;c=THREE.Shape.Utils.b2(a,this.v0.x,this.v1.x,this.v2.x);a=THREE.Shape.Utils.b2(a,this.v0.y,this.v1.y,this.v2.y);return new THREE.Vector2(c,a)};
THREE.QuadraticBezierCurve.prototype.getTangent=function(a){var c;c=THREE.Curve.Utils.tangentQuadraticBezier(a,this.v0.x,this.v1.x,this.v2.x);a=THREE.Curve.Utils.tangentQuadraticBezier(a,this.v0.y,this.v1.y,this.v2.y);c=new THREE.Vector2(c,a);c.normalize();return c};THREE.CubicBezierCurve=function(a,c,b,d){this.v0=a;this.v1=c;this.v2=b;this.v3=d};THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype);
THREE.CubicBezierCurve.prototype.getPoint=function(a){var c;c=THREE.Shape.Utils.b3(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x);a=THREE.Shape.Utils.b3(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y);return new THREE.Vector2(c,a)};THREE.CubicBezierCurve.prototype.getTangent=function(a){var c;c=THREE.Curve.Utils.tangentCubicBezier(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x);a=THREE.Curve.Utils.tangentCubicBezier(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y);c=new THREE.Vector2(c,a);c.normalize();return c};
THREE.SplineCurve=function(a){this.points=void 0==a?[]:a};THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.SplineCurve.prototype.getPoint=function(a){var c=new THREE.Vector2,b=[],d=this.points,f;f=(d.length-1)*a;a=Math.floor(f);f-=a;b[0]=0==a?a:a-1;b[1]=a;b[2]=a>d.length-2?d.length-1:a+1;b[3]=a>d.length-3?d.length-1:a+2;c.x=THREE.Curve.Utils.interpolate(d[b[0]].x,d[b[1]].x,d[b[2]].x,d[b[3]].x,f);c.y=THREE.Curve.Utils.interpolate(d[b[0]].y,d[b[1]].y,d[b[2]].y,d[b[3]].y,f);return c};
THREE.EllipseCurve=function(a,c,b,d,f,e,g){this.aX=a;this.aY=c;this.xRadius=b;this.yRadius=d;this.aStartAngle=f;this.aEndAngle=e;this.aClockwise=g};THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype);
THREE.EllipseCurve.prototype.getPoint=function(a){var c;c=this.aEndAngle-this.aStartAngle;0>c&&(c+=2*Math.PI);c>2*Math.PI&&(c-=2*Math.PI);c=!0===this.aClockwise?this.aEndAngle+(1-a)*(2*Math.PI-c):this.aStartAngle+a*c;a=this.aX+this.xRadius*Math.cos(c);c=this.aY+this.yRadius*Math.sin(c);return new THREE.Vector2(a,c)};THREE.ArcCurve=function(a,c,b,d,f,e){THREE.EllipseCurve.call(this,a,c,b,b,d,f,e)};THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype);
THREE.LineCurve3=THREE.Curve.create(function(a,c){this.v1=a;this.v2=c},function(a){var c=new THREE.Vector3;c.subVectors(this.v2,this.v1);c.multiplyScalar(a);c.add(this.v1);return c});THREE.QuadraticBezierCurve3=THREE.Curve.create(function(a,c,b){this.v0=a;this.v1=c;this.v2=b},function(a){var c,b;c=THREE.Shape.Utils.b2(a,this.v0.x,this.v1.x,this.v2.x);b=THREE.Shape.Utils.b2(a,this.v0.y,this.v1.y,this.v2.y);a=THREE.Shape.Utils.b2(a,this.v0.z,this.v1.z,this.v2.z);return new THREE.Vector3(c,b,a)});
THREE.CubicBezierCurve3=THREE.Curve.create(function(a,c,b,d){this.v0=a;this.v1=c;this.v2=b;this.v3=d},function(a){var c,b;c=THREE.Shape.Utils.b3(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x);b=THREE.Shape.Utils.b3(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y);a=THREE.Shape.Utils.b3(a,this.v0.z,this.v1.z,this.v2.z,this.v3.z);return new THREE.Vector3(c,b,a)});
THREE.SplineCurve3=THREE.Curve.create(function(a){this.points=void 0==a?[]:a},function(a){var c=new THREE.Vector3,b=[],d=this.points,f;a*=d.length-1;f=Math.floor(a);a-=f;b[0]=0==f?f:f-1;b[1]=f;b[2]=f>d.length-2?d.length-1:f+1;b[3]=f>d.length-3?d.length-1:f+2;f=d[b[0]];var e=d[b[1]],g=d[b[2]],b=d[b[3]];c.x=THREE.Curve.Utils.interpolate(f.x,e.x,g.x,b.x,a);c.y=THREE.Curve.Utils.interpolate(f.y,e.y,g.y,b.y,a);c.z=THREE.Curve.Utils.interpolate(f.z,e.z,g.z,b.z,a);return c});
THREE.ClosedSplineCurve3=THREE.Curve.create(function(a){this.points=void 0==a?[]:a},function(a){var c=new THREE.Vector3,b=[],d=this.points,f;f=(d.length-0)*a;a=Math.floor(f);f-=a;a+=0<a?0:(Math.floor(Math.abs(a)/d.length)+1)*d.length;b[0]=(a-1)%d.length;b[1]=a%d.length;b[2]=(a+1)%d.length;b[3]=(a+2)%d.length;c.x=THREE.Curve.Utils.interpolate(d[b[0]].x,d[b[1]].x,d[b[2]].x,d[b[3]].x,f);c.y=THREE.Curve.Utils.interpolate(d[b[0]].y,d[b[1]].y,d[b[2]].y,d[b[3]].y,f);c.z=THREE.Curve.Utils.interpolate(d[b[0]].z,
d[b[1]].z,d[b[2]].z,d[b[3]].z,f);return c});
THREE.AnimationHandler={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2,add:function(){console.warn("THREE.AnimationHandler.add() has been deprecated.")},get:function(){console.warn("THREE.AnimationHandler.get() has been deprecated.")},remove:function(){console.warn("THREE.AnimationHandler.remove() has been deprecated.")},animations:[],init:function(a){if(!0!==a.initialized){for(var c=0;c<a.hierarchy.length;c++){for(var b=0;b<a.hierarchy[c].keys.length;b++)if(0>a.hierarchy[c].keys[b].time&&(a.hierarchy[c].keys[b].time=
0),void 0!==a.hierarchy[c].keys[b].rot&&!(a.hierarchy[c].keys[b].rot instanceof THREE.Quaternion)){var d=a.hierarchy[c].keys[b].rot;a.hierarchy[c].keys[b].rot=(new THREE.Quaternion).fromArray(d)}if(a.hierarchy[c].keys.length&&void 0!==a.hierarchy[c].keys[0].morphTargets){d={};for(b=0;b<a.hierarchy[c].keys.length;b++)for(var f=0;f<a.hierarchy[c].keys[b].morphTargets.length;f++){var e=a.hierarchy[c].keys[b].morphTargets[f];d[e]=-1}a.hierarchy[c].usedMorphTargets=d;for(b=0;b<a.hierarchy[c].keys.length;b++){var g=
{};for(e in d){for(f=0;f<a.hierarchy[c].keys[b].morphTargets.length;f++)if(a.hierarchy[c].keys[b].morphTargets[f]===e){g[e]=a.hierarchy[c].keys[b].morphTargetsInfluences[f];break}f===a.hierarchy[c].keys[b].morphTargets.length&&(g[e]=0)}a.hierarchy[c].keys[b].morphTargetsInfluences=g}}for(b=1;b<a.hierarchy[c].keys.length;b++)a.hierarchy[c].keys[b].time===a.hierarchy[c].keys[b-1].time&&(a.hierarchy[c].keys.splice(b,1),b--);for(b=0;b<a.hierarchy[c].keys.length;b++)a.hierarchy[c].keys[b].index=b}a.initialized=
!0;return a}},parse:function(a){var c=function(a,b){b.push(a);for(var d=0;d<a.children.length;d++)c(a.children[d],b)},b=[];if(a instanceof THREE.SkinnedMesh)for(var d=0;d<a.skeleton.bones.length;d++)b.push(a.skeleton.bones[d]);else c(a,b);return b},play:function(a){-1===this.animations.indexOf(a)&&this.animations.push(a)},stop:function(a){a=this.animations.indexOf(a);-1!==a&&this.animations.splice(a,1)},update:function(a){for(var c=0;c<this.animations.length;c++)this.animations[c].resetBlendWeights();
for(c=0;c<this.animations.length;c++)this.animations[c].update(a)}};THREE.Animation=function(a,c){this.root=a;this.data=THREE.AnimationHandler.init(c);this.hierarchy=THREE.AnimationHandler.parse(a);this.currentTime=0;this.timeScale=1;this.isPlaying=!1;this.loop=!0;this.weight=0;this.interpolationType=THREE.AnimationHandler.LINEAR};THREE.Animation.prototype.keyTypes=["pos","rot","scl"];
THREE.Animation.prototype.play=function(a,c){this.currentTime=void 0!==a?a:0;this.weight=void 0!==c?c:1;this.isPlaying=!0;this.reset();THREE.AnimationHandler.play(this)};THREE.Animation.prototype.stop=function(){this.isPlaying=!1;THREE.AnimationHandler.stop(this)};
THREE.Animation.prototype.reset=function(){for(var a=0,c=this.hierarchy.length;a<c;a++){var b=this.hierarchy[a];b.matrixAutoUpdate=!0;void 0===b.animationCache&&(b.animationCache={animations:{},blending:{positionWeight:0,quaternionWeight:0,scaleWeight:0}});void 0===b.animationCache.animations[this.data.name]&&(b.animationCache.animations[this.data.name]={},b.animationCache.animations[this.data.name].prevKey={pos:0,rot:0,scl:0},b.animationCache.animations[this.data.name].nextKey={pos:0,rot:0,scl:0},
b.animationCache.animations[this.data.name].originalMatrix=b.matrix);for(var b=b.animationCache.animations[this.data.name],d=0;3>d;d++){var f=this.keyTypes[d],e=this.data.hierarchy[a].keys[0],g=this.getNextKeyWith(f,a,1);if(e&&e[f]&&g&&g[f]){for(;g.time<this.currentTime&&g.index>e.index;)e=g,g=this.getNextKeyWith(f,a,g.index+1);b.prevKey[f]=e;b.nextKey[f]=g}}}};
THREE.Animation.prototype.resetBlendWeights=function(){for(var a=0,c=this.hierarchy.length;a<c;a++){var b=this.hierarchy[a];void 0!==b.animationCache&&(b.animationCache.blending.positionWeight=0,b.animationCache.blending.quaternionWeight=0,b.animationCache.blending.scaleWeight=0)}};
THREE.Animation.prototype.update=function(){var a=[],c=new THREE.Vector3,b=new THREE.Vector3,d=new THREE.Quaternion,f=function(a,b){var c=[],d=[],f,r,n,q,s,p;f=(a.length-1)*b;r=Math.floor(f);f-=r;c[0]=0===r?r:r-1;c[1]=r;c[2]=r>a.length-2?r:r+1;c[3]=r>a.length-3?r:r+2;r=a[c[0]];q=a[c[1]];s=a[c[2]];p=a[c[3]];c=f*f;n=f*c;d[0]=e(r[0],q[0],s[0],p[0],f,c,n);d[1]=e(r[1],q[1],s[1],p[1],f,c,n);d[2]=e(r[2],q[2],s[2],p[2],f,c,n);return d},e=function(a,b,c,d,f,e,n){a=0.5*(c-a);d=0.5*(d-b);return(2*(b-c)+a+d)*
n+(-3*(b-c)-2*a-d)*e+a*f+b};return function(e){if(!1!==this.isPlaying&&(this.currentTime+=e*this.timeScale,0!==this.weight)){e=this.data.length;if(this.currentTime>e||0>this.currentTime)if(this.loop)this.currentTime%=e,0>this.currentTime&&(this.currentTime+=e),this.reset();else{this.stop();return}e=0;for(var h=this.hierarchy.length;e<h;e++)for(var k=this.hierarchy[e],l=k.animationCache.animations[this.data.name],m=k.animationCache.blending,r=0;3>r;r++){var n=this.keyTypes[r],q=l.prevKey[n],s=l.nextKey[n];
if(0<this.timeScale&&s.time<=this.currentTime||0>this.timeScale&&q.time>=this.currentTime){q=this.data.hierarchy[e].keys[0];for(s=this.getNextKeyWith(n,e,1);s.time<this.currentTime&&s.index>q.index;)q=s,s=this.getNextKeyWith(n,e,s.index+1);l.prevKey[n]=q;l.nextKey[n]=s}k.matrixAutoUpdate=!0;k.matrixWorldNeedsUpdate=!0;var p=(this.currentTime-q.time)/(s.time-q.time),w=q[n],y=s[n];0>p&&(p=0);1<p&&(p=1);if("pos"===n)if(this.interpolationType===THREE.AnimationHandler.LINEAR)b.x=w[0]+(y[0]-w[0])*p,b.y=
w[1]+(y[1]-w[1])*p,b.z=w[2]+(y[2]-w[2])*p,q=this.weight/(this.weight+m.positionWeight),k.position.lerp(b,q),m.positionWeight+=this.weight;else{if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)a[0]=this.getPrevKeyWith("pos",e,q.index-1).pos,a[1]=w,a[2]=y,a[3]=this.getNextKeyWith("pos",e,s.index+1).pos,p=0.33*p+0.33,s=f(a,p),q=this.weight/(this.weight+m.positionWeight),m.positionWeight+=this.weight,n=k.position,n.x+=(s[0]-
n.x)*q,n.y+=(s[1]-n.y)*q,n.z+=(s[2]-n.z)*q,this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(p=f(a,1.01*p),c.set(p[0],p[1],p[2]),c.sub(n),c.y=0,c.normalize(),p=Math.atan2(c.x,c.z),k.rotation.set(0,p,0))}else"rot"===n?(THREE.Quaternion.slerp(w,y,d,p),0===m.quaternionWeight?(k.quaternion.copy(d),m.quaternionWeight=this.weight):(q=this.weight/(this.weight+m.quaternionWeight),THREE.Quaternion.slerp(k.quaternion,d,k.quaternion,q),m.quaternionWeight+=this.weight)):"scl"===n&&(b.x=w[0]+
(y[0]-w[0])*p,b.y=w[1]+(y[1]-w[1])*p,b.z=w[2]+(y[2]-w[2])*p,q=this.weight/(this.weight+m.scaleWeight),k.scale.lerp(b,q),m.scaleWeight+=this.weight)}return!0}}}();
THREE.Animation.prototype.getNextKeyWith=function(a,c,b){var d=this.data.hierarchy[c].keys;if(void 0!==d&&0<d.length){for(b=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?b<d.length-1?b:d.length-1:b%d.length;b<d.length;b++)if(b=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?b<d.length-1?b:d.length-1:b%d.length,void 0!==d[b][a])return d[b];
return this.data.hierarchy[c].keys[0]}return null};THREE.Animation.prototype.getPrevKeyWith=function(a,c,b){var d=this.data.hierarchy[c].keys;if(void 0!==d&&0<d.length){for(b=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?0<b?b:0:0<=b?b:b+d.length;0<=b;b--)if(void 0!==d[b][a])return d[b];return this.data.hierarchy[c].keys[d.length-1]}return null};
THREE.KeyFrameAnimation=function(a){this.root=a.node;this.data=THREE.AnimationHandler.init(a);this.hierarchy=THREE.AnimationHandler.parse(this.root);this.currentTime=0;this.timeScale=0.001;this.isPlaying=!1;this.loop=this.isPaused=!0;a=0;for(var c=this.hierarchy.length;a<c;a++){var b=this.data.hierarchy[a].sids,d=this.hierarchy[a];if(this.data.hierarchy[a].keys.length&&b){for(var f=0;f<b.length;f++){var e=b[f],g=this.getNextKeyWith(e,a,0);g&&g.apply(e)}d.matrixAutoUpdate=!1;this.data.hierarchy[a].node.updateMatrix();
d.matrixWorldNeedsUpdate=!0}}};
THREE.KeyFrameAnimation.prototype.play=function(a){this.currentTime=void 0!==a?a:0;if(!1===this.isPlaying){this.isPlaying=!0;var c=this.hierarchy.length,b,d;for(a=0;a<c;a++)b=this.hierarchy[a],d=this.data.hierarchy[a],void 0===d.animationCache&&(d.animationCache={},d.animationCache.prevKey=null,d.animationCache.nextKey=null,d.animationCache.originalMatrix=b.matrix),b=this.data.hierarchy[a].keys,b.length&&(d.animationCache.prevKey=b[0],d.animationCache.nextKey=b[1],this.startTime=Math.min(b[0].time,
this.startTime),this.endTime=Math.max(b[b.length-1].time,this.endTime));this.update(0)}this.isPaused=!1;THREE.AnimationHandler.play(this)};THREE.KeyFrameAnimation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.stop(this);for(var a=0;a<this.data.hierarchy.length;a++){var c=this.hierarchy[a],b=this.data.hierarchy[a];if(void 0!==b.animationCache){var d=b.animationCache.originalMatrix;d.copy(c.matrix);c.matrix=d;delete b.animationCache}}};
THREE.KeyFrameAnimation.prototype.update=function(a){if(!1!==this.isPlaying){this.currentTime+=a*this.timeScale;a=this.data.length;!0===this.loop&&this.currentTime>a&&(this.currentTime%=a);this.currentTime=Math.min(this.currentTime,a);a=0;for(var c=this.hierarchy.length;a<c;a++){var b=this.hierarchy[a],d=this.data.hierarchy[a],f=d.keys,d=d.animationCache;if(f.length){var e=d.prevKey,g=d.nextKey;if(g.time<=this.currentTime){for(;g.time<this.currentTime&&g.index>e.index;)e=g,g=f[e.index+1];d.prevKey=
e;d.nextKey=g}g.time>=this.currentTime?e.interpolate(g,this.currentTime):e.interpolate(g,g.time);this.data.hierarchy[a].node.updateMatrix();b.matrixWorldNeedsUpdate=!0}}}};THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(a,c,b){c=this.data.hierarchy[c].keys;for(b%=c.length;b<c.length;b++)if(c[b].hasTarget(a))return c[b];return c[0]};
THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(a,c,b){c=this.data.hierarchy[c].keys;for(b=0<=b?b:b+c.length;0<=b;b--)if(c[b].hasTarget(a))return c[b];return c[c.length-1]};THREE.MorphAnimation=function(a){this.mesh=a;this.frames=a.morphTargetInfluences.length;this.currentTime=0;this.duration=1E3;this.loop=!0;this.isPlaying=!1};
THREE.MorphAnimation.prototype={play:function(){this.isPlaying=!0},pause:function(){this.isPlaying=!1},update:function(){var a=0,c=0;return function(b){if(!1!==this.isPlaying){this.currentTime+=b;!0===this.loop&&this.currentTime>this.duration&&(this.currentTime%=this.duration);this.currentTime=Math.min(this.currentTime,this.duration);b=this.duration/this.frames;var d=Math.floor(this.currentTime/b);d!=c&&(this.mesh.morphTargetInfluences[a]=0,this.mesh.morphTargetInfluences[c]=1,this.mesh.morphTargetInfluences[d]=
0,a=c,c=d);this.mesh.morphTargetInfluences[d]=this.currentTime%b/b;this.mesh.morphTargetInfluences[a]=1-this.mesh.morphTargetInfluences[d]}}}()};
THREE.BoxGeometry=function(a,c,b,d,f,e){function g(a,b,c,d,e,f,g,p){var w,y=h.widthSegments,t=h.heightSegments,H=e/2,u=f/2,D=h.vertices.length;if("x"===a&&"y"===b||"y"===a&&"x"===b)w="z";else if("x"===a&&"z"===b||"z"===a&&"x"===b)w="y",t=h.depthSegments;else if("z"===a&&"y"===b||"y"===a&&"z"===b)w="x",y=h.depthSegments;var z=y+1,x=t+1,A=e/y,B=f/t,v=new THREE.Vector3;v[w]=0<g?1:-1;for(e=0;e<x;e++)for(f=0;f<z;f++){var J=new THREE.Vector3;J[a]=(f*A-H)*c;J[b]=(e*B-u)*d;J[w]=g;h.vertices.push(J)}for(e=
0;e<t;e++)for(f=0;f<y;f++)u=f+z*e,a=f+z*(e+1),b=f+1+z*(e+1),c=f+1+z*e,d=new THREE.Vector2(f/y,1-e/t),g=new THREE.Vector2(f/y,1-(e+1)/t),w=new THREE.Vector2((f+1)/y,1-(e+1)/t),H=new THREE.Vector2((f+1)/y,1-e/t),u=new THREE.Face3(u+D,a+D,c+D),u.normal.copy(v),u.vertexNormals.push(v.clone(),v.clone(),v.clone()),u.materialIndex=p,h.faces.push(u),h.faceVertexUvs[0].push([d,g,H]),u=new THREE.Face3(a+D,b+D,c+D),u.normal.copy(v),u.vertexNormals.push(v.clone(),v.clone(),v.clone()),u.materialIndex=p,h.faces.push(u),
h.faceVertexUvs[0].push([g.clone(),w,H.clone()])}THREE.Geometry.call(this);this.type="BoxGeometry";this.parameters={width:a,height:c,depth:b,widthSegments:d,heightSegments:f,depthSegments:e};this.widthSegments=d||1;this.heightSegments=f||1;this.depthSegments=e||1;var h=this;d=a/2;f=c/2;e=b/2;g("z","y",-1,-1,b,c,d,0);g("z","y",1,-1,b,c,-d,1);g("x","z",1,1,a,b,f,2);g("x","z",1,-1,a,b,-f,3);g("x","y",1,-1,a,c,e,4);g("x","y",-1,-1,a,c,-e,5);this.mergeVertices()};THREE.BoxGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.CircleGeometry=function(a,c,b,d){THREE.Geometry.call(this);this.type="CircleGeometry";this.parameters={radius:a,segments:c,thetaStart:b,thetaLength:d};a=a||50;c=void 0!==c?Math.max(3,c):8;b=void 0!==b?b:0;d=void 0!==d?d:2*Math.PI;var f,e=[];f=new THREE.Vector3;var g=new THREE.Vector2(0.5,0.5);this.vertices.push(f);e.push(g);for(f=0;f<=c;f++){var h=new THREE.Vector3,k=b+f/c*d;h.x=a*Math.cos(k);h.y=a*Math.sin(k);this.vertices.push(h);e.push(new THREE.Vector2((h.x/a+1)/2,(h.y/a+1)/2))}b=new THREE.Vector3(0,
0,1);for(f=1;f<=c;f++)this.faces.push(new THREE.Face3(f,f+1,0,[b.clone(),b.clone(),b.clone()])),this.faceVertexUvs[0].push([e[f].clone(),e[f+1].clone(),g.clone()]);this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)};THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CubeGeometry=function(a,c,b,d,f,e){console.warn("THREE.CubeGeometry has been renamed to THREE.BoxGeometry.");return new THREE.BoxGeometry(a,c,b,d,f,e)};
THREE.CylinderGeometry=function(a,c,b,d,f,e){THREE.Geometry.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:a,radiusBottom:c,height:b,radialSegments:d,heightSegments:f,openEnded:e};a=void 0!==a?a:20;c=void 0!==c?c:20;b=void 0!==b?b:100;d=d||8;f=f||1;e=void 0!==e?e:!1;var g=b/2,h,k,l=[],m=[];for(k=0;k<=f;k++){var r=[],n=[],q=k/f,s=q*(c-a)+a;for(h=0;h<=d;h++){var p=h/d,w=new THREE.Vector3;w.x=s*Math.sin(p*Math.PI*2);w.y=-q*b+g;w.z=s*Math.cos(p*Math.PI*2);this.vertices.push(w);r.push(this.vertices.length-
1);n.push(new THREE.Vector2(p,1-q))}l.push(r);m.push(n)}b=(c-a)/b;for(h=0;h<d;h++)for(0!==a?(r=this.vertices[l[0][h]].clone(),n=this.vertices[l[0][h+1]].clone()):(r=this.vertices[l[1][h]].clone(),n=this.vertices[l[1][h+1]].clone()),r.setY(Math.sqrt(r.x*r.x+r.z*r.z)*b).normalize(),n.setY(Math.sqrt(n.x*n.x+n.z*n.z)*b).normalize(),k=0;k<f;k++){var q=l[k][h],s=l[k+1][h],p=l[k+1][h+1],w=l[k][h+1],y=r.clone(),t=r.clone(),H=n.clone(),u=n.clone(),D=m[k][h].clone(),z=m[k+1][h].clone(),x=m[k+1][h+1].clone(),
A=m[k][h+1].clone();this.faces.push(new THREE.Face3(q,s,w,[y,t,u]));this.faceVertexUvs[0].push([D,z,A]);this.faces.push(new THREE.Face3(s,p,w,[t.clone(),H,u.clone()]));this.faceVertexUvs[0].push([z.clone(),x,A.clone()])}if(!1===e&&0<a)for(this.vertices.push(new THREE.Vector3(0,g,0)),h=0;h<d;h++)q=l[0][h],s=l[0][h+1],p=this.vertices.length-1,y=new THREE.Vector3(0,1,0),t=new THREE.Vector3(0,1,0),H=new THREE.Vector3(0,1,0),D=m[0][h].clone(),z=m[0][h+1].clone(),x=new THREE.Vector2(z.x,0),this.faces.push(new THREE.Face3(q,
s,p,[y,t,H])),this.faceVertexUvs[0].push([D,z,x]);if(!1===e&&0<c)for(this.vertices.push(new THREE.Vector3(0,-g,0)),h=0;h<d;h++)q=l[k][h+1],s=l[k][h],p=this.vertices.length-1,y=new THREE.Vector3(0,-1,0),t=new THREE.Vector3(0,-1,0),H=new THREE.Vector3(0,-1,0),D=m[k][h+1].clone(),z=m[k][h].clone(),x=new THREE.Vector2(z.x,1),this.faces.push(new THREE.Face3(q,s,p,[y,t,H])),this.faceVertexUvs[0].push([D,z,x]);this.computeFaceNormals()};THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ExtrudeGeometry=function(a,c){"undefined"!==typeof a&&(THREE.Geometry.call(this),this.type="ExtrudeGeometry",a=a instanceof Array?a:[a],this.addShapeList(a,c),this.computeFaceNormals())};THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry.prototype.addShapeList=function(a,c){for(var b=a.length,d=0;d<b;d++)this.addShape(a[d],c)};
THREE.ExtrudeGeometry.prototype.addShape=function(a,c){function b(a,b,c){b||console.log("die");return b.clone().multiplyScalar(c).add(a)}function d(a,b,c){var d=THREE.Math.sign,e=1,e=a.x-b.x,f=a.y-b.y,g=c.x-a.x,h=c.y-a.y,k=e*e+f*f;if(1E-10<Math.abs(e*h-f*g)){var l=Math.sqrt(k),d=Math.sqrt(g*g+h*h),k=b.x-f/l;b=b.y+e/l;g=((c.x-h/d-k)*h-(c.y+g/d-b)*g)/(e*h-f*g);c=k+e*g-a.x;a=b+f*g-a.y;e=c*c+a*a;if(2>=e)return new THREE.Vector2(c,a);e=Math.sqrt(e/2)}else a=!1,1E-10<e?1E-10<g&&(a=!0):-1E-10>e?-1E-10>g&&
(a=!0):d(f)==d(h)&&(a=!0),a?(c=-f,a=e,e=Math.sqrt(k)):(c=e,a=f,e=Math.sqrt(k/2));return new THREE.Vector2(c/e,a/e)}function f(b,d){var e,f;for(E=b.length;0<=--E;){e=E;f=E-1;0>f&&(f=b.length-1);for(var g=0,h=q+2*m,g=0;g<h;g++){var k=P*g,l=P*(g+1),p=d+e+k,k=d+f+k,n=d+f+l,l=d+e+l,s=b,r=g,u=h,w=e,y=f,p=p+C,k=k+C,n=n+C,l=l+C;J.faces.push(new THREE.Face3(p,k,l,null,null,t));J.faces.push(new THREE.Face3(k,n,l,null,null,t));p=H.generateSideWallUV(J,a,s,c,p,k,n,l,r,u,w,y);J.faceVertexUvs[0].push([p[0],p[1],
p[3]]);J.faceVertexUvs[0].push([p[1],p[2],p[3]])}}}function e(a,b,c){J.vertices.push(new THREE.Vector3(a,b,c))}function g(b,d,e,f){b+=C;d+=C;e+=C;J.faces.push(new THREE.Face3(b,d,e,null,null,y));b=f?H.generateBottomUV(J,a,c,b,d,e):H.generateTopUV(J,a,c,b,d,e);J.faceVertexUvs[0].push(b)}var h=void 0!==c.amount?c.amount:100,k=void 0!==c.bevelThickness?c.bevelThickness:6,l=void 0!==c.bevelSize?c.bevelSize:k-2,m=void 0!==c.bevelSegments?c.bevelSegments:3,r=void 0!==c.bevelEnabled?c.bevelEnabled:!0,n=
void 0!==c.curveSegments?c.curveSegments:12,q=void 0!==c.steps?c.steps:1,s=c.extrudePath,p,w=!1,y=c.material,t=c.extrudeMaterial,H=void 0!==c.UVGenerator?c.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator,u,D,z,x;s&&(p=s.getSpacedPoints(q),w=!0,r=!1,u=void 0!==c.frames?c.frames:new THREE.TubeGeometry.FrenetFrames(s,q,!1),D=new THREE.Vector3,z=new THREE.Vector3,x=new THREE.Vector3);r||(l=k=m=0);var A,B,v,J=this,C=this.vertices.length,s=a.extractPoints(n),n=s.shape,G=s.holes;if(s=!THREE.Shape.Utils.isClockWise(n)){n=
n.reverse();B=0;for(v=G.length;B<v;B++)A=G[B],THREE.Shape.Utils.isClockWise(A)&&(G[B]=A.reverse());s=!1}var N=THREE.Shape.Utils.triangulateShape(n,G),L=n;B=0;for(v=G.length;B<v;B++)A=G[B],n=n.concat(A);var I,K,F,R,M,P=n.length,O,S=N.length,s=[],E=0;F=L.length;I=F-1;for(K=E+1;E<F;E++,I++,K++)I===F&&(I=0),K===F&&(K=0),s[E]=d(L[E],L[I],L[K]);var U=[],Q,T=s.concat();B=0;for(v=G.length;B<v;B++){A=G[B];Q=[];E=0;F=A.length;I=F-1;for(K=E+1;E<F;E++,I++,K++)I===F&&(I=0),K===F&&(K=0),Q[E]=d(A[E],A[I],A[K]);
U.push(Q);T=T.concat(Q)}for(I=0;I<m;I++){F=I/m;R=k*(1-F);K=l*Math.sin(F*Math.PI/2);E=0;for(F=L.length;E<F;E++)M=b(L[E],s[E],K),e(M.x,M.y,-R);B=0;for(v=G.length;B<v;B++)for(A=G[B],Q=U[B],E=0,F=A.length;E<F;E++)M=b(A[E],Q[E],K),e(M.x,M.y,-R)}K=l;for(E=0;E<P;E++)M=r?b(n[E],T[E],K):n[E],w?(z.copy(u.normals[0]).multiplyScalar(M.x),D.copy(u.binormals[0]).multiplyScalar(M.y),x.copy(p[0]).add(z).add(D),e(x.x,x.y,x.z)):e(M.x,M.y,0);for(F=1;F<=q;F++)for(E=0;E<P;E++)M=r?b(n[E],T[E],K):n[E],w?(z.copy(u.normals[F]).multiplyScalar(M.x),
D.copy(u.binormals[F]).multiplyScalar(M.y),x.copy(p[F]).add(z).add(D),e(x.x,x.y,x.z)):e(M.x,M.y,h/q*F);for(I=m-1;0<=I;I--){F=I/m;R=k*(1-F);K=l*Math.sin(F*Math.PI/2);E=0;for(F=L.length;E<F;E++)M=b(L[E],s[E],K),e(M.x,M.y,h+R);B=0;for(v=G.length;B<v;B++)for(A=G[B],Q=U[B],E=0,F=A.length;E<F;E++)M=b(A[E],Q[E],K),w?e(M.x,M.y+p[q-1].y,p[q-1].x+R):e(M.x,M.y,h+R)}(function(){if(r){var a;a=0*P;for(E=0;E<S;E++)O=N[E],g(O[2]+a,O[1]+a,O[0]+a,!0);a=q+2*m;a*=P;for(E=0;E<S;E++)O=N[E],g(O[0]+a,O[1]+a,O[2]+a,!1)}else{for(E=
0;E<S;E++)O=N[E],g(O[2],O[1],O[0],!0);for(E=0;E<S;E++)O=N[E],g(O[0]+P*q,O[1]+P*q,O[2]+P*q,!1)}})();(function(){var a=0;f(L,a);a+=L.length;B=0;for(v=G.length;B<v;B++)A=G[B],f(A,a),a+=A.length})()};
THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(a,c,b,d,f,e){c=a.vertices[f].x;f=a.vertices[f].y;b=a.vertices[e].x;e=a.vertices[e].y;return[new THREE.Vector2(a.vertices[d].x,a.vertices[d].y),new THREE.Vector2(c,f),new THREE.Vector2(b,e)]},generateBottomUV:function(a,c,b,d,f,e){return this.generateTopUV(a,c,b,d,f,e)},generateSideWallUV:function(a,c,b,d,f,e,g,h,k,l,m,r){c=a.vertices[f].x;b=a.vertices[f].y;f=a.vertices[f].z;d=a.vertices[e].x;k=a.vertices[e].y;e=a.vertices[e].z;l=a.vertices[g].x;
m=a.vertices[g].y;g=a.vertices[g].z;r=a.vertices[h].x;var n=a.vertices[h].y;a=a.vertices[h].z;return 0.01>Math.abs(b-k)?[new THREE.Vector2(c,1-f),new THREE.Vector2(d,1-e),new THREE.Vector2(l,1-g),new THREE.Vector2(r,1-a)]:[new THREE.Vector2(b,1-f),new THREE.Vector2(k,1-e),new THREE.Vector2(m,1-g),new THREE.Vector2(n,1-a)]}};THREE.ExtrudeGeometry.__v1=new THREE.Vector2;THREE.ExtrudeGeometry.__v2=new THREE.Vector2;THREE.ExtrudeGeometry.__v3=new THREE.Vector2;THREE.ExtrudeGeometry.__v4=new THREE.Vector2;
THREE.ExtrudeGeometry.__v5=new THREE.Vector2;THREE.ExtrudeGeometry.__v6=new THREE.Vector2;THREE.ShapeGeometry=function(a,c){THREE.Geometry.call(this);this.type="ShapeGeometry";!1===a instanceof Array&&(a=[a]);this.addShapeList(a,c);this.computeFaceNormals()};THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ShapeGeometry.prototype.addShapeList=function(a,c){for(var b=0,d=a.length;b<d;b++)this.addShape(a[b],c);return this};
THREE.ShapeGeometry.prototype.addShape=function(a,c){void 0===c&&(c={});var b=c.material,d=void 0===c.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:c.UVGenerator,f,e,g,h=this.vertices.length;f=a.extractPoints(void 0!==c.curveSegments?c.curveSegments:12);var k=f.shape,l=f.holes;if(!THREE.Shape.Utils.isClockWise(k))for(k=k.reverse(),f=0,e=l.length;f<e;f++)g=l[f],THREE.Shape.Utils.isClockWise(g)&&(l[f]=g.reverse());var m=THREE.Shape.Utils.triangulateShape(k,l);f=0;for(e=l.length;f<e;f++)g=l[f],
k=k.concat(g);l=k.length;e=m.length;for(f=0;f<l;f++)g=k[f],this.vertices.push(new THREE.Vector3(g.x,g.y,0));for(f=0;f<e;f++)l=m[f],k=l[0]+h,g=l[1]+h,l=l[2]+h,this.faces.push(new THREE.Face3(k,g,l,null,null,b)),this.faceVertexUvs[0].push(d.generateBottomUV(this,a,c,k,g,l))};
THREE.LatheGeometry=function(a,c,b,d){THREE.Geometry.call(this);this.type="LatheGeometry";this.parameters={points:a,segments:c,phiStart:b,phiLength:d};c=c||12;b=b||0;d=d||2*Math.PI;for(var f=1/(a.length-1),e=1/c,g=0,h=c;g<=h;g++)for(var k=b+g*e*d,l=Math.cos(k),m=Math.sin(k),k=0,r=a.length;k<r;k++){var n=a[k],q=new THREE.Vector3;q.x=l*n.x-m*n.y;q.y=m*n.x+l*n.y;q.z=n.z;this.vertices.push(q)}b=a.length;g=0;for(h=c;g<h;g++)for(k=0,r=a.length-1;k<r;k++){c=m=k+b*g;d=m+b;var l=m+1+b,m=m+1,n=g*e,q=k*f,s=
n+e,p=q+f;this.faces.push(new THREE.Face3(c,d,m));this.faceVertexUvs[0].push([new THREE.Vector2(n,q),new THREE.Vector2(s,q),new THREE.Vector2(n,p)]);this.faces.push(new THREE.Face3(d,l,m));this.faceVertexUvs[0].push([new THREE.Vector2(s,q),new THREE.Vector2(s,p),new THREE.Vector2(n,p)])}this.mergeVertices();this.computeFaceNormals();this.computeVertexNormals()};THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.PlaneGeometry=function(a,c,b,d){THREE.Geometry.call(this);this.type="PlaneGeometry";this.parameters={width:a,height:c,widthSegments:b,heightSegments:d};var f=a/2,e=c/2;b=b||1;d=d||1;var g=b+1,h=d+1,k=a/b,l=c/d,m=new THREE.Vector3(0,0,1);for(a=0;a<h;a++){var r=a*l-e;for(c=0;c<g;c++)this.vertices.push(new THREE.Vector3(c*k-f,-r,0))}for(a=0;a<d;a++)for(c=0;c<b;c++){var n=c+g*a,f=c+g*(a+1),e=c+1+g*(a+1),h=c+1+g*a,k=new THREE.Vector2(c/b,1-a/d),l=new THREE.Vector2(c/b,1-(a+1)/d),r=new THREE.Vector2((c+
1)/b,1-(a+1)/d),q=new THREE.Vector2((c+1)/b,1-a/d),n=new THREE.Face3(n,f,h);n.normal.copy(m);n.vertexNormals.push(m.clone(),m.clone(),m.clone());this.faces.push(n);this.faceVertexUvs[0].push([k,l,q]);n=new THREE.Face3(f,e,h);n.normal.copy(m);n.vertexNormals.push(m.clone(),m.clone(),m.clone());this.faces.push(n);this.faceVertexUvs[0].push([l.clone(),r,q.clone()])}};THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.RingGeometry=function(a,c,b,d,f,e){THREE.Geometry.call(this);this.type="RingGeometry";this.parameters={innerRadius:a,outerRadius:c,thetaSegments:b,phiSegments:d,thetaStart:f,thetaLength:e};a=a||0;c=c||50;f=void 0!==f?f:0;e=void 0!==e?e:2*Math.PI;b=void 0!==b?Math.max(3,b):8;d=void 0!==d?Math.max(1,d):8;var g,h=[],k=a,l=(c-a)/d;for(a=0;a<d+1;a++){for(g=0;g<b+1;g++){var m=new THREE.Vector3,r=f+g/b*e;m.x=k*Math.cos(r);m.y=k*Math.sin(r);this.vertices.push(m);h.push(new THREE.Vector2((m.x/c+1)/2,
(m.y/c+1)/2))}k+=l}c=new THREE.Vector3(0,0,1);for(a=0;a<d;a++)for(f=a*(b+1),g=0;g<b;g++)e=r=g+f,l=r+b+1,m=r+b+2,this.faces.push(new THREE.Face3(e,l,m,[c.clone(),c.clone(),c.clone()])),this.faceVertexUvs[0].push([h[e].clone(),h[l].clone(),h[m].clone()]),e=r,l=r+b+2,m=r+1,this.faces.push(new THREE.Face3(e,l,m,[c.clone(),c.clone(),c.clone()])),this.faceVertexUvs[0].push([h[e].clone(),h[l].clone(),h[m].clone()]);this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,k)};
THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.SphereGeometry=function(a,c,b,d,f,e,g){THREE.Geometry.call(this);this.type="SphereGeometry";this.parameters={radius:a,widthSegments:c,heightSegments:b,phiStart:d,phiLength:f,thetaStart:e,thetaLength:g};a=a||50;c=Math.max(3,Math.floor(c)||8);b=Math.max(2,Math.floor(b)||6);d=void 0!==d?d:0;f=void 0!==f?f:2*Math.PI;e=void 0!==e?e:0;g=void 0!==g?g:Math.PI;var h,k,l=[],m=[];for(k=0;k<=b;k++){var r=[],n=[];for(h=0;h<=c;h++){var q=h/c,s=k/b,p=new THREE.Vector3;p.x=-a*Math.cos(d+q*f)*Math.sin(e+s*g);
p.y=a*Math.cos(e+s*g);p.z=a*Math.sin(d+q*f)*Math.sin(e+s*g);this.vertices.push(p);r.push(this.vertices.length-1);n.push(new THREE.Vector2(q,1-s))}l.push(r);m.push(n)}for(k=0;k<b;k++)for(h=0;h<c;h++){d=l[k][h+1];f=l[k][h];e=l[k+1][h];g=l[k+1][h+1];var r=this.vertices[d].clone().normalize(),n=this.vertices[f].clone().normalize(),q=this.vertices[e].clone().normalize(),s=this.vertices[g].clone().normalize(),p=m[k][h+1].clone(),w=m[k][h].clone(),y=m[k+1][h].clone(),t=m[k+1][h+1].clone();Math.abs(this.vertices[d].y)===
a?(p.x=(p.x+w.x)/2,this.faces.push(new THREE.Face3(d,e,g,[r,q,s])),this.faceVertexUvs[0].push([p,y,t])):Math.abs(this.vertices[e].y)===a?(y.x=(y.x+t.x)/2,this.faces.push(new THREE.Face3(d,f,e,[r,n,q])),this.faceVertexUvs[0].push([p,w,y])):(this.faces.push(new THREE.Face3(d,f,g,[r,n,s])),this.faceVertexUvs[0].push([p,w,t]),this.faces.push(new THREE.Face3(f,e,g,[n.clone(),q,s.clone()])),this.faceVertexUvs[0].push([w.clone(),y,t.clone()]))}this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,
a)};THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TextGeometry=function(a,c){c=c||{};var b=THREE.FontUtils.generateShapes(a,c);c.amount=void 0!==c.height?c.height:50;void 0===c.bevelThickness&&(c.bevelThickness=10);void 0===c.bevelSize&&(c.bevelSize=8);void 0===c.bevelEnabled&&(c.bevelEnabled=!1);THREE.ExtrudeGeometry.call(this,b,c);this.type="TextGeometry"};THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype);
THREE.TorusGeometry=function(a,c,b,d,f){THREE.Geometry.call(this);this.type="TorusGeometry";this.parameters={radius:a,tube:c,radialSegments:b,tubularSegments:d,arc:f};a=a||100;c=c||40;b=b||8;d=d||6;f=f||2*Math.PI;for(var e=new THREE.Vector3,g=[],h=[],k=0;k<=b;k++)for(var l=0;l<=d;l++){var m=l/d*f,r=k/b*Math.PI*2;e.x=a*Math.cos(m);e.y=a*Math.sin(m);var n=new THREE.Vector3;n.x=(a+c*Math.cos(r))*Math.cos(m);n.y=(a+c*Math.cos(r))*Math.sin(m);n.z=c*Math.sin(r);this.vertices.push(n);g.push(new THREE.Vector2(l/
d,k/b));h.push(n.clone().sub(e).normalize())}for(k=1;k<=b;k++)for(l=1;l<=d;l++)a=(d+1)*k+l-1,c=(d+1)*(k-1)+l-1,f=(d+1)*(k-1)+l,e=(d+1)*k+l,m=new THREE.Face3(a,c,e,[h[a].clone(),h[c].clone(),h[e].clone()]),this.faces.push(m),this.faceVertexUvs[0].push([g[a].clone(),g[c].clone(),g[e].clone()]),m=new THREE.Face3(c,f,e,[h[c].clone(),h[f].clone(),h[e].clone()]),this.faces.push(m),this.faceVertexUvs[0].push([g[c].clone(),g[f].clone(),g[e].clone()]);this.computeFaceNormals()};
THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TorusKnotGeometry=function(a,c,b,d,f,e,g){function h(a,b,c,d,e){var f=Math.cos(a),g=Math.sin(a);a*=b/c;b=Math.cos(a);f*=d*(2+b)*0.5;g=d*(2+b)*g*0.5;d=e*d*Math.sin(a)*0.5;return new THREE.Vector3(f,g,d)}THREE.Geometry.call(this);this.type="TorusKnotGeometry";this.parameters={radius:a,tube:c,radialSegments:b,tubularSegments:d,p:f,q:e,heightScale:g};a=a||100;c=c||40;b=b||64;d=d||8;f=f||2;e=e||3;g=g||1;for(var k=Array(b),l=new THREE.Vector3,m=new THREE.Vector3,r=new THREE.Vector3,n=0;n<b;++n){k[n]=
Array(d);var q=n/b*2*f*Math.PI,s=h(q,e,f,a,g),q=h(q+0.01,e,f,a,g);l.subVectors(q,s);m.addVectors(q,s);r.crossVectors(l,m);m.crossVectors(r,l);r.normalize();m.normalize();for(q=0;q<d;++q){var p=q/d*2*Math.PI,w=-c*Math.cos(p),p=c*Math.sin(p),y=new THREE.Vector3;y.x=s.x+w*m.x+p*r.x;y.y=s.y+w*m.y+p*r.y;y.z=s.z+w*m.z+p*r.z;k[n][q]=this.vertices.push(y)-1}}for(n=0;n<b;++n)for(q=0;q<d;++q)f=(n+1)%b,e=(q+1)%d,a=k[n][q],c=k[f][q],f=k[f][e],e=k[n][e],g=new THREE.Vector2(n/b,q/d),l=new THREE.Vector2((n+1)/b,
q/d),m=new THREE.Vector2((n+1)/b,(q+1)/d),r=new THREE.Vector2(n/b,(q+1)/d),this.faces.push(new THREE.Face3(a,c,e)),this.faceVertexUvs[0].push([g,l,r]),this.faces.push(new THREE.Face3(c,f,e)),this.faceVertexUvs[0].push([l.clone(),m,r.clone()]);this.computeFaceNormals();this.computeVertexNormals()};THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TubeGeometry=function(a,c,b,d,f){THREE.Geometry.call(this);this.type="TubeGeometry";this.parameters={path:a,segments:c,radius:b,radialSegments:d,closed:f};c=c||64;b=b||1;d=d||8;f=f||!1;var e=[],g,h,k=c+1,l,m,r,n,q=new THREE.Vector3,s,p,w;s=new THREE.TubeGeometry.FrenetFrames(a,c,f);p=s.normals;w=s.binormals;this.tangents=s.tangents;this.normals=p;this.binormals=w;for(s=0;s<k;s++)for(e[s]=[],l=s/(k-1),n=a.getPointAt(l),g=p[s],h=w[s],l=0;l<d;l++)m=l/d*2*Math.PI,r=-b*Math.cos(m),m=b*Math.sin(m),
q.copy(n),q.x+=r*g.x+m*h.x,q.y+=r*g.y+m*h.y,q.z+=r*g.z+m*h.z,e[s][l]=this.vertices.push(new THREE.Vector3(q.x,q.y,q.z))-1;for(s=0;s<c;s++)for(l=0;l<d;l++)k=f?(s+1)%c:s+1,q=(l+1)%d,a=e[s][l],b=e[k][l],k=e[k][q],q=e[s][q],p=new THREE.Vector2(s/c,l/d),w=new THREE.Vector2((s+1)/c,l/d),g=new THREE.Vector2((s+1)/c,(l+1)/d),h=new THREE.Vector2(s/c,(l+1)/d),this.faces.push(new THREE.Face3(a,b,q)),this.faceVertexUvs[0].push([p,w,h]),this.faces.push(new THREE.Face3(b,k,q)),this.faceVertexUvs[0].push([w.clone(),
g,h.clone()]);this.computeFaceNormals();this.computeVertexNormals()};THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TubeGeometry.FrenetFrames=function(a,c,b){new THREE.Vector3;var d=new THREE.Vector3;new THREE.Vector3;var f=[],e=[],g=[],h=new THREE.Vector3,k=new THREE.Matrix4;c+=1;var l,m,r;this.tangents=f;this.normals=e;this.binormals=g;for(l=0;l<c;l++)m=l/(c-1),f[l]=a.getTangentAt(m),f[l].normalize();e[0]=new THREE.Vector3;g[0]=new THREE.Vector3;a=Number.MAX_VALUE;l=Math.abs(f[0].x);m=Math.abs(f[0].y);r=Math.abs(f[0].z);l<=a&&(a=l,d.set(1,0,0));m<=a&&(a=m,d.set(0,1,0));r<=a&&d.set(0,0,1);h.crossVectors(f[0],
d).normalize();e[0].crossVectors(f[0],h);g[0].crossVectors(f[0],e[0]);for(l=1;l<c;l++)e[l]=e[l-1].clone(),g[l]=g[l-1].clone(),h.crossVectors(f[l-1],f[l]),1E-4<h.length()&&(h.normalize(),d=Math.acos(THREE.Math.clamp(f[l-1].dot(f[l]),-1,1)),e[l].applyMatrix4(k.makeRotationAxis(h,d))),g[l].crossVectors(f[l],e[l]);if(b)for(d=Math.acos(THREE.Math.clamp(e[0].dot(e[c-1]),-1,1)),d/=c-1,0<f[0].dot(h.crossVectors(e[0],e[c-1]))&&(d=-d),l=1;l<c;l++)e[l].applyMatrix4(k.makeRotationAxis(f[l],d*l)),g[l].crossVectors(f[l],
e[l])};
THREE.PolyhedronGeometry=function(a,c,b,d){function f(a){var b=a.normalize().clone();b.index=k.vertices.push(b)-1;var c=Math.atan2(a.z,-a.x)/2/Math.PI+0.5;a=Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+0.5;b.uv=new THREE.Vector2(c,1-a);return b}function e(a,b,c){var d=new THREE.Face3(a.index,b.index,c.index,[a.clone(),b.clone(),c.clone()]);k.faces.push(d);w.copy(a).add(b).add(c).divideScalar(3);d=Math.atan2(w.z,-w.x);k.faceVertexUvs[0].push([h(a.uv,a,d),h(b.uv,b,d),h(c.uv,c,d)])}function g(a,b){var c=
Math.pow(2,b);Math.pow(4,b);for(var d=f(k.vertices[a.a]),g=f(k.vertices[a.b]),h=f(k.vertices[a.c]),l=[],p=0;p<=c;p++){l[p]=[];for(var m=f(d.clone().lerp(h,p/c)),n=f(g.clone().lerp(h,p/c)),q=c-p,s=0;s<=q;s++)l[p][s]=0==s&&p==c?m:f(m.clone().lerp(n,s/q))}for(p=0;p<c;p++)for(s=0;s<2*(c-p)-1;s++)d=Math.floor(s/2),0==s%2?e(l[p][d+1],l[p+1][d],l[p][d]):e(l[p][d+1],l[p+1][d+1],l[p+1][d])}function h(a,b,c){0>c&&1===a.x&&(a=new THREE.Vector2(a.x-1,a.y));0===b.x&&0===b.z&&(a=new THREE.Vector2(c/2/Math.PI+0.5,
a.y));return a.clone()}THREE.Geometry.call(this);this.type="PolyhedronGeometry";this.parameters={vertices:a,indices:c,radius:b,detail:d};b=b||1;d=d||0;for(var k=this,l=0,m=a.length;l<m;l+=3)f(new THREE.Vector3(a[l],a[l+1],a[l+2]));a=this.vertices;for(var r=[],n=l=0,m=c.length;l<m;l+=3,n++){var q=a[c[l]],s=a[c[l+1]],p=a[c[l+2]];r[n]=new THREE.Face3(q.index,s.index,p.index,[q.clone(),s.clone(),p.clone()])}for(var w=new THREE.Vector3,l=0,m=r.length;l<m;l++)g(r[l],d);l=0;for(m=this.faceVertexUvs[0].length;l<
m;l++)c=this.faceVertexUvs[0][l],d=c[0].x,a=c[1].x,r=c[2].x,n=Math.max(d,Math.max(a,r)),q=Math.min(d,Math.min(a,r)),0.9<n&&0.1>q&&(0.2>d&&(c[0].x+=1),0.2>a&&(c[1].x+=1),0.2>r&&(c[2].x+=1));l=0;for(m=this.vertices.length;l<m;l++)this.vertices[l].multiplyScalar(b);this.mergeVertices();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,b)};THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.IcosahedronGeometry=function(a,c){var b=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[-1,b,0,1,b,0,-1,-b,0,1,-b,0,0,-1,b,0,1,b,0,-1,-b,0,1,-b,b,0,-1,b,0,1,-b,0,-1,-b,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a,c);this.type="IcosahedronGeometry";this.parameters={radius:a,detail:c}};THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.OctahedronGeometry=function(a,c){this.parameters={radius:a,detail:c};THREE.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,c);this.type="OctahedronGeometry";this.parameters={radius:a,detail:c}};THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TetrahedronGeometry=function(a,c){THREE.PolyhedronGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],a,c);this.type="TetrahedronGeometry";this.parameters={radius:a,detail:c}};THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ParametricGeometry=function(a,c,b){THREE.Geometry.call(this);this.type="ParametricGeometry";this.parameters={func:a,slices:c,stacks:b};var d=this.vertices,f=this.faces,e=this.faceVertexUvs[0],g,h,k,l,m=c+1;for(g=0;g<=b;g++)for(l=g/b,h=0;h<=c;h++)k=h/c,k=a(k,l),d.push(k);var r,n,q,s;for(g=0;g<b;g++)for(h=0;h<c;h++)a=g*m+h,d=g*m+h+1,l=(g+1)*m+h+1,k=(g+1)*m+h,r=new THREE.Vector2(h/c,g/b),n=new THREE.Vector2((h+1)/c,g/b),q=new THREE.Vector2((h+1)/c,(g+1)/b),s=new THREE.Vector2(h/c,(g+1)/b),f.push(new THREE.Face3(a,
d,k)),e.push([r,n,s]),f.push(new THREE.Face3(d,l,k)),e.push([n.clone(),q,s.clone()]);this.computeFaceNormals();this.computeVertexNormals()};THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.AxisHelper=function(a){a=a||1;var c=new Float32Array([0,0,0,a,0,0,0,0,0,0,a,0,0,0,0,0,0,a]),b=new Float32Array([1,0,0,1,0.6,0,0,1,0,0.6,1,0,0,0,1,0,0.6,1]);a=new THREE.BufferGeometry;a.addAttribute("position",new THREE.BufferAttribute(c,3));a.addAttribute("color",new THREE.BufferAttribute(b,3));c=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,a,c,THREE.LinePieces)};THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype);
THREE.ArrowHelper=function(){var a=new THREE.Geometry;a.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0));var c=new THREE.CylinderGeometry(0,0.5,1,5,1);c.applyMatrix((new THREE.Matrix4).makeTranslation(0,-0.5,0));return function(b,d,f,e,g,h){THREE.Object3D.call(this);void 0===e&&(e=16776960);void 0===f&&(f=1);void 0===g&&(g=0.2*f);void 0===h&&(h=0.2*g);this.position.copy(d);this.line=new THREE.Line(a,new THREE.LineBasicMaterial({color:e}));this.line.matrixAutoUpdate=!1;this.add(this.line);
this.cone=new THREE.Mesh(c,new THREE.MeshBasicMaterial({color:e}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(b);this.setLength(f,g,h)}}();THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.ArrowHelper.prototype.setDirection=function(){var a=new THREE.Vector3,c;return function(b){0.99999<b.y?this.quaternion.set(0,0,0,1):-0.99999>b.y?this.quaternion.set(1,0,0,0):(a.set(b.z,0,-b.x).normalize(),c=Math.acos(b.y),this.quaternion.setFromAxisAngle(a,c))}}();
THREE.ArrowHelper.prototype.setLength=function(a,c,b){void 0===c&&(c=0.2*a);void 0===b&&(b=0.2*c);this.line.scale.set(1,a,1);this.line.updateMatrix();this.cone.scale.set(b,c,b);this.cone.position.y=a;this.cone.updateMatrix()};THREE.ArrowHelper.prototype.setColor=function(a){this.line.material.color.set(a);this.cone.material.color.set(a)};
THREE.BoxHelper=function(a){var c=new THREE.BufferGeometry;c.addAttribute("position",new THREE.BufferAttribute(new Float32Array(72),3));THREE.Line.call(this,c,new THREE.LineBasicMaterial({color:16776960}),THREE.LinePieces);void 0!==a&&this.update(a)};THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype);
THREE.BoxHelper.prototype.update=function(a){var c=a.geometry;null===c.boundingBox&&c.computeBoundingBox();var b=c.boundingBox.min,c=c.boundingBox.max,d=this.geometry.attributes.position.array;d[0]=c.x;d[1]=c.y;d[2]=c.z;d[3]=b.x;d[4]=c.y;d[5]=c.z;d[6]=b.x;d[7]=c.y;d[8]=c.z;d[9]=b.x;d[10]=b.y;d[11]=c.z;d[12]=b.x;d[13]=b.y;d[14]=c.z;d[15]=c.x;d[16]=b.y;d[17]=c.z;d[18]=c.x;d[19]=b.y;d[20]=c.z;d[21]=c.x;d[22]=c.y;d[23]=c.z;d[24]=c.x;d[25]=c.y;d[26]=b.z;d[27]=b.x;d[28]=c.y;d[29]=b.z;d[30]=b.x;d[31]=c.y;
d[32]=b.z;d[33]=b.x;d[34]=b.y;d[35]=b.z;d[36]=b.x;d[37]=b.y;d[38]=b.z;d[39]=c.x;d[40]=b.y;d[41]=b.z;d[42]=c.x;d[43]=b.y;d[44]=b.z;d[45]=c.x;d[46]=c.y;d[47]=b.z;d[48]=c.x;d[49]=c.y;d[50]=c.z;d[51]=c.x;d[52]=c.y;d[53]=b.z;d[54]=b.x;d[55]=c.y;d[56]=c.z;d[57]=b.x;d[58]=c.y;d[59]=b.z;d[60]=b.x;d[61]=b.y;d[62]=c.z;d[63]=b.x;d[64]=b.y;d[65]=b.z;d[66]=c.x;d[67]=b.y;d[68]=c.z;d[69]=c.x;d[70]=b.y;d[71]=b.z;this.geometry.attributes.position.needsUpdate=!0;this.geometry.computeBoundingSphere();this.matrixAutoUpdate=
!1;this.matrixWorld=a.matrixWorld};THREE.BoundingBoxHelper=function(a,c){var b=void 0!==c?c:8947848;this.object=a;this.box=new THREE.Box3;THREE.Mesh.call(this,new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:b,wireframe:!0}))};THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object);this.box.size(this.scale);this.box.center(this.position)};
THREE.CameraHelper=function(a){function c(a,c,d){b(a,d);b(c,d)}function b(a,b){d.vertices.push(new THREE.Vector3);d.colors.push(new THREE.Color(b));void 0===e[a]&&(e[a]=[]);e[a].push(d.vertices.length-1)}var d=new THREE.Geometry,f=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),e={};c("n1","n2",16755200);c("n2","n4",16755200);c("n4","n3",16755200);c("n3","n1",16755200);c("f1","f2",16755200);c("f2","f4",16755200);c("f4","f3",16755200);c("f3","f1",16755200);c("n1","f1",16755200);
c("n2","f2",16755200);c("n3","f3",16755200);c("n4","f4",16755200);c("p","n1",16711680);c("p","n2",16711680);c("p","n3",16711680);c("p","n4",16711680);c("u1","u2",43775);c("u2","u3",43775);c("u3","u1",43775);c("c","t",16777215);c("p","c",3355443);c("cn1","cn2",3355443);c("cn3","cn4",3355443);c("cf1","cf2",3355443);c("cf3","cf4",3355443);THREE.Line.call(this,d,f,THREE.LinePieces);this.camera=a;this.matrixWorld=a.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=e;this.update()};
THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype);THREE.CameraHelper.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};
THREE.CameraHelper.prototype.update=function(){var a=new THREE.Vector3,c=new THREE.Camera,b=new THREE.Projector;return function(){function d(d,g,h,k){a.set(g,h,k);b.unprojectVector(a,c);d=f.pointMap[d];if(void 0!==d)for(g=0,h=d.length;g<h;g++)f.geometry.vertices[d[g]].copy(a)}var f=this;c.projectionMatrix.copy(this.camera.projectionMatrix);d("c",0,0,-1.00001);d("t",0,0,1);d("n1",-1,-1,-1.00001);d("n2",1,-1,-1.00001);d("n3",-1,1,-1.00001);d("n4",1,1,-1.00001);d("f1",-1,-1,1);d("f2",1,-1,1);d("f3",
-1,1,1);d("f4",1,1,1);d("u1",0.7,1.1,-1.00001);d("u2",-0.7,1.1,-1.00001);d("u3",0,2,-1.00001);d("cf1",-1,0,1);d("cf2",1,0,1);d("cf3",0,-1,1);d("cf4",0,1,1);d("cn1",-1,0,-1.00001);d("cn2",1,0,-1.00001);d("cn3",0,-1,-1.00001);d("cn4",0,1,-1.00001);this.geometry.verticesNeedUpdate=!0}}();
THREE.DirectionalLightHelper=function(a,c){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrixWorld=a.matrixWorld;this.matrixAutoUpdate=!1;c=c||1;var b=new THREE.Geometry;b.vertices.push(new THREE.Vector3(-c,c,0),new THREE.Vector3(c,c,0),new THREE.Vector3(c,-c,0),new THREE.Vector3(-c,-c,0),new THREE.Vector3(-c,c,0));var d=new THREE.LineBasicMaterial({fog:!1});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightPlane=new THREE.Line(b,d);this.add(this.lightPlane);
b=new THREE.Geometry;b.vertices.push(new THREE.Vector3,new THREE.Vector3);d=new THREE.LineBasicMaterial({fog:!1});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine=new THREE.Line(b,d);this.add(this.targetLine);this.update()};THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()};
THREE.DirectionalLightHelper.prototype.update=function(){var a=new THREE.Vector3,c=new THREE.Vector3,b=new THREE.Vector3;return function(){a.setFromMatrixPosition(this.light.matrixWorld);c.setFromMatrixPosition(this.light.target.matrixWorld);b.subVectors(c,a);this.lightPlane.lookAt(b);this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine.geometry.vertices[1].copy(b);this.targetLine.geometry.verticesNeedUpdate=!0;this.targetLine.material.color.copy(this.lightPlane.material.color)}}();
THREE.EdgesHelper=function(a,c){var b=void 0!==c?c:16777215,d=[0,0],f={},e=function(a,b){return a-b},g=["a","b","c"],h=new THREE.BufferGeometry,k=a.geometry.clone();k.mergeVertices();k.computeFaceNormals();for(var l=k.vertices,k=k.faces,m=0,r=0,n=k.length;r<n;r++)for(var q=k[r],s=0;3>s;s++){d[0]=q[g[s]];d[1]=q[g[(s+1)%3]];d.sort(e);var p=d.toString();void 0===f[p]?(f[p]={vert1:d[0],vert2:d[1],face1:r,face2:void 0},m++):f[p].face2=r}h.addAttribute("position",new THREE.BufferAttribute(new Float32Array(6*
m),3));d=h.attributes.position.array;e=0;for(p in f)if(g=f[p],void 0===g.face2||0.9999>k[g.face1].normal.dot(k[g.face2].normal))m=l[g.vert1],d[e++]=m.x,d[e++]=m.y,d[e++]=m.z,m=l[g.vert2],d[e++]=m.x,d[e++]=m.y,d[e++]=m.z;THREE.Line.call(this,h,new THREE.LineBasicMaterial({color:b}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.matrixWorld=a.matrixWorld};THREE.EdgesHelper.prototype=Object.create(THREE.Line.prototype);
THREE.FaceNormalsHelper=function(a,c,b,d){this.object=a;this.size=void 0!==c?c:1;a=void 0!==b?b:16776960;d=void 0!==d?d:1;c=new THREE.Geometry;b=0;for(var f=this.object.geometry.faces.length;b<f;b++)c.vertices.push(new THREE.Vector3,new THREE.Vector3);THREE.Line.call(this,c,new THREE.LineBasicMaterial({color:a,linewidth:d}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.normalMatrix=new THREE.Matrix3;this.update()};THREE.FaceNormalsHelper.prototype=Object.create(THREE.Line.prototype);
THREE.FaceNormalsHelper.prototype.update=function(){var a=this.geometry.vertices,c=this.object,b=c.geometry.vertices,d=c.geometry.faces,f=c.matrixWorld;c.updateMatrixWorld(!0);this.normalMatrix.getNormalMatrix(f);for(var e=c=0,g=d.length;c<g;c++,e+=2){var h=d[c];a[e].copy(b[h.a]).add(b[h.b]).add(b[h.c]).divideScalar(3).applyMatrix4(f);a[e+1].copy(h.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size).add(a[e])}this.geometry.verticesNeedUpdate=!0;return this};
THREE.GridHelper=function(a,c){var b=new THREE.Geometry,d=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924);this.color2=new THREE.Color(8947848);for(var f=-a;f<=a;f+=c){b.vertices.push(new THREE.Vector3(-a,0,f),new THREE.Vector3(a,0,f),new THREE.Vector3(f,0,-a),new THREE.Vector3(f,0,a));var e=0===f?this.color1:this.color2;b.colors.push(e,e,e,e)}THREE.Line.call(this,b,d,THREE.LinePieces)};THREE.GridHelper.prototype=Object.create(THREE.Line.prototype);
THREE.GridHelper.prototype.setColors=function(a,c){this.color1.set(a);this.color2.set(c);this.geometry.colorsNeedUpdate=!0};
THREE.HemisphereLightHelper=function(a,c,b,d){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrixWorld=a.matrixWorld;this.matrixAutoUpdate=!1;this.colors=[new THREE.Color,new THREE.Color];a=new THREE.SphereGeometry(c,4,2);a.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(c=0;8>c;c++)a.faces[c].color=this.colors[4>c?0:1];c=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0});this.lightSphere=new THREE.Mesh(a,c);this.add(this.lightSphere);
this.update()};THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose();this.lightSphere.material.dispose()};
THREE.HemisphereLightHelper.prototype.update=function(){var a=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity);this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity);this.lightSphere.lookAt(a.setFromMatrixPosition(this.light.matrixWorld).negate());this.lightSphere.geometry.colorsNeedUpdate=!0}}();
THREE.PointLightHelper=function(a,c){this.light=a;this.light.updateMatrixWorld();var b=new THREE.SphereGeometry(c,12,8),d=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);THREE.Mesh.call(this,b,d);this.matrixWorld=this.light.matrixWorld;this.matrixAutoUpdate=!1};THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.PointLightHelper.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};
THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};
THREE.SkeletonHelper=function(a){this.bones=this.getBoneList(a);for(var c=new THREE.Geometry,b=0;b<this.bones.length;b++)this.bones[b].parent instanceof THREE.Bone&&(c.vertices.push(new THREE.Vector3),c.vertices.push(new THREE.Vector3),c.colors.push(new THREE.Color(0,0,1)),c.colors.push(new THREE.Color(0,1,0)));b=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});THREE.Line.call(this,c,b,THREE.LinePieces);this.root=a;this.matrixWorld=a.matrixWorld;
this.matrixAutoUpdate=!1;this.update()};THREE.SkeletonHelper.prototype=Object.create(THREE.Line.prototype);THREE.SkeletonHelper.prototype.getBoneList=function(a){var c=[];a instanceof THREE.Bone&&c.push(a);for(var b=0;b<a.children.length;b++)c.push.apply(c,this.getBoneList(a.children[b]));return c};
THREE.SkeletonHelper.prototype.update=function(){for(var a=this.geometry,c=(new THREE.Matrix4).getInverse(this.root.matrixWorld),b=new THREE.Matrix4,d=0,f=0;f<this.bones.length;f++){var e=this.bones[f];e.parent instanceof THREE.Bone&&(b.multiplyMatrices(c,e.matrixWorld),a.vertices[d].setFromMatrixPosition(b),b.multiplyMatrices(c,e.parent.matrixWorld),a.vertices[d+1].setFromMatrixPosition(b),d+=2)}a.verticesNeedUpdate=!0;a.computeBoundingSphere()};
THREE.SpotLightHelper=function(a){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrixWorld=a.matrixWorld;this.matrixAutoUpdate=!1;a=new THREE.CylinderGeometry(0,1,1,8,1,!0);a.applyMatrix((new THREE.Matrix4).makeTranslation(0,-0.5,0));a.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));var c=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new THREE.Mesh(a,c);this.add(this.cone);this.update()};THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};THREE.SpotLightHelper.prototype.update=function(){var a=new THREE.Vector3,c=new THREE.Vector3;return function(){var b=this.light.distance?this.light.distance:1E4,d=b*Math.tan(this.light.angle);this.cone.scale.set(d,d,b);a.setFromMatrixPosition(this.light.matrixWorld);c.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(c.sub(a));this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}();
THREE.VertexNormalsHelper=function(a,c,b,d){this.object=a;this.size=void 0!==c?c:1;c=void 0!==b?b:16711680;d=void 0!==d?d:1;b=new THREE.Geometry;a=a.geometry.faces;for(var f=0,e=a.length;f<e;f++)for(var g=0,h=a[f].vertexNormals.length;g<h;g++)b.vertices.push(new THREE.Vector3,new THREE.Vector3);THREE.Line.call(this,b,new THREE.LineBasicMaterial({color:c,linewidth:d}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.normalMatrix=new THREE.Matrix3;this.update()};THREE.VertexNormalsHelper.prototype=Object.create(THREE.Line.prototype);
THREE.VertexNormalsHelper.prototype.update=function(a){var c=new THREE.Vector3;return function(a){a=["a","b","c","d"];this.object.updateMatrixWorld(!0);this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var d=this.geometry.vertices,f=this.object.geometry.vertices,e=this.object.geometry.faces,g=this.object.matrixWorld,h=0,k=0,l=e.length;k<l;k++)for(var m=e[k],r=0,n=m.vertexNormals.length;r<n;r++){var q=m.vertexNormals[r];d[h].copy(f[m[a[r]]]).applyMatrix4(g);c.copy(q).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);
c.add(d[h]);h+=1;d[h].copy(c);h+=1}this.geometry.verticesNeedUpdate=!0;return this}}();
THREE.VertexTangentsHelper=function(a,c,b,d){this.object=a;this.size=void 0!==c?c:1;c=void 0!==b?b:255;d=void 0!==d?d:1;b=new THREE.Geometry;a=a.geometry.faces;for(var f=0,e=a.length;f<e;f++)for(var g=0,h=a[f].vertexTangents.length;g<h;g++)b.vertices.push(new THREE.Vector3),b.vertices.push(new THREE.Vector3);THREE.Line.call(this,b,new THREE.LineBasicMaterial({color:c,linewidth:d}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.update()};THREE.VertexTangentsHelper.prototype=Object.create(THREE.Line.prototype);
THREE.VertexTangentsHelper.prototype.update=function(a){var c=new THREE.Vector3;return function(a){a=["a","b","c","d"];this.object.updateMatrixWorld(!0);for(var d=this.geometry.vertices,f=this.object.geometry.vertices,e=this.object.geometry.faces,g=this.object.matrixWorld,h=0,k=0,l=e.length;k<l;k++)for(var m=e[k],r=0,n=m.vertexTangents.length;r<n;r++){var q=m.vertexTangents[r];d[h].copy(f[m[a[r]]]).applyMatrix4(g);c.copy(q).transformDirection(g).multiplyScalar(this.size);c.add(d[h]);h+=1;d[h].copy(c);
h+=1}this.geometry.verticesNeedUpdate=!0;return this}}();
THREE.WireframeHelper=function(a,c){var b=void 0!==c?c:16777215,d=[0,0],f={},e=function(a,b){return a-b},g=["a","b","c"],h=new THREE.BufferGeometry;if(a.geometry instanceof THREE.Geometry){for(var k=a.geometry.vertices,l=a.geometry.faces,m=0,r=new Uint32Array(6*l.length),n=0,q=l.length;n<q;n++)for(var s=l[n],p=0;3>p;p++){d[0]=s[g[p]];d[1]=s[g[(p+1)%3]];d.sort(e);var w=d.toString();void 0===f[w]&&(r[2*m]=d[0],r[2*m+1]=d[1],f[w]=!0,m++)}d=new Float32Array(6*m);n=0;for(q=m;n<q;n++)for(p=0;2>p;p++)m=
k[r[2*n+p]],g=6*n+3*p,d[g+0]=m.x,d[g+1]=m.y,d[g+2]=m.z;h.addAttribute("position",new THREE.BufferAttribute(d,3))}else if(a.geometry instanceof THREE.BufferGeometry){if(void 0!==a.geometry.attributes.index){for(var k=a.geometry.attributes.position.array,q=a.geometry.attributes.index.array,l=a.geometry.offsets,m=0,r=new Uint32Array(2*q.length),s=0,y=l.length;s<y;++s)for(var p=l[s].start,w=l[s].count,g=l[s].index,n=p,t=p+w;n<t;n+=3)for(p=0;3>p;p++)d[0]=g+q[n+p],d[1]=g+q[n+(p+1)%3],d.sort(e),w=d.toString(),
void 0===f[w]&&(r[2*m]=d[0],r[2*m+1]=d[1],f[w]=!0,m++);d=new Float32Array(6*m);n=0;for(q=m;n<q;n++)for(p=0;2>p;p++)g=6*n+3*p,m=3*r[2*n+p],d[g+0]=k[m],d[g+1]=k[m+1],d[g+2]=k[m+2]}else for(k=a.geometry.attributes.position.array,m=k.length/3,r=m/3,d=new Float32Array(6*m),n=0,q=r;n<q;n++)for(p=0;3>p;p++)g=18*n+6*p,r=9*n+3*p,d[g+0]=k[r],d[g+1]=k[r+1],d[g+2]=k[r+2],m=9*n+(p+1)%3*3,d[g+3]=k[m],d[g+4]=k[m+1],d[g+5]=k[m+2];h.addAttribute("position",new THREE.BufferAttribute(d,3))}THREE.Line.call(this,h,new THREE.LineBasicMaterial({color:b}),
THREE.LinePieces);this.matrixAutoUpdate=!1;this.matrixWorld=a.matrixWorld};THREE.WireframeHelper.prototype=Object.create(THREE.Line.prototype);THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this);this.render=function(a){}};THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype);THREE.LensFlare=function(a,c,b,d,f){THREE.Object3D.call(this);this.lensFlares=[];this.positionScreen=new THREE.Vector3;this.customUpdateCallback=void 0;void 0!==a&&this.add(a,c,b,d,f)};
THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype);THREE.LensFlare.prototype.add=function(a,c,b,d,f,e){void 0===c&&(c=-1);void 0===b&&(b=0);void 0===e&&(e=1);void 0===f&&(f=new THREE.Color(16777215));void 0===d&&(d=THREE.NormalBlending);b=Math.min(b,Math.max(0,b));this.lensFlares.push({texture:a,size:c,distance:b,x:0,y:0,z:0,scale:1,rotation:1,opacity:e,color:f,blending:d})};
THREE.LensFlare.prototype.updateLensFlares=function(){var a,c=this.lensFlares.length,b,d=2*-this.positionScreen.x,f=2*-this.positionScreen.y;for(a=0;a<c;a++)b=this.lensFlares[a],b.x=this.positionScreen.x+d*b.distance,b.y=this.positionScreen.y+f*b.distance,b.wantedRotation=b.x*Math.PI*0.25,b.rotation+=0.25*(b.wantedRotation-b.rotation)};
THREE.MorphBlendMesh=function(a,c){THREE.Mesh.call(this,a,c);this.animationsMap={};this.animationsList=[];var b=this.geometry.morphTargets.length;this.createAnimation("__default",0,b-1,b/1);this.setAnimationWeight("__default",1)};THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype);
THREE.MorphBlendMesh.prototype.createAnimation=function(a,c,b,d){c={startFrame:c,endFrame:b,length:b-c+1,fps:d,duration:(b-c)/d,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[a]=c;this.animationsList.push(c)};
THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(a){for(var c=/([a-z]+)_?(\d+)/,b,d={},f=this.geometry,e=0,g=f.morphTargets.length;e<g;e++){var h=f.morphTargets[e].name.match(c);if(h&&1<h.length){var k=h[1];d[k]||(d[k]={start:Infinity,end:-Infinity});h=d[k];e<h.start&&(h.start=e);e>h.end&&(h.end=e);b||(b=k)}}for(k in d)h=d[k],this.createAnimation(k,h.start,h.end,a);this.firstAnimation=b};
THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(a){if(a=this.animationsMap[a])a.direction=1,a.directionBackwards=!1};THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(a){if(a=this.animationsMap[a])a.direction=-1,a.directionBackwards=!0};THREE.MorphBlendMesh.prototype.setAnimationFPS=function(a,c){var b=this.animationsMap[a];b&&(b.fps=c,b.duration=(b.end-b.start)/b.fps)};
THREE.MorphBlendMesh.prototype.setAnimationDuration=function(a,c){var b=this.animationsMap[a];b&&(b.duration=c,b.fps=(b.end-b.start)/b.duration)};THREE.MorphBlendMesh.prototype.setAnimationWeight=function(a,c){var b=this.animationsMap[a];b&&(b.weight=c)};THREE.MorphBlendMesh.prototype.setAnimationTime=function(a,c){var b=this.animationsMap[a];b&&(b.time=c)};THREE.MorphBlendMesh.prototype.getAnimationTime=function(a){var c=0;if(a=this.animationsMap[a])c=a.time;return c};
THREE.MorphBlendMesh.prototype.getAnimationDuration=function(a){var c=-1;if(a=this.animationsMap[a])c=a.duration;return c};THREE.MorphBlendMesh.prototype.playAnimation=function(a){var c=this.animationsMap[a];c?(c.time=0,c.active=!0):console.warn("animation["+a+"] undefined")};THREE.MorphBlendMesh.prototype.stopAnimation=function(a){if(a=this.animationsMap[a])a.active=!1};
THREE.MorphBlendMesh.prototype.update=function(a){for(var c=0,b=this.animationsList.length;c<b;c++){var d=this.animationsList[c];if(d.active){var f=d.duration/d.length;d.time+=d.direction*a;if(d.mirroredLoop){if(d.time>d.duration||0>d.time)d.direction*=-1,d.time>d.duration&&(d.time=d.duration,d.directionBackwards=!0),0>d.time&&(d.time=0,d.directionBackwards=!1)}else d.time%=d.duration,0>d.time&&(d.time+=d.duration);var e=d.startFrame+THREE.Math.clamp(Math.floor(d.time/f),0,d.length-1),g=d.weight;
e!==d.currentFrame&&(this.morphTargetInfluences[d.lastFrame]=0,this.morphTargetInfluences[d.currentFrame]=1*g,this.morphTargetInfluences[e]=0,d.lastFrame=d.currentFrame,d.currentFrame=e);f=d.time%f/f;d.directionBackwards&&(f=1-f);this.morphTargetInfluences[d.currentFrame]=f*g;this.morphTargetInfluences[d.lastFrame]=(1-f)*g}}};
THREE.LensFlarePlugin=function(){function a(a,c){var d=b.createProgram(),e=b.createShader(b.FRAGMENT_SHADER),f=b.createShader(b.VERTEX_SHADER),g="precision "+c+" float;\nprecision "+c+" int;\n";b.shaderSource(e,g+a.fragmentShader);b.shaderSource(f,g+a.vertexShader);b.compileShader(e);b.compileShader(f);b.attachShader(d,e);b.attachShader(d,f);b.linkProgram(d);return d}var c=[],b,d,f,e,g,h,k,l,m,r,n,q,s;this.init=function(c){b=c.context;d=c;f=c.getPrecision();e=new Float32Array(16);g=new Uint16Array(6);
c=0;e[c++]=-1;e[c++]=-1;e[c++]=0;e[c++]=0;e[c++]=1;e[c++]=-1;e[c++]=1;e[c++]=0;e[c++]=1;e[c++]=1;e[c++]=1;e[c++]=1;e[c++]=-1;e[c++]=1;e[c++]=0;e[c++]=1;c=0;g[c++]=0;g[c++]=1;g[c++]=2;g[c++]=0;g[c++]=2;g[c++]=3;h=b.createBuffer();k=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,h);b.bufferData(b.ARRAY_BUFFER,e,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,k);b.bufferData(b.ELEMENT_ARRAY_BUFFER,g,b.STATIC_DRAW);l=b.createTexture();m=b.createTexture();b.bindTexture(b.TEXTURE_2D,l);b.texImage2D(b.TEXTURE_2D,
0,b.RGB,16,16,0,b.RGB,b.UNSIGNED_BYTE,null);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.bindTexture(b.TEXTURE_2D,m);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,16,16,0,b.RGBA,b.UNSIGNED_BYTE,null);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,
b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);0>=b.getParameter(b.MAX_VERTEX_TEXTURE_IMAGE_UNITS)?(r=!1,n=a(THREE.ShaderFlares.lensFlare,f)):(r=!0,n=a(THREE.ShaderFlares.lensFlareVertexTexture,f));q={};s={};q.vertex=b.getAttribLocation(n,"position");q.uv=b.getAttribLocation(n,"uv");s.renderType=b.getUniformLocation(n,"renderType");s.map=b.getUniformLocation(n,"map");s.occlusionMap=b.getUniformLocation(n,"occlusionMap");
s.opacity=b.getUniformLocation(n,"opacity");s.color=b.getUniformLocation(n,"color");s.scale=b.getUniformLocation(n,"scale");s.rotation=b.getUniformLocation(n,"rotation");s.screenPosition=b.getUniformLocation(n,"screenPosition")};this.render=function(a,e,f,g){c.length=0;a.traverseVisible(function(a){a instanceof THREE.LensFlare&&c.push(a)});if(0!==c.length){a=new THREE.Vector3;var H=g/f,u=0.5*f,D=0.5*g,z=16/g,x=new THREE.Vector2(z*H,z),A=new THREE.Vector3(1,1,0),B=new THREE.Vector2(1,1),v=s,z=q;b.useProgram(n);
b.enableVertexAttribArray(q.vertex);b.enableVertexAttribArray(q.uv);b.uniform1i(v.occlusionMap,0);b.uniform1i(v.map,1);b.bindBuffer(b.ARRAY_BUFFER,h);b.vertexAttribPointer(z.vertex,2,b.FLOAT,!1,16,0);b.vertexAttribPointer(z.uv,2,b.FLOAT,!1,16,8);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,k);b.disable(b.CULL_FACE);b.depthMask(!1);for(var J=0,C=c.length;J<C;J++){z=16/g;x.set(z*H,z);var G=c[J];a.set(G.matrixWorld.elements[12],G.matrixWorld.elements[13],G.matrixWorld.elements[14]);a.applyMatrix4(e.matrixWorldInverse);
a.applyProjection(e.projectionMatrix);A.copy(a);B.x=A.x*u+u;B.y=A.y*D+D;if(r||0<B.x&&B.x<f&&0<B.y&&B.y<g){b.activeTexture(b.TEXTURE1);b.bindTexture(b.TEXTURE_2D,l);b.copyTexImage2D(b.TEXTURE_2D,0,b.RGB,B.x-8,B.y-8,16,16,0);b.uniform1i(v.renderType,0);b.uniform2f(v.scale,x.x,x.y);b.uniform3f(v.screenPosition,A.x,A.y,A.z);b.disable(b.BLEND);b.enable(b.DEPTH_TEST);b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0);b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,m);b.copyTexImage2D(b.TEXTURE_2D,
0,b.RGBA,B.x-8,B.y-8,16,16,0);b.uniform1i(v.renderType,1);b.disable(b.DEPTH_TEST);b.activeTexture(b.TEXTURE1);b.bindTexture(b.TEXTURE_2D,l);b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0);G.positionScreen.copy(A);G.customUpdateCallback?G.customUpdateCallback(G):G.updateLensFlares();b.uniform1i(v.renderType,2);b.enable(b.BLEND);for(var N=0,L=G.lensFlares.length;N<L;N++){var I=G.lensFlares[N];0.001<I.opacity&&0.001<I.scale&&(A.x=I.x,A.y=I.y,A.z=I.z,z=I.size*I.scale/g,x.x=z*H,x.y=z,b.uniform3f(v.screenPosition,
A.x,A.y,A.z),b.uniform2f(v.scale,x.x,x.y),b.uniform1f(v.rotation,I.rotation),b.uniform1f(v.opacity,I.opacity),b.uniform3f(v.color,I.color.r,I.color.g,I.color.b),d.setBlending(I.blending,I.blendEquation,I.blendSrc,I.blendDst),d.setTexture(I.texture,1),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0))}}}b.enable(b.CULL_FACE);b.enable(b.DEPTH_TEST);b.depthMask(!0)}};this.dispose=function(){b.deleteProgram(n);b.deleteTexture(l);b.deleteTexture(m)}};
THREE.ShadowMapPlugin=function(){function a(b,c,d){if(c.visible){var e=f[c.id];if(e&&c.castShadow&&(!1===c.frustumCulled||!0===m.intersectsObject(c)))for(var g=0,h=e.length;g<h;g++){var k=e[g];c._modelViewMatrix.multiplyMatrices(d.matrixWorldInverse,c.matrixWorld);p.push(k)}g=0;for(h=c.children.length;g<h;g++)a(b,c.children[g],d)}}var c,b,d,f,e,g,h,k,l,m=new THREE.Frustum,r=new THREE.Matrix4,n=new THREE.Vector3,q=new THREE.Vector3,s=new THREE.Vector3,p=[];this.init=function(a,m,n,p){c=a.context;b=
a;d=m;f=n;e=p;a=THREE.ShaderLib.depthRGBA;m=THREE.UniformsUtils.clone(a.uniforms);g=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,uniforms:m});h=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,uniforms:m,morphTargets:!0});k=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,uniforms:m,skinning:!0});l=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,
uniforms:m,morphTargets:!0,skinning:!0});g._shadowPass=!0;h._shadowPass=!0;k._shadowPass=!0;l._shadowPass=!0};this.dispose=function(){g.dispose();g=null;k.dispose();k=null;h.dispose();h=null;l.dispose();b=l=null;p.splice(0,p.length)};this.render=function(a,c){b.shadowMapEnabled&&b.shadowMapAutoUpdate&&this.update(a,c)};this.update=function(f,y){var t,H,u,D,z,x,A,B,v,J=[];D=0;c.clearColor(1,1,1,1);c.disable(c.BLEND);c.enable(c.CULL_FACE);c.frontFace(c.CCW);b.shadowMapCullFace===THREE.CullFaceFront?
c.cullFace(c.FRONT):c.cullFace(c.BACK);b.setDepthTest(!0);t=0;for(H=d.length;t<H;t++)if(u=d[t],u.castShadow)if(u instanceof THREE.DirectionalLight&&u.shadowCascade)for(z=0;z<u.shadowCascadeCount;z++){if(u.shadowCascadeArray[z])x=u.shadowCascadeArray[z];else{v=u;var C=z;x=new THREE.DirectionalLight;x.isVirtual=!0;x.onlyShadow=!0;x.castShadow=!0;x.shadowCameraNear=v.shadowCameraNear;x.shadowCameraFar=v.shadowCameraFar;x.shadowCameraLeft=v.shadowCameraLeft;x.shadowCameraRight=v.shadowCameraRight;x.shadowCameraBottom=
v.shadowCameraBottom;x.shadowCameraTop=v.shadowCameraTop;x.shadowCameraVisible=v.shadowCameraVisible;x.shadowDarkness=v.shadowDarkness;x.shadowBias=v.shadowCascadeBias[C];x.shadowMapWidth=v.shadowCascadeWidth[C];x.shadowMapHeight=v.shadowCascadeHeight[C];x.pointsWorld=[];x.pointsFrustum=[];A=x.pointsWorld;B=x.pointsFrustum;for(var G=0;8>G;G++)A[G]=new THREE.Vector3,B[G]=new THREE.Vector3;A=v.shadowCascadeNearZ[C];v=v.shadowCascadeFarZ[C];B[0].set(-1,-1,A);B[1].set(1,-1,A);B[2].set(-1,1,A);B[3].set(1,
1,A);B[4].set(-1,-1,v);B[5].set(1,-1,v);B[6].set(-1,1,v);B[7].set(1,1,v);x.originalCamera=y;B=new THREE.Gyroscope;B.position.copy(u.shadowCascadeOffset);B.add(x);B.add(x.target);y.add(B);u.shadowCascadeArray[z]=x;console.log("Created virtualLight",x)}C=u;A=z;v=C.shadowCascadeArray[A];v.position.copy(C.position);v.target.position.copy(C.target.position);v.lookAt(v.target.position);v.shadowCameraVisible=C.shadowCameraVisible;v.shadowDarkness=C.shadowDarkness;v.shadowBias=C.shadowCascadeBias[A];B=C.shadowCascadeNearZ[A];
C=C.shadowCascadeFarZ[A];v=v.pointsFrustum;v[0].z=B;v[1].z=B;v[2].z=B;v[3].z=B;v[4].z=C;v[5].z=C;v[6].z=C;v[7].z=C;J[D]=x;D++}else J[D]=u,D++;t=0;for(H=J.length;t<H;t++){u=J[t];u.shadowMap||(z=THREE.LinearFilter,b.shadowMapType===THREE.PCFSoftShadowMap&&(z=THREE.NearestFilter),u.shadowMap=new THREE.WebGLRenderTarget(u.shadowMapWidth,u.shadowMapHeight,{minFilter:z,magFilter:z,format:THREE.RGBAFormat}),u.shadowMapSize=new THREE.Vector2(u.shadowMapWidth,u.shadowMapHeight),u.shadowMatrix=new THREE.Matrix4);
if(!u.shadowCamera){if(u instanceof THREE.SpotLight)u.shadowCamera=new THREE.PerspectiveCamera(u.shadowCameraFov,u.shadowMapWidth/u.shadowMapHeight,u.shadowCameraNear,u.shadowCameraFar);else if(u instanceof THREE.DirectionalLight)u.shadowCamera=new THREE.OrthographicCamera(u.shadowCameraLeft,u.shadowCameraRight,u.shadowCameraTop,u.shadowCameraBottom,u.shadowCameraNear,u.shadowCameraFar);else{console.error("Unsupported light type for shadow");continue}f.add(u.shadowCamera);!0===f.autoUpdate&&f.updateMatrixWorld()}u.shadowCameraVisible&&
!u.cameraHelper&&(u.cameraHelper=new THREE.CameraHelper(u.shadowCamera),u.shadowCamera.add(u.cameraHelper));if(u.isVirtual&&u.originalCamera==y){z=y;D=u.shadowCamera;x=u.pointsFrustum;B=u.pointsWorld;n.set(Infinity,Infinity,Infinity);q.set(-Infinity,-Infinity,-Infinity);for(v=0;8>v;v++)C=B[v],C.copy(x[v]),THREE.ShadowMapPlugin.__projector.unprojectVector(C,z),C.applyMatrix4(D.matrixWorldInverse),C.x<n.x&&(n.x=C.x),C.x>q.x&&(q.x=C.x),C.y<n.y&&(n.y=C.y),C.y>q.y&&(q.y=C.y),C.z<n.z&&(n.z=C.z),C.z>q.z&&
(q.z=C.z);D.left=n.x;D.right=q.x;D.top=q.y;D.bottom=n.y;D.updateProjectionMatrix()}D=u.shadowMap;x=u.shadowMatrix;z=u.shadowCamera;z.position.setFromMatrixPosition(u.matrixWorld);s.setFromMatrixPosition(u.target.matrixWorld);z.lookAt(s);z.updateMatrixWorld();z.matrixWorldInverse.getInverse(z.matrixWorld);u.cameraHelper&&(u.cameraHelper.visible=u.shadowCameraVisible);u.shadowCameraVisible&&u.cameraHelper.update();x.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1);x.multiply(z.projectionMatrix);x.multiply(z.matrixWorldInverse);
r.multiplyMatrices(z.projectionMatrix,z.matrixWorldInverse);m.setFromMatrix(r);b.setRenderTarget(D);b.clear();p.length=0;a(f,f,z);u=0;for(D=p.length;u<D;u++)B=p[u],v=B.object,x=B.buffer,C=v.material instanceof THREE.MeshFaceMaterial?v.material.materials[0]:v.material,A=void 0!==v.geometry.morphTargets&&0<v.geometry.morphTargets.length&&C.morphTargets,G=v instanceof THREE.SkinnedMesh&&C.skinning,A=v.customDepthMaterial?v.customDepthMaterial:G?A?l:k:A?h:g,b.setMaterialFaces(C),x instanceof THREE.BufferGeometry?
b.renderBufferDirect(z,d,null,A,x,v,B.offsetIndices):b.renderBuffer(z,d,null,A,x,v);u=0;for(D=e.length;u<D;u++)B=e[u],v=B.object,v.visible&&v.castShadow&&(v._modelViewMatrix.multiplyMatrices(z.matrixWorldInverse,v.matrixWorld),b.renderImmediateObject(z,d,null,g,v))}t=b.getClearColor();H=b.getClearAlpha();c.clearColor(t.r,t.g,t.b,H);c.enable(c.BLEND);b.shadowMapCullFace===THREE.CullFaceFront&&c.cullFace(c.BACK)}};THREE.ShadowMapPlugin.__projector=new THREE.Projector;
THREE.SpritePlugin=function(){var a,c,b,d,f,e,g,h,k,l,m,r,n,q,s,p,w;function y(a,b){return a.z!==b.z?b.z-a.z:b.id-a.id}var t,H,u,D=[],z,x,A,B,v;this.init=function(y){t=y.context;H=y;z=new Float32Array([-0.5,-0.5,0,0,0.5,-0.5,1,0,0.5,0.5,1,1,-0.5,0.5,0,1]);x=new Uint16Array([0,1,2,0,2,3]);A=t.createBuffer();B=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,A);t.bufferData(t.ARRAY_BUFFER,z,t.STATIC_DRAW);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,B);t.bufferData(t.ELEMENT_ARRAY_BUFFER,x,t.STATIC_DRAW);y=t.createProgram();
var C=t.createShader(t.VERTEX_SHADER),D=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(C,["precision "+H.getPrecision()+" float;","uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition;\nfinalPosition = projectionMatrix * finalPosition;\ngl_Position = finalPosition;\n}"].join("\n"));
t.shaderSource(D,["precision "+H.getPrecision()+" float;","uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"].join("\n"));
t.compileShader(C);t.compileShader(D);t.attachShader(y,C);t.attachShader(y,D);t.linkProgram(y);v=y;p=t.getAttribLocation(v,"position");w=t.getAttribLocation(v,"uv");a=t.getUniformLocation(v,"uvOffset");c=t.getUniformLocation(v,"uvScale");b=t.getUniformLocation(v,"rotation");d=t.getUniformLocation(v,"scale");f=t.getUniformLocation(v,"color");e=t.getUniformLocation(v,"map");g=t.getUniformLocation(v,"opacity");h=t.getUniformLocation(v,"modelViewMatrix");k=t.getUniformLocation(v,"projectionMatrix");l=
t.getUniformLocation(v,"fogType");m=t.getUniformLocation(v,"fogDensity");r=t.getUniformLocation(v,"fogNear");n=t.getUniformLocation(v,"fogFar");q=t.getUniformLocation(v,"fogColor");s=t.getUniformLocation(v,"alphaTest");y=document.createElement("canvas");y.width=8;y.height=8;C=y.getContext("2d");C.fillStyle="white";C.fillRect(0,0,8,8);u=new THREE.Texture(y);u.needsUpdate=!0};this.render=function(x,z,G,N){D.length=0;x.traverseVisible(function(a){a instanceof THREE.Sprite&&D.push(a)});if(0!==D.length){t.useProgram(v);
t.enableVertexAttribArray(p);t.enableVertexAttribArray(w);t.disable(t.CULL_FACE);t.enable(t.BLEND);t.bindBuffer(t.ARRAY_BUFFER,A);t.vertexAttribPointer(p,2,t.FLOAT,!1,16,0);t.vertexAttribPointer(w,2,t.FLOAT,!1,16,8);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,B);t.uniformMatrix4fv(k,!1,z.projectionMatrix.elements);t.activeTexture(t.TEXTURE0);t.uniform1i(e,0);N=G=0;var L=x.fog;L?(t.uniform3f(q,L.color.r,L.color.g,L.color.b),L instanceof THREE.Fog?(t.uniform1f(r,L.near),t.uniform1f(n,L.far),t.uniform1i(l,1),
N=G=1):L instanceof THREE.FogExp2&&(t.uniform1f(m,L.density),t.uniform1i(l,2),N=G=2)):(t.uniform1i(l,0),N=G=0);for(var L=0,I=D.length;L<I;L++){var K=D[L],F=K.material;K._modelViewMatrix.multiplyMatrices(z.matrixWorldInverse,K.matrixWorld);K.z=-K._modelViewMatrix.elements[14]}D.sort(y);z=[];L=0;for(I=D.length;L<I;L++)K=D[L],F=K.material,t.uniform1f(s,F.alphaTest),t.uniformMatrix4fv(h,!1,K._modelViewMatrix.elements),z[0]=K.scale.x,z[1]=K.scale.y,K=0,x.fog&&F.fog&&(K=N),G!==K&&(t.uniform1i(l,K),G=K),
null!==F.map?(t.uniform2f(a,F.map.offset.x,F.map.offset.y),t.uniform2f(c,F.map.repeat.x,F.map.repeat.y)):(t.uniform2f(a,0,0),t.uniform2f(c,1,1)),t.uniform1f(g,F.opacity),t.uniform3f(f,F.color.r,F.color.g,F.color.b),t.uniform1f(b,F.rotation),t.uniform2fv(d,z),H.setBlending(F.blending,F.blendEquation,F.blendSrc,F.blendDst),H.setDepthTest(F.depthTest),H.setDepthWrite(F.depthWrite),F.map&&F.map.image&&F.map.image.width?H.setTexture(F.map,0):H.setTexture(u,0),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,
0);t.enable(t.CULL_FACE)}};this.dispose=function(){u.dispose();t.deleteProgram(v);for(var a in D)D[a].material.dispose();t.deleteBuffer(A);t.deleteBuffer(B)}};
THREE.DepthPassPlugin=function(){function a(b,c,d){if(c.visible){var e=f[c.id];if(e&&(!1===c.frustumCulled||!0===m.intersectsObject(c)))for(var g=0,h=e.length;g<h;g++){var k=e[g];c._modelViewMatrix.multiplyMatrices(d.matrixWorldInverse,c.matrixWorld);n.push(k)}g=0;for(h=c.children.length;g<h;g++)a(b,c.children[g],d)}}this.enabled=!1;this.renderTarget=null;var c,b,d,f,e,g,h,k,l,m=new THREE.Frustum,r=new THREE.Matrix4,n=[];this.init=function(a,m,n,r){c=a.context;b=a;d=m;f=n;e=r;a=THREE.ShaderLib.depthRGBA;
m=THREE.UniformsUtils.clone(a.uniforms);g=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,uniforms:m});h=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,uniforms:m,morphTargets:!0});k=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,uniforms:m,skinning:!0});l=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,uniforms:m,morphTargets:!0,skinning:!0});g._shadowPass=
!0;h._shadowPass=!0;k._shadowPass=!0;l._shadowPass=!0};this.render=function(a,b){this.enabled&&this.update(a,b)};this.update=function(f,s){var p,w,y,t,H,u;c.clearColor(1,1,1,1);c.disable(c.BLEND);b.setDepthTest(!0);!0===f.autoUpdate&&f.updateMatrixWorld();s.matrixWorldInverse.getInverse(s.matrixWorld);r.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse);m.setFromMatrix(r);b.setRenderTarget(this.renderTarget);b.clear();n.length=0;a(f,f,s);var D;p=0;for(w=n.length;p<w;p++)H=n[p],u=H.object,y=
H.buffer,u instanceof THREE.PointCloud&&!u.customDepthMaterial||((D=u.material instanceof THREE.MeshFaceMaterial?u.material.materials[0]:u.material)&&b.setMaterialFaces(u.material),t=void 0!==u.geometry.morphTargets&&0<u.geometry.morphTargets.length&&D.morphTargets,D=u instanceof THREE.SkinnedMesh&&D.skinning,t=u.customDepthMaterial?u.customDepthMaterial:D?t?l:k:t?h:g,y instanceof THREE.BufferGeometry?b.renderBufferDirect(s,d,null,t,y,u,H.offsetIndices):b.renderBuffer(s,d,null,t,y,u));p=0;for(w=e.length;p<
w;p++)H=e[p],u=H.object,u.visible&&(u._modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,u.matrixWorld),b.renderImmediateObject(s,d,null,g,u));p=b.getClearColor();w=b.getClearAlpha();c.clearColor(p.r,p.g,p.b,w);c.enable(c.BLEND)}};
THREE.ShaderFlares={lensFlareVertexTexture:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},
lensFlare:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",
fragmentShader:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}};
