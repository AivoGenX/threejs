<!--

/*
** A simple page to review the diff images.
*/

-->

<!DOCTYPE html>
<html lang="en">

<head>
    <title>three.js / test result </title>
    <meta charset="utf-8">
    <style>
        #largeView {
            top: 120px;
            right: 0px;
            position: fixed;
            z-index: 10;
            overflow: auto;
            display: none
        }
    </style>
</head>

<body>
    <div id="view"></div>
    <div id="largeView" onmouseout="hideLargeView();">
        <img id="largeImage">
    </div>

    <script>

		function showDetail( url ) {

			return function ( event ) {

				document.getElementById( "largeImage" ).src = url;
				document.getElementById( "largeView" ).style.display = "block";

			};

		}

		function hideLargeView() {

			document.getElementById( "largeView" ).style.display = "none";

		}

		if ( window.parent.testRunner ) {

			var result = window.parent.testRunner.result;
			var view = document.getElementById( "view" );
			var hasFailedCase = false;
			for ( var caseNo in result ) {

				if ( result[ caseNo ].failed === true ) {

					hasFailedCase = true;

				} else {

					continue;

				}
				var caseDiv = document.createElement( "div" );
				view.appendChild( caseDiv );
				var testcase = document.createElement( "span" );
				testcase.textContent = result[ caseNo ].name;
				caseDiv.appendChild( testcase );

				var frameDiv = document.createElement( "div" );
				caseDiv.appendChild( frameDiv );
				var frameTable = document.createElement( "table" );
				frameDiv.appendChild( frameTable );

				var frames = result[ caseNo ].frames;

				var frameNoTr = document.createElement( "tr" );
				frameTable.appendChild( frameNoTr );
				for ( var frameNo in frames ) {

					var frameNoTh = document.createElement( "th" );
					frameNoTr.appendChild( frameNoTh );
					var no = document.createTextNode( frameNo );
					frameNoTh.appendChild( no );

				}

				var frameImageTr = document.createElement( "tr" );
				frameTable.appendChild( frameImageTr );
				for ( var frameNo in frames ) {

					var frameImageTd = document.createElement( "td" );
					frameImageTr.appendChild( frameImageTd );
					frameImageTd.onmouseover = showDetail( frames[ frameNo ].ref );

					var ref = document.createElement( "img" );
					frameImageTd.appendChild( ref );
					ref.width = 40;
					ref.height = 30;
					ref.src = frames[ frameNo ].ref;

				}

				var frameImageTr = document.createElement( "tr" );
				frameTable.appendChild( frameImageTr );
				for ( var frameNo in frames ) {

					var frameImageTd = document.createElement( "td" );
					frameImageTr.appendChild( frameImageTd );

					if ( frames[ frameNo ].cmp !== null ) {

						frameImageTd.onmouseover = showDetail( frames[ frameNo ].cmp );
						var cmp = document.createElement( "img" );
						frameImageTd.appendChild( cmp );
						cmp.width = 40;
						cmp.height = 30;
						cmp.src = frames[ frameNo ].cmp;

					}

					if ( frames[ frameNo ].cmp !== null ) {
					}

				}

				frameImageTr = document.createElement( "tr" );
				frameTable.appendChild( frameImageTr );
				for ( var frameNo in frames ) {

					var frameImageTd = document.createElement( "td" );
					frameImageTr.appendChild( frameImageTd );

					if ( frames[ frameNo ].diff !== null ) {

						frameImageTd.onmouseover = showDetail( frames[ frameNo ].diff );
						var diff = document.createElement( "img" );
						frameImageTd.appendChild( diff );
						diff.width = 40;
						diff.height = 30;
						diff.src = frames[ frameNo ].diff;

					}

				}

			}
			if ( hasFailedCase === false ) {

				view.innerText = "All cases passed!";

			}

		}

    </script>
</body>

</html>