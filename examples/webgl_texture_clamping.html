<!doctype html>
<html lang="en">
	<head>
		<title>three.js webgl - texture clamping</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				background:#fff;
				padding:0;
				margin:0;
				font-weight: bold;
				overflow:hidden;
			}
		</style>
	</head>
	<body>

		<script src="../build/custom/Three.js"></script>

		<script src="js/Stats.js"></script>

		<script>

			var stats;

			var camera, scene, renderer;

			var mouseX = 0;

			document.addEventListener( 'mousemove', onDocumentMouseMove, false );

			init();
			animate();

			function createPlane( x, y, width, height, uvs, materialParams ) {

				var plane = new THREE.PlaneGeometry( width, height );

				var layerUvs = [];
				var uv = 0;
				for ( var i = 0; i < uvs.length / 2; i++ ) {
					layerUvs.push( new THREE.UV( uvs[uv++], uvs[uv++] ) );
				}
				for ( var layer = 0; layer < 2; layer++ ) {
					plane.faceVertexUvs[layer] = [ layerUvs ];
				}

				var mesh = new THREE.Mesh( plane, new THREE.MeshBasicMaterial( materialParams ) );
				mesh.position.x = x;
				mesh.position.y = y;
				return mesh;

			}

			function init() {

				var container = document.createElement( 'div' );
				document.body.appendChild( container );

				camera = new THREE.PerspectiveCamera( 60, window.innerWidth / window.innerHeight, 1, 1000 );
				camera.position.set( 0, 0, 200 );

				scene = new THREE.Scene();
				scene.add( camera );

				var map = THREE.ImageUtils.loadTexture( "textures/ash_uvgrid01.jpg" );
				var lightMap = THREE.ImageUtils.loadTexture( "textures/water.jpg" );

				var uvs = [ -0.325,-0.2, -0.325,1.2, 1.325,1.2, 1.325,-0.2 ];
				scene.add( createPlane( -80, -60, 160, 120, uvs, { map: map, lightMap: lightMap, borderClampColor: 0xC1D0DE } ) );
				scene.add( createPlane( -80, 60, 160, 120, uvs, { map: map, lightMap: lightMap } ) );
				uvs = [ -0.625,-0.5, -0.625,1.5, 1.625,1.5, 1.625,-0.5 ];
				scene.add( createPlane( 80, -60, 160, 120, uvs, { map: map, borderClampColor: 0xF0DDBB } ) );
				scene.add( createPlane( 80, 60, 160, 120, uvs, { map: map } ) );

				renderer = new THREE.WebGLRenderer( { antialias: true, clearColor: 0x000000, clearAlpha: 1 } );
				renderer.setSize( window.innerWidth, window.innerHeight );

				container.appendChild( renderer.domElement );

				stats = new Stats();
				stats.domElement.style.position = 'absolute';
				stats.domElement.style.top = '0px';
				stats.domElement.style.zIndex = 100;
				container.appendChild( stats.domElement );

			}

			function onDocumentMouseMove(event) {

				mouseX = ( event.clientX / window.innerWidth );

			}

			function animate() {

				requestAnimationFrame( animate );

				render();
				stats.update();

			}

			function render() {

				camera.rotation.z = mouseX * Math.PI;

				renderer.render( scene, camera );

			}

		</script>

	</body>
</html>
